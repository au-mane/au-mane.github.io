import{w as q}from"./index.CCnsF9wr.js";import{s as y}from"./supabase-config.Y8iSvhNi.js";import{b as O,s as ae,A as M,o as D,w as Q,f as m,N as R,E as le,O as j,P as se,e as k,d as U,j as T,k as E,i as W,C as F,Q as z,R as ne,n as te,p,S as G,T as B,D as J,M as oe,y as ce,t as L,m as V,q as H,U as ie,V as re,W as ue}from"./scheduler.CBku5hu2.js";import{g as fe}from"./TextField.D8bvZ5xU.js";import{e as K}from"./Header.CKuajO5K.js";import{g as de}from"./FormSkeleton.DWivrZgw.js";import{S as he,i as _e}from"./index.EWtk3-rK.js";const I=q([]);let C=!1;async function S(){if(C)return O(I);C=!0;const{data:a,error:e}=await y.from("accounts").select("*").order("name",{ascending:!0});if(e)throw e;const t=a||[];return I.set(t),C=!1,t}async function me(a){let e=O(I);return e.length||(await S(),e=O(I)),e.find(t=>t.id===a)}async function ge(a){const{data:e,error:t}=await y.from("accounts").insert([a]).select();if(t)throw t;return await S(),e?e[0]:void 0}async function be(a,e){const{data:t,error:l}=await y.from("accounts").update(e).eq("id",a).select();if(l)throw l;return await S(),t?t[0]:void 0}async function ve(a){const{error:e}=await y.from("accounts").delete().eq("id",a);if(e)throw e;await S()}const X=q([]);let N=!1;async function P(){if(N)return O(X);N=!0;const{data:a,error:e}=await y.from("bills").select("*").order("created_at",{ascending:!0});if(e)throw e;const t=a||[];return X.set(t),N=!1,t}async function Be(a){const{data:e,error:t}=await y.from("bills").insert([a]).select();if(t)throw t;return await P(),e?e[0]:void 0}async function Oe(a,e){const{data:t,error:l}=await y.from("bills").update(e).eq("id",a).select();if(l)throw l;return await P(),t?t[0]:void 0}async function Ie(a){const{error:e}=await y.from("bills").delete().eq("id",a);if(e)throw e;await P()}let v=null;const ye=()=>{const a=q(!1),e=q([]),t=q();return v={stores:{loading:a,targetAccount:t,data:e},actions:{reload:async()=>{a.set(!0);const c=await S();e.set(c),a.set(!1)},createAccount:async c=>{a.set(!0);try{await ge(c)}catch(f){console.error(f)}finally{a.set(!1)}},updateAccount:async(c,f)=>{a.set(!0);try{await be(c,f)}catch(r){console.error(r)}finally{a.set(!1)}},deleteAccount:async c=>{a.set(!0);try{await ve(c)}catch(f){console.error(f)}finally{a.set(!1)}},canDeleteAccount:async c=>{a.set(!0);try{const r=(await fe()).filter(u=>u.account_id===c),_=(await P()).filter(u=>u.account_id===c);return r.length===0&&_.length===0}catch(f){console.error(f)}finally{a.set(!1)}},getAccount:async c=>{a.set(!0);try{return await me(c)}catch(f){console.error(f)}finally{a.set(!1)}}}},v},Pe=()=>v?.stores&&Object.keys(v.stores).length>0&&v?.actions&&Object.keys(v.actions).length>0?v:ye(),Ce=()=>{v=null};function Y(a,e,t){const l=a.slice();return l[12]=e[t],l}function Z(a){let e,t,l,s,i,h,b,g,c=a[1]&&x(a),f=K(a[2]),r=[];for(let n=0;n<f.length;n+=1)r[n]=$(Y(a,f,n));let A=[a[8],{class:"form-select"},{disabled:i=a[3]||a[4]},{"aria-label":a[1]}],_={};for(let n=0;n<A.length;n+=1)_=j(_,A[n]);let u=a[5]&&ee(a);return{c(){e=k("div"),c&&c.c(),t=U(),l=k("select"),s=k("option");for(let n=0;n<r.length;n+=1)r[n].c();h=U(),u&&u.c(),this.h()},l(n){e=T(n,"DIV",{class:!0});var o=E(e);c&&c.l(o),t=W(o),l=T(o,"SELECT",{class:!0,"aria-label":!0});var d=E(l);s=T(d,"OPTION",{}),E(s).forEach(m);for(let w=0;w<r.length;w+=1)r[w].l(d);d.forEach(m),h=W(o),u&&u.l(o),o.forEach(m),this.h()},h(){s.__value="",F(s,s.__value),z(l,_),a[0]===void 0&&ne(()=>a[10].call(l)),te(e,"class","d-flex flex-column gap-1")},m(n,o){D(n,e,o),c&&c.m(e,null),p(e,t),p(e,l),p(l,s);for(let d=0;d<r.length;d+=1)r[d]&&r[d].m(l,null);"value"in _&&(_.multiple?G:B)(l,_.value),l.autofocus&&l.focus(),B(l,a[0],!0),p(e,h),u&&u.m(e,null),b||(g=[J(l,"change",a[10]),J(l,"change",a[7])],b=!0)},p(n,o){if(n[1]?c?c.p(n,o):(c=x(n),c.c(),c.m(e,t)):c&&(c.d(1),c=null),o&4){f=K(n[2]);let d;for(d=0;d<f.length;d+=1){const w=Y(n,f,d);r[d]?r[d].p(w,o):(r[d]=$(w),r[d].c(),r[d].m(l,null))}for(;d<r.length;d+=1)r[d].d(1);r.length=f.length}z(l,_=de(A,[o&256&&n[8],{class:"form-select"},o&24&&i!==(i=n[3]||n[4])&&{disabled:i},o&2&&{"aria-label":n[1]}])),o&282&&"value"in _&&(_.multiple?G:B)(l,_.value),o&5&&B(l,n[0]),n[5]?u?u.p(n,o):(u=ee(n),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},d(n){n&&m(e),c&&c.d(),oe(r,n),u&&u.d(),b=!1,ce(g)}}}function x(a){let e,t,l;return{c(){e=k("div"),t=L(a[1]),l=L(a[6])},l(s){e=T(s,"DIV",{});var i=E(e);t=V(i,a[1]),l=V(i,a[6]),i.forEach(m)},m(s,i){D(s,e,i),p(e,t),p(e,l)},p(s,i){i&2&&H(t,s[1]),i&64&&H(l,s[6])},d(s){s&&m(e)}}}function $(a){let e,t=a[12].key+"",l,s;return{c(){e=k("option"),l=L(t),this.h()},l(i){e=T(i,"OPTION",{});var h=E(e);l=V(h,t),h.forEach(m),this.h()},h(){e.__value=s=a[12].value,F(e,e.__value)},m(i,h){D(i,e,h),p(e,l)},p(i,h){h&4&&t!==(t=i[12].key+"")&&H(l,t),h&4&&s!==(s=i[12].value)&&(e.__value=s,F(e,e.__value))},d(i){i&&m(e)}}}function ee(a){let e,t;return{c(){e=k("small"),t=new ie(!1),this.h()},l(l){e=T(l,"SMALL",{class:!0});var s=E(e);t=re(s,!1),s.forEach(m),this.h()},h(){t.a=null,te(e,"class","fw-lighter fst-italic")},m(l,s){D(l,e,s),t.m(a[5],e)},p(l,s){s&32&&t.p(l[5])},d(l){l&&m(e)}}}function Ae(a){let e,t=a[2].length>0&&Z(a);return{c(){t&&t.c(),e=M()},l(l){t&&t.l(l),e=M()},m(l,s){t&&t.m(l,s),D(l,e,s)},p(l,[s]){l[2].length>0?t?t.p(l,s):(t=Z(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Q,o:Q,d(l){l&&m(e),t&&t.d(l)}}}function pe(a,e,t){let l;const s=["label","options","value","loading","required","disabled","helperText"];let i=R(e,s),{label:h=""}=e,{options:b}=e,{value:g}=e,{loading:c=!1}=e,{required:f=!1}=e,{disabled:r}=e,{helperText:A=""}=e;const _=le(),u=()=>{_("change",{value:g})};function n(){g=ue(this),t(0,g),t(2,b)}return a.$$set=o=>{e=j(j({},e),se(o)),t(8,i=R(e,s)),"label"in o&&t(1,h=o.label),"options"in o&&t(2,b=o.options),"value"in o&&t(0,g=o.value),"loading"in o&&t(3,c=o.loading),"required"in o&&t(9,f=o.required),"disabled"in o&&t(4,r=o.disabled),"helperText"in o&&t(5,A=o.helperText)},a.$$.update=()=>{a.$$.dirty&512&&t(6,l=f?"*":"")},[g,h,b,c,r,A,l,u,i,f,n]}class Ne extends he{constructor(e){super(),_e(this,e,pe,Ae,ae,{label:1,options:2,value:0,loading:3,required:9,disabled:4,helperText:5})}}export{Ne as S,P as a,Ie as b,Be as c,Ce as d,Pe as g,Oe as u};
