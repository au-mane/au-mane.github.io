import{k as qe,s as dt,r as _t,n as Re,h as je,v as bt,b as Ge,o as yt,B as et}from"./scheduler.DyivmMiW.js";import{S as pt,i as mt,v as Te,o as Y,t as oe,x as ht,a as de,w as gt,d as T,e as b,s as V,b as X,c as Ue,j as y,k as A,l as W,f as B,m as Z,g as Fe,n as p,y as Q,q as i,C as ee,p as He,B as U,r as re,u as ze,E as tt,D as We,F as wt}from"./index.BqK79KpI.js";import{s as Ne,e as ke}from"./supabase-config.DGP-irWd.js";import{f as Ae,p as pe,c as Dt,D as It,g as Tt}from"./confirm.service.D8NKo1ly.js";import{f as De}from"./app.state.DIzCX3o3.js";import{S as kt}from"./Spinner.BlcZoQhc.js";import{w as fe}from"./index.Cdixjbko.js";import{L as Ct}from"./Loading.Do7G-gm4.js";function St(s){const e={};return s.forEach(n=>{const t=n.date.split("T")[0];e[t]||(e[t]=[]),e[t].push(n)}),Object.entries(e).map(([n,t])=>({dateStr:n,transactions:t}))}const nt=s=>s?Ae(pe(s,"yyyy-MM-dd",new Date),"MMM dd"):"",Et=s=>s.map(e=>({id:e?.id||0,start:e?.start_at?Ae(pe(e.start_at.split("T")[0],"yyyy-MM-dd",new Date),"MMM dd"):"",end:e?.end_at?Ae(pe(e.end_at.split("T")[0],"yyyy-MM-dd",new Date),"MMM dd"):"",max_spending_limit:e?.settings?.max_spend_limit??0}));function Mt(s){const e=new Date;return s.find(n=>{if(n.start_at&&n.end_at){const t=pe(n.start_at.split("T")[0],"yyyy-MM-dd",new Date),l=pe(n.end_at.split("T")[0],"yyyy-MM-dd",new Date);return e>=t&&e<=l}return!1})}const Nt={type:"expense",amount:0,description:"",source:"",date:""},Je=fe([]);let Qe=!1;async function Ke(s="",e=""){if(Qe)return qe(Je);Qe=!0;let n=[];if(s&&e){const{data:t,error:l}=await Ne.from("transactions").select("*").gte("date",s).lte("date",e).order("date",{ascending:!1});if(l)throw l;n=t||[],Je.set(n)}else{const{data:t,error:l}=await Ne.from("transactions").select("*").order("date",{ascending:!1});if(l)throw l;n=t||[],Je.set(n)}return Qe=!1,n}async function At(s){const{data:e,error:n}=await Ne.from("transactions").insert([s]).select();if(n)throw n;return await Ke(),e?e[0]:void 0}async function Vt(s,e){const{data:n,error:t}=await Ne.from("transactions").update(e).eq("id",s).select();if(t)throw t;return await Ke(),n?n[0]:void 0}async function Bt(s){const{error:e}=await Ne.from("transactions").delete().eq("id",s);if(e)throw e;await Ke()}let Me=null;const Lt=()=>{const s=fe(!1),e=fe([]),n=fe([]),t=fe(void 0),l=fe([]),u=fe(""),o=fe("");let k,g;return Me={stores:{loading:s,data:e,dbData:n,dayTransactions:l,startDate:u,endDate:o,targetBudget:t},actions:{reload:async(v=!1)=>{s.set(!0);const _=qe(u),a=qe(o);if(v||k!==_&&g!==a){k=_,g=a;const f=await Ke(_,a);let w=qe(t)?.settings?.max_spend_limit||0;const N=f.reverse().map(E=>{const{type:D,amount:M}=E;return w=D==="expense"?w-M:w,{...E,balance:w}}).reverse(),C=St(N);l.set(C)}s.set(!1)}}},Me},vt=()=>Me?.stores&&Object.keys(Me.stores).length>0?Me:Lt();function st(s){let e,n,t,l="Date*",u,o,k,g,m,v="Date helper text here",_,a,f,w="Amount*",N,C,E,D,M,L="Amount helper text here",q,r,d,j="Description*",O,c,K,ie,J,te="Description helper text here",ue,G,x,Ve="Source*",Ce,P,me,Se,H,ne,_e=s[12].message+"",he,ge,Ee,se,h,ae,ve,$,Be,R,Ye,Xe;h=new kt({props:{size:"xs"}});let F=s[4]&&at(s);function Ze(I,S){return I[4]?Pt:Ot}let Le=Ze(s),le=Le(s),z=s[15]&&lt();return{c(){e=b("div"),n=b("div"),t=b("div"),t.textContent=l,u=V(),o=b("input"),g=V(),m=b("small"),m.textContent=v,_=V(),a=b("div"),f=b("div"),f.textContent=w,N=V(),C=b("input"),D=V(),M=b("small"),M.textContent=L,q=V(),r=b("div"),d=b("div"),d.textContent=j,O=V(),c=b("input"),ie=V(),J=b("small"),J.textContent=te,ue=V(),G=b("div"),x=b("div"),x.textContent=Ve,Ce=V(),P=b("input"),Se=V(),H=b("div"),ne=b("small"),he=X(_e),Ee=V(),se=b("span"),Ue(h.$$.fragment),ae=V(),F&&F.c(),ve=V(),$=b("button"),le.c(),Be=V(),z&&z.c(),this.h()},l(I){e=y(I,"DIV",{class:!0});var S=A(e);n=y(S,"DIV",{class:!0});var be=A(n);t=y(be,"DIV",{"data-svelte-h":!0}),W(t)!=="svelte-1992pd0"&&(t.textContent=l),u=B(be),o=y(be,"INPUT",{name:!0,type:!0,class:!0}),g=B(be),m=y(be,"SMALL",{class:!0,"data-svelte-h":!0}),W(m)!=="svelte-oew5wf"&&(m.textContent=v),be.forEach(T),_=B(S),a=y(S,"DIV",{class:!0});var ye=A(a);f=y(ye,"DIV",{"data-svelte-h":!0}),W(f)!=="svelte-r3jt44"&&(f.textContent=w),N=B(ye),C=y(ye,"INPUT",{name:!0,type:!0,class:!0}),D=B(ye),M=y(ye,"SMALL",{class:!0,"data-svelte-h":!0}),W(M)!=="svelte-1h9aie7"&&(M.textContent=L),ye.forEach(T),q=B(S),r=y(S,"DIV",{class:!0});var we=A(r);d=y(we,"DIV",{"data-svelte-h":!0}),W(d)!=="svelte-8167a8"&&(d.textContent=j),O=B(we),c=y(we,"INPUT",{name:!0,type:!0,class:!0,placeholder:!0}),ie=B(we),J=y(we,"SMALL",{class:!0,"data-svelte-h":!0}),W(J)!=="svelte-1x398eh"&&(J.textContent=te),we.forEach(T),ue=B(S),G=y(S,"DIV",{class:!0});var Oe=A(G);x=y(Oe,"DIV",{"data-svelte-h":!0}),W(x)!=="svelte-1irjajf"&&(x.textContent=Ve),Ce=B(Oe),P=y(Oe,"INPUT",{name:!0,type:!0,class:!0,placeholder:!0}),Oe.forEach(T),Se=B(S),H=y(S,"DIV",{class:!0});var ce=A(H);ne=y(ce,"SMALL",{class:!0});var xe=A(ne);he=Z(xe,_e),xe.forEach(T),Ee=B(ce),se=y(ce,"SPAN",{});var $e=A(se);Fe(h.$$.fragment,$e),$e.forEach(T),ae=B(ce),F&&F.l(ce),ve=B(ce),$=y(ce,"BUTTON",{class:!0});var Pe=A($);le.l(Pe),Be=B(Pe),z&&z.l(Pe),Pe.forEach(T),ce.forEach(T),S.forEach(T),this.h()},h(){p(o,"name",k=s[1]+"-date"),p(o,"type","date"),p(o,"class","form-control"),o.disabled=s[7],o.required=!0,Q(o,"is-invalid",s[13]),p(m,"class","fw-lighter fst-italic"),p(n,"class","d-flex flex-column gap-2"),p(C,"name",E=s[1]+"-amount"),p(C,"type","text"),p(C,"class","form-control text-end"),C.disabled=s[7],C.required=!0,Q(C,"is-invalid",s[14]),p(M,"class","fw-lighter fst-italic"),p(a,"class","d-flex flex-column gap-2"),p(c,"name",K=s[1]+"-description"),p(c,"type","text"),p(c,"class","form-control"),p(c,"placeholder","Description"),c.disabled=s[7],c.required=!0,Q(c,"is-invalid",s[6]),p(J,"class","fw-lighter fst-italic"),p(r,"class","d-flex flex-column gap-2"),p(P,"name",me=s[1]+"-source"),p(P,"type","text"),p(P,"class","form-control"),p(P,"placeholder","Source"),P.disabled=s[7],P.required=!0,Q(P,"is-invalid",s[5]),p(G,"class","d-flex flex-column gap-2"),p(ne,"class",ge="fw-lighter fst-italic text-"+s[12].type),Q(se,"d-none",!s[7]),p($,"class","btn btn-primary position-relative"),p(H,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),p(e,"class","d-flex flex-column gap-4")},m(I,S){Y(I,e,S),i(e,n),i(n,t),i(n,u),i(n,o),s[21](o),ee(o,s[2]),i(n,g),i(n,m),i(e,_),i(e,a),i(a,f),i(a,N),i(a,C),s[25](C),ee(C,s[0].amount),i(a,D),i(a,M),i(e,q),i(e,r),i(r,d),i(r,O),i(r,c),s[29](c),ee(c,s[0].description),i(r,ie),i(r,J),i(e,ue),i(e,G),i(G,x),i(G,Ce),i(G,P),s[33](P),ee(P,s[0].source),i(e,Se),i(e,H),i(H,ne),i(ne,he),i(H,Ee),i(H,se),He(h,se,null),i(H,ae),F&&F.m(H,null),i(H,ve),i(H,$),le.m($,null),i($,Be),z&&z.m($,null),R=!0,Ye||(Xe=[U(o,"focus",s[22]),U(o,"keyup",s[23]),U(o,"input",s[24]),U(C,"focus",s[26]),U(C,"keyup",s[27]),U(C,"input",s[28]),U(c,"focus",s[30]),U(c,"keyup",s[31]),U(c,"input",s[32]),U(P,"focus",s[34]),U(P,"keyup",s[35]),U(P,"input",s[36]),U($,"click",s[17])],Ye=!0)},p(I,S){(!R||S[0]&2&&k!==(k=I[1]+"-date"))&&p(o,"name",k),(!R||S[0]&128)&&(o.disabled=I[7]),S[0]&4&&ee(o,I[2]),(!R||S[0]&8192)&&Q(o,"is-invalid",I[13]),(!R||S[0]&2&&E!==(E=I[1]+"-amount"))&&p(C,"name",E),(!R||S[0]&128)&&(C.disabled=I[7]),S[0]&1&&C.value!==I[0].amount&&ee(C,I[0].amount),(!R||S[0]&16384)&&Q(C,"is-invalid",I[14]),(!R||S[0]&2&&K!==(K=I[1]+"-description"))&&p(c,"name",K),(!R||S[0]&128)&&(c.disabled=I[7]),S[0]&1&&c.value!==I[0].description&&ee(c,I[0].description),(!R||S[0]&64)&&Q(c,"is-invalid",I[6]),(!R||S[0]&2&&me!==(me=I[1]+"-source"))&&p(P,"name",me),(!R||S[0]&128)&&(P.disabled=I[7]),S[0]&1&&P.value!==I[0].source&&ee(P,I[0].source),(!R||S[0]&32)&&Q(P,"is-invalid",I[5]),(!R||S[0]&4096)&&_e!==(_e=I[12].message+"")&&re(he,_e),(!R||S[0]&4096&&ge!==(ge="fw-lighter fst-italic text-"+I[12].type))&&p(ne,"class",ge),(!R||S[0]&128)&&Q(se,"d-none",!I[7]),I[4]?F?F.p(I,S):(F=at(I),F.c(),F.m(H,ve)):F&&(F.d(1),F=null),Le!==(Le=Ze(I))&&(le.d(1),le=Le(I),le&&(le.c(),le.m($,Be))),I[15]?z||(z=lt(),z.c(),z.m($,null)):z&&(z.d(1),z=null)},i(I){R||(oe(h.$$.fragment,I),R=!0)},o(I){de(h.$$.fragment,I),R=!1},d(I){I&&T(e),s[21](null),s[25](null),s[29](null),s[33](null),ze(h),F&&F.d(),le.d(),z&&z.d(),Ye=!1,_t(Xe)}}}function at(s){let e,n="<span>Delete</span>",t,l;return{c(){e=b("button"),e.innerHTML=n,this.h()},l(u){e=y(u,"BUTTON",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-4hjfsp"&&(e.innerHTML=n),this.h()},h(){p(e,"class","btn btn-danger position-relative")},m(u,o){Y(u,e,o),t||(l=U(e,"click",s[16]),t=!0)},p:Re,d(u){u&&T(e),t=!1,l()}}}function Ot(s){let e,n="Create";return{c(){e=b("span"),e.textContent=n},l(t){e=y(t,"SPAN",{"data-svelte-h":!0}),W(e)!=="svelte-1wf0js6"&&(e.textContent=n)},m(t,l){Y(t,e,l)},d(t){t&&T(e)}}}function Pt(s){let e,n="Save";return{c(){e=b("span"),e.textContent=n},l(t){e=y(t,"SPAN",{"data-svelte-h":!0}),W(e)!=="svelte-l126tb"&&(e.textContent=n)},m(t,l){Y(t,e,l)},d(t){t&&T(e)}}}function lt(s){let e,n='<span class="visually-hidden">Item not saved</span>';return{c(){e=b("span"),e.innerHTML=n,this.h()},l(t){e=y(t,"SPAN",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-1sxrz4i"&&(e.innerHTML=n),this.h()},h(){p(e,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(t,l){Y(t,e,l)},d(t){t&&T(e)}}}function jt(s){let e,n,t=s[0]&&st(s);return{c(){t&&t.c(),e=Te()},l(l){t&&t.l(l),e=Te()},m(l,u){t&&t.m(l,u),Y(l,e,u),n=!0},p(l,u){l[0]?t?(t.p(l,u),u[0]&1&&oe(t,1)):(t=st(l),t.c(),oe(t,1),t.m(e.parentNode,e)):t&&(ht(),de(t,1,1,()=>{t=null}),gt())},i(l){n||(oe(t),n=!0)},o(l){de(t),n=!1},d(l){l&&T(e),t&&t.d(l)}}}function qt(s,e,n){let t,l,u,o,k,g,m,{name:v=""}=e,{drawerId:_=""}=e,{transaction:a}=e;const{actions:{reload:f}}=vt();let w=!1,N,C=0,E,D,M,L,q={message:"",type:"info"},r,d={source:!1,description:!1,amount:!1,date:!1};const j=()=>{const h=`[data-bs-target="#${_}"]`,ae=document.querySelector(h);ae&&ae.click()},O=()=>{n(3,d={source:!1,description:!1,date:!1,amount:!1}),n(0,a={...Nt}),n(7,w=!1)},c=(h,ae=0,ve="info")=>{n(12,q.message=h,q),n(12,q.type=ve,q),ae&&setTimeout(()=>{n(12,q.message="",q)},ae)},K=async()=>{if(!t){c("ID is not defined",0,"danger");return}try{await Bt(t),await f(!0),setTimeout(()=>{n(7,w=!1),n(20,r={...a,id:t,date:pe(N,"yyyy-MM-dd",new Date).toISOString()}),c("Transaction Deleted",3e3,"success"),j()},800)}catch(h){setTimeout(()=>{n(7,w=!1),console.error("Save failed:",h),c("Failed to save event. Please try again.",7e3,"danger")},800)}},ie=()=>{n(7,w=!0),Dt({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:h=>{h&&K(),O()}})},J=async()=>{if(!l){c("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!m){let h=[];o&&h.push("Amount is invalid"),u&&h.push("Date is invalid"),g&&h.push("Description is invalid"),k&&h.push("Source is invalid"),c(h.join(". ")+".  Please address accordingly.",0,"danger");return}if(!w){c("Saving ..."),n(7,w=!0);try{const h={...a,date:pe(N,"yyyy-MM-dd",new Date).toISOString()};delete h.balance,t?await Vt(t,h):await At(h),await f(!0),setTimeout(()=>{n(7,w=!1),n(20,r={...a,id:t}),c("Saved",3e3,"success"),t||O(),j()},800)}catch(h){setTimeout(()=>{n(7,w=!1),console.error("Save failed:",h),c("Failed to save event. Please try again.",7e3,"danger"),t||O()},800)}}};function te(h){je[h?"unshift":"push"](()=>{M=h,n(10,M)})}const ue=()=>M.select(),G=()=>n(3,d.date=!0,d);function x(){N=this.value,n(2,N),n(4,t),n(0,a),n(19,C)}function Ve(h){je[h?"unshift":"push"](()=>{L=h,n(11,L)})}const Ce=()=>L.select(),P=()=>n(3,d.amount=!0,d);function me(){a.amount=this.value,n(0,a)}function Se(h){je[h?"unshift":"push"](()=>{E=h,n(8,E)})}const H=()=>E.select(),ne=()=>n(3,d.description=!0,d);function _e(){a.description=this.value,n(0,a)}function he(h){je[h?"unshift":"push"](()=>{D=h,n(9,D)})}const ge=()=>D.select(),Ee=()=>n(3,d.source=!0,d);function se(){a.source=this.value,n(0,a)}return s.$$set=h=>{"name"in h&&n(1,v=h.name),"drawerId"in h&&n(18,_=h.drawerId),"transaction"in h&&n(0,a=h.transaction)},s.$$.update=()=>{s.$$.dirty[0]&1&&n(4,t=a?.id),s.$$.dirty[0]&524305&&t&&a&&C!==t&&(n(7,w=!0),setTimeout(()=>{n(20,r={...a}),n(19,C=t),n(2,N=Ae(a.date,"yyyy-MM-dd")),n(7,w=!1)},800)),s.$$.dirty[0]&1048581&&n(15,l=r?.date!==N||r?.amount!==a?.amount||r?.description!==a?.description||r?.source!==a?.source),s.$$.dirty[0]&9&&n(13,u=d.date&&a.date===""),s.$$.dirty[0]&9&&n(14,o=d.amount&&a.amount===0),s.$$.dirty[0]&9&&n(5,k=d.source&&a.source===""),s.$$.dirty[0]&9&&n(6,g=d.description&&a.description===""),s.$$.dirty[0]&96&&(m=!k&&!g)},[a,v,N,d,t,k,g,w,E,D,M,L,q,u,o,l,ie,J,_,C,r,te,ue,G,x,Ve,Ce,P,me,Se,H,ne,_e,he,ge,Ee,se]}class Rt extends pt{constructor(e){super(),mt(this,e,qt,jt,dt,{name:1,drawerId:18,transaction:0},null,[-1,-1])}}function rt(s,e,n){const t=s.slice();return t[20]=e[n],t}function ot(s,e,n){const t=s.slice();return t[23]=e[n],t}function it(s,e,n){const t=s.slice();return t[26]=e[n],t}function Ut(s){let e,n;return e=new Rt({props:{name:"member-list-item-form-new",drawerId:Ie,transaction:s[3]}}),{c(){Ue(e.$$.fragment)},l(t){Fe(e.$$.fragment,t)},m(t,l){He(e,t,l),n=!0},p(t,l){const u={};l&8&&(u.transaction=t[3]),e.$set(u)},i(t){n||(oe(e.$$.fragment,t),n=!0)},o(t){de(e.$$.fragment,t),n=!1},d(t){ze(e,t)}}}function ut(s){let e,n=s[26].start+"",t,l,u=s[26].end+"",o,k,g=De(s[26].max_spending_limit)+"",m,v,_;return{c(){e=b("option"),t=X(n),l=X(" to "),o=X(u),k=X(" ("),m=X(g),v=X(`)
			`),this.h()},l(a){e=y(a,"OPTION",{});var f=A(e);t=Z(f,n),l=Z(f," to "),o=Z(f,u),k=Z(f," ("),m=Z(f,g),v=Z(f,`)
			`),f.forEach(T),this.h()},h(){e.__value=_=s[26].id,ee(e,e.__value)},m(a,f){Y(a,e,f),i(e,t),i(e,l),i(e,o),i(e,k),i(e,m),i(e,v)},p(a,f){f&4&&n!==(n=a[26].start+"")&&re(t,n),f&4&&u!==(u=a[26].end+"")&&re(o,u),f&4&&g!==(g=De(a[26].max_spending_limit)+"")&&re(m,g),f&4&&_!==(_=a[26].id)&&(e.__value=_,ee(e,e.__value))},d(a){a&&T(e)}}}function Ft(s){let e,n=ke(s[5]),t=[];for(let l=0;l<n.length;l+=1)t[l]=ft(rt(s,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=Te()},l(l){for(let u=0;u<t.length;u+=1)t[u].l(l);e=Te()},m(l,u){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(l,u);Y(l,e,u)},p(l,u){if(u&1056){n=ke(l[5]);let o;for(o=0;o<n.length;o+=1){const k=rt(l,n,o);t[o]?t[o].p(k,u):(t[o]=ft(k),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=n.length}},i:Re,o:Re,d(l){l&&T(e),We(t,l)}}}function Ht(s){let e,n;return e=new Ct({}),{c(){Ue(e.$$.fragment)},l(t){Fe(e.$$.fragment,t)},m(t,l){He(e,t,l),n=!0},p:Re,i(t){n||(oe(e.$$.fragment,t),n=!0)},o(t){de(e.$$.fragment,t),n=!1},d(t){ze(e,t)}}}function ct(s){let e,n,t,l=s[23].description+"",u,o,k,g=s[23].source+"",m,v,_,a,f,w=De(s[23].amount)+"",N,C,E,D,M=De(s[23]?.balance)+"",L,q,r,d;function j(){return s[15](s[23])}return{c(){e=b("div"),n=b("div"),t=b("div"),u=X(l),o=V(),k=b("div"),m=X(g),v=V(),_=b("div"),a=b("div"),f=b("button"),N=X(w),E=V(),D=b("div"),L=X(M),q=V(),this.h()},l(O){e=y(O,"DIV",{class:!0});var c=A(e);n=y(c,"DIV",{});var K=A(n);t=y(K,"DIV",{});var ie=A(t);u=Z(ie,l),ie.forEach(T),o=B(K),k=y(K,"DIV",{class:!0});var J=A(k);m=Z(J,g),J.forEach(T),K.forEach(T),v=B(c),_=y(c,"DIV",{class:!0});var te=A(_);a=y(te,"DIV",{class:!0});var ue=A(a);f=y(ue,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var G=A(f);N=Z(G,w),G.forEach(T),ue.forEach(T),E=B(te),D=y(te,"DIV",{class:!0});var x=A(D);L=Z(x,M),x.forEach(T),te.forEach(T),q=B(c),c.forEach(T),this.h()},h(){p(k,"class","fw-light text-muted"),p(f,"class","btn btn-sm btn-link ps-0"),p(f,"type","button"),p(f,"data-bs-toggle","offcanvas"),p(f,"data-bs-target","#"+Ie),p(f,"aria-controls",Ie),p(a,"class",C=et(s[23].type)+" svelte-xe6rrl"),p(D,"class","fw-lighter"),Q(D,"text-warning",s[23]?.balance!==void 0&&s[23]?.balance<0),p(_,"class","d-flex justify-content-between align-items-center"),p(e,"class","border-top p-2")},m(O,c){Y(O,e,c),i(e,n),i(n,t),i(t,u),i(n,o),i(n,k),i(k,m),i(e,v),i(e,_),i(_,a),i(a,f),i(f,N),i(_,E),i(_,D),i(D,L),i(e,q),r||(d=U(f,"click",j),r=!0)},p(O,c){s=O,c&32&&l!==(l=s[23].description+"")&&re(u,l),c&32&&g!==(g=s[23].source+"")&&re(m,g),c&32&&w!==(w=De(s[23].amount)+"")&&re(N,w),c&32&&C!==(C=et(s[23].type)+" svelte-xe6rrl")&&p(a,"class",C),c&32&&M!==(M=De(s[23]?.balance)+"")&&re(L,M),c&32&&Q(D,"text-warning",s[23]?.balance!==void 0&&s[23]?.balance<0)},d(O){O&&T(e),r=!1,d()}}}function ft(s){let e,n,t=nt(s[20]?.dateStr)+"",l,u,o,k,g=ke(s[20].transactions),m=[];for(let v=0;v<g.length;v+=1)m[v]=ct(ot(s,g,v));return{c(){e=b("div"),n=b("div"),l=X(t),u=V(),o=b("div");for(let v=0;v<m.length;v+=1)m[v].c();k=V(),this.h()},l(v){e=y(v,"DIV",{});var _=A(e);n=y(_,"DIV",{class:!0});var a=A(n);l=Z(a,t),a.forEach(T),u=B(_),o=y(_,"DIV",{});var f=A(o);for(let w=0;w<m.length;w+=1)m[w].l(f);f.forEach(T),k=B(_),_.forEach(T),this.h()},h(){p(n,"class","fw-bolder text-uppercase p-2")},m(v,_){Y(v,e,_),i(e,n),i(n,l),i(e,u),i(e,o);for(let a=0;a<m.length;a+=1)m[a]&&m[a].m(o,null);i(e,k)},p(v,_){if(_&32&&t!==(t=nt(v[20]?.dateStr)+"")&&re(l,t),_&1056){g=ke(v[20].transactions);let a;for(a=0;a<g.length;a+=1){const f=ot(v,g,a);m[a]?m[a].p(f,_):(m[a]=ct(f),m[a].c(),m[a].m(o,null))}for(;a<m.length;a+=1)m[a].d(1);m.length=g.length}},d(v){v&&T(e),We(m,v)}}}function zt(s){let e,n,t,l,u,o="Range",k,g,m,v,_,a,f,w,N,C;e=new It({props:{title:"Drawer Title",id:Ie,$$slots:{default:[Ut]},$$scope:{ctx:s}}});let E=ke(s[2]),D=[];for(let r=0;r<E.length;r+=1)D[r]=ut(it(s,E,r));const M=[Ht,Ft],L=[];function q(r,d){return r[4]?0:r[5].length&&r[1]?1:-1}return~(_=q(s))&&(a=L[_]=M[_](s)),{c(){Ue(e.$$.fragment),n=V(),t=b("div"),l=b("select"),u=b("option"),u.textContent=o;for(let r=0;r<D.length;r+=1)D[r].c();k=V(),g=b("button"),m=b("i"),v=V(),a&&a.c(),f=Te(),this.h()},l(r){Fe(e.$$.fragment,r),n=B(r),t=y(r,"DIV",{class:!0});var d=A(t);l=y(d,"SELECT",{class:!0,"aria-label":!0});var j=A(l);u=y(j,"OPTION",{"data-svelte-h":!0}),W(u)!=="svelte-1k3fjyk"&&(u.textContent=o);for(let c=0;c<D.length;c+=1)D[c].l(j);j.forEach(T),k=B(d),g=y(d,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var O=A(g);m=y(O,"I",{class:!0}),A(m).forEach(T),O.forEach(T),d.forEach(T),v=B(r),a&&a.l(r),f=Te(),this.h()},h(){u.selected=!0,u.__value="Range",ee(u,u.__value),p(l,"class","form-select"),p(l,"aria-label","Default select example"),s[0]===void 0&&bt(()=>s[13].call(l)),p(m,"class","bi bi-plus"),p(g,"class","btn btn-sm btn-secondary"),p(g,"type","button"),p(g,"data-bs-toggle","offcanvas"),p(g,"data-bs-target","#"+Ie),p(g,"aria-controls",Ie),p(t,"class","transaction-page d-flex justify-content-between gap-3")},m(r,d){He(e,r,d),Y(r,n,d),Y(r,t,d),i(t,l),i(l,u);for(let j=0;j<D.length;j+=1)D[j]&&D[j].m(l,null);tt(l,s[0],!0),i(t,k),i(t,g),i(g,m),Y(r,v,d),~_&&L[_].m(r,d),Y(r,f,d),w=!0,N||(C=[U(l,"change",s[13]),U(g,"click",s[14])],N=!0)},p(r,[d]){const j={};if(d&536870920&&(j.$$scope={dirty:d,ctx:r}),e.$set(j),d&4){E=ke(r[2]);let c;for(c=0;c<E.length;c+=1){const K=it(r,E,c);D[c]?D[c].p(K,d):(D[c]=ut(K),D[c].c(),D[c].m(l,null))}for(;c<D.length;c+=1)D[c].d(1);D.length=E.length}d&5&&tt(l,r[0]);let O=_;_=q(r),_===O?~_&&L[_].p(r,d):(a&&(ht(),de(L[O],1,1,()=>{L[O]=null}),gt()),~_?(a=L[_],a?a.p(r,d):(a=L[_]=M[_](r),a.c()),oe(a,1),a.m(f.parentNode,f)):a=null)},i(r){w||(oe(e.$$.fragment,r),oe(a),w=!0)},o(r){de(e.$$.fragment,r),de(a),w=!1},d(r){r&&(T(n),T(t),T(v),T(f)),ze(e,r),We(D,r),~_&&L[_].d(r),N=!1,_t(C)}}}const Ie="transactions-form";function Kt(s,e,n){let t,l,u;const{stores:{loading:o,targetBudget:k,dayTransactions:g,startDate:m,endDate:v},actions:{reload:_}}=vt();Ge(s,o,d=>n(4,l=d)),Ge(s,k,d=>n(1,t=d)),Ge(s,g,d=>n(5,u=d));let a=[],f,w=[],N,C,E=!1;const D={type:"expense",amount:0,description:"test",source:"test",date:Ae(new Date,"yyyy-mm-dd")},M=d=>{n(3,C=d)};yt(async()=>{n(11,w=await Tt()),n(2,a=Et(w)),N=Mt(w),n(0,f=N?.id)});function L(){f=wt(this),n(0,f),n(2,a)}const q=()=>M({...D}),r=d=>M(d);return s.$$.update=()=>{if(s.$$.dirty&6147&&f&&!E&&t?.id!==f&&(k.set(w.find(d=>d.id===f)),t&&t.start_at&&t.end_at)){n(12,E=!0);const d=t.start_at.split("T")[0],j=t.end_at.split("T")[0];m.set(d),v.set(j),_(),n(12,E=!1)}},[f,t,a,C,l,u,o,k,g,D,M,w,E,L,q,r]}class $t extends pt{constructor(e){super(),mt(this,e,Kt,zt,dt,{})}}export{$t as T};
