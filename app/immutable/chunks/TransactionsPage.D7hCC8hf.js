import{k as qe,s as dt,r as _t,n as Re,h as je,v as bt,b as Ge,o as yt,B as et}from"./scheduler.DyivmMiW.js";import{S as pt,i as mt,v as De,o as Y,t as re,x as ht,a as fe,w as gt,d as D,e as w,s as P,b as X,c as Ue,j as T,k as L,l as Q,f as j,m as Z,g as Fe,n as _,y as J,q as i,C as $,p as He,B as U,r as le,u as ze,E as tt,D as Qe,F as wt}from"./index.BqK79KpI.js";import{s as Ne,e as Ie}from"./supabase-config.DGP-irWd.js";import{f as Ve,p as pe,c as Tt,D as kt,g as Dt}from"./confirm.service.D8NKo1ly.js";import{f as Te}from"./app.state.DIzCX3o3.js";import{S as It}from"./Spinner.BlcZoQhc.js";import{w as ce}from"./index.Cdixjbko.js";import{L as Ct}from"./Loading.Do7G-gm4.js";function Et(s){const e={};return s.forEach(n=>{const t=n.date.split("T")[0];e[t]||(e[t]=[]),e[t].push(n)}),Object.entries(e).map(([n,t])=>({dateStr:n,transactions:t}))}const nt=s=>s?Ve(pe(s,"yyyy-MM-dd",new Date),"MMM dd"):"",St=s=>s.map(e=>({id:e?.id||0,start:e?.start_at?Ve(pe(e.start_at.split("T")[0],"yyyy-MM-dd",new Date),"MMM dd"):"",end:e?.end_at?Ve(pe(e.end_at.split("T")[0],"yyyy-MM-dd",new Date),"MMM dd"):"",max_spending_limit:e?.settings?.max_spend_limit??0}));function Mt(s){const e=new Date;return s.find(n=>{if(n.start_at&&n.end_at){const t=pe(n.start_at.split("T")[0],"yyyy-MM-dd",new Date),a=pe(n.end_at.split("T")[0],"yyyy-MM-dd",new Date);return e>=t&&e<=a}return!1})}const Nt={type:"expense",amount:0,description:"",source:"",date:""},We=ce([]);let Je=!1;async function Ke(s="",e=""){if(Je)return qe(We);Je=!0;let n=[];if(s&&e){const{data:t,error:a}=await Ne.from("transactions").select("*").gte("date",s).lte("date",e).order("date",{ascending:!1});if(a)throw a;n=t||[],We.set(n)}else{const{data:t,error:a}=await Ne.from("transactions").select("*").order("date",{ascending:!1});if(a)throw a;n=t||[],We.set(n)}return Je=!1,n}async function Vt(s){const{data:e,error:n}=await Ne.from("transactions").insert([s]).select();if(n)throw n;return await Ke(),e?e[0]:void 0}async function At(s,e){const{data:n,error:t}=await Ne.from("transactions").update(e).eq("id",s).select();if(t)throw t;return await Ke(),n?n[0]:void 0}async function Bt(s){const{error:e}=await Ne.from("transactions").delete().eq("id",s);if(e)throw e;await Ke()}let Me=null;const Lt=()=>{const s=ce(!1),e=ce([]),n=ce([]),t=ce(void 0),a=ce([]),u=ce(""),o=ce("");let I,h;return Me={stores:{loading:s,data:e,dbData:n,dayTransactions:a,startDate:u,endDate:o,targetBudget:t},actions:{reload:async(g=!1)=>{s.set(!0);const d=qe(u),l=qe(o);if(g||I!==d&&h!==l){I=d,h=l;const r=await Ke(d,l);let b=qe(t)?.settings?.max_spend_limit||0;const N=r.reverse().map(A=>{const{type:y,amount:S}=A;return b=y==="expense"?b-S:b,{...A,balance:b}}).reverse(),V=Et(N);a.set(V)}s.set(!1)}}},Me},vt=()=>Me?.stores&&Object.keys(Me.stores).length>0?Me:Lt();function st(s){let e,n,t,a="Date*",u,o,I,h,p,g,d="Amount*",l,r,b,N,V,A="How much money was spent",y,S,M,q="Description*",c,f,C,O,m,W="Expense description i.e. Groceries, Tuition, Tennis fee",oe,H,G,de="Source*",ie,B,me,Ce,ee,Ae="Expense source. i.e. Walmart, Costco, Cafe Trang etc.",Ee,z,te,_e=s[12].message+"",he,ge,Se,ne,v,se,ve,x,Be,R,Ye,Xe;v=new It({props:{size:"xs"}});let F=s[4]&&at(s);function Ze(k,E){return k[4]?Pt:Ot}let Le=Ze(s),ae=Le(s),K=s[15]&&lt();return{c(){e=w("div"),n=w("div"),t=w("div"),t.textContent=a,u=P(),o=w("input"),h=P(),p=w("div"),g=w("div"),g.textContent=d,l=P(),r=w("input"),N=P(),V=w("small"),V.textContent=A,y=P(),S=w("div"),M=w("div"),M.textContent=q,c=P(),f=w("input"),O=P(),m=w("small"),m.textContent=W,oe=P(),H=w("div"),G=w("div"),G.textContent=de,ie=P(),B=w("input"),Ce=P(),ee=w("small"),ee.textContent=Ae,Ee=P(),z=w("div"),te=w("small"),he=X(_e),Se=P(),ne=w("span"),Ue(v.$$.fragment),se=P(),F&&F.c(),ve=P(),x=w("button"),ae.c(),Be=P(),K&&K.c(),this.h()},l(k){e=T(k,"DIV",{class:!0});var E=L(e);n=T(E,"DIV",{class:!0});var Oe=L(n);t=T(Oe,"DIV",{"data-svelte-h":!0}),Q(t)!=="svelte-1992pd0"&&(t.textContent=a),u=j(Oe),o=T(Oe,"INPUT",{name:!0,type:!0,class:!0}),Oe.forEach(D),h=j(E),p=T(E,"DIV",{class:!0});var be=L(p);g=T(be,"DIV",{"data-svelte-h":!0}),Q(g)!=="svelte-r3jt44"&&(g.textContent=d),l=j(be),r=T(be,"INPUT",{name:!0,type:!0,class:!0}),N=j(be),V=T(be,"SMALL",{class:!0,"data-svelte-h":!0}),Q(V)!=="svelte-1kwt4h6"&&(V.textContent=A),be.forEach(D),y=j(E),S=T(E,"DIV",{class:!0});var ye=L(S);M=T(ye,"DIV",{"data-svelte-h":!0}),Q(M)!=="svelte-8167a8"&&(M.textContent=q),c=j(ye),f=T(ye,"INPUT",{name:!0,type:!0,class:!0,placeholder:!0}),O=j(ye),m=T(ye,"SMALL",{class:!0,"data-svelte-h":!0}),Q(m)!=="svelte-1g8l3ub"&&(m.textContent=W),ye.forEach(D),oe=j(E),H=T(E,"DIV",{class:!0});var we=L(H);G=T(we,"DIV",{"data-svelte-h":!0}),Q(G)!=="svelte-1irjajf"&&(G.textContent=de),ie=j(we),B=T(we,"INPUT",{name:!0,type:!0,class:!0,placeholder:!0}),Ce=j(we),ee=T(we,"SMALL",{class:!0,"data-svelte-h":!0}),Q(ee)!=="svelte-tmui2k"&&(ee.textContent=Ae),we.forEach(D),Ee=j(E),z=T(E,"DIV",{class:!0});var ue=L(z);te=T(ue,"SMALL",{class:!0});var xe=L(te);he=Z(xe,_e),xe.forEach(D),Se=j(ue),ne=T(ue,"SPAN",{});var $e=L(ne);Fe(v.$$.fragment,$e),$e.forEach(D),se=j(ue),F&&F.l(ue),ve=j(ue),x=T(ue,"BUTTON",{class:!0});var Pe=L(x);ae.l(Pe),Be=j(Pe),K&&K.l(Pe),Pe.forEach(D),ue.forEach(D),E.forEach(D),this.h()},h(){_(o,"name",I=s[1]+"-date"),_(o,"type","date"),_(o,"class","form-control"),o.disabled=s[7],o.required=!0,J(o,"is-invalid",s[13]),_(n,"class","d-flex flex-column gap-2"),_(r,"name",b=s[1]+"-amount"),_(r,"type","text"),_(r,"class","form-control text-end"),r.disabled=s[7],r.required=!0,J(r,"is-invalid",s[14]),_(V,"class","fw-lighter fst-italic"),_(p,"class","d-flex flex-column gap-2"),_(f,"name",C=s[1]+"-description"),_(f,"type","text"),_(f,"class","form-control"),_(f,"placeholder","Description"),f.disabled=s[7],f.required=!0,J(f,"is-invalid",s[6]),_(m,"class","fw-lighter fst-italic"),_(S,"class","d-flex flex-column gap-2"),_(B,"name",me=s[1]+"-source"),_(B,"type","text"),_(B,"class","form-control"),_(B,"placeholder","Source"),B.disabled=s[7],B.required=!0,J(B,"is-invalid",s[5]),_(ee,"class","fw-lighter fst-italic"),_(H,"class","d-flex flex-column gap-2"),_(te,"class",ge="fw-lighter fst-italic text-"+s[12].type),J(ne,"d-none",!s[7]),_(x,"class","btn btn-primary position-relative"),_(z,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),_(e,"class","d-flex flex-column gap-4")},m(k,E){Y(k,e,E),i(e,n),i(n,t),i(n,u),i(n,o),s[21](o),$(o,s[2]),i(e,h),i(e,p),i(p,g),i(p,l),i(p,r),s[25](r),$(r,s[0].amount),i(p,N),i(p,V),i(e,y),i(e,S),i(S,M),i(S,c),i(S,f),s[29](f),$(f,s[0].description),i(S,O),i(S,m),i(e,oe),i(e,H),i(H,G),i(H,ie),i(H,B),s[33](B),$(B,s[0].source),i(H,Ce),i(H,ee),i(e,Ee),i(e,z),i(z,te),i(te,he),i(z,Se),i(z,ne),He(v,ne,null),i(z,se),F&&F.m(z,null),i(z,ve),i(z,x),ae.m(x,null),i(x,Be),K&&K.m(x,null),R=!0,Ye||(Xe=[U(o,"focus",s[22]),U(o,"keyup",s[23]),U(o,"input",s[24]),U(r,"focus",s[26]),U(r,"keyup",s[27]),U(r,"input",s[28]),U(f,"focus",s[30]),U(f,"keyup",s[31]),U(f,"input",s[32]),U(B,"focus",s[34]),U(B,"keyup",s[35]),U(B,"input",s[36]),U(x,"click",s[17])],Ye=!0)},p(k,E){(!R||E[0]&2&&I!==(I=k[1]+"-date"))&&_(o,"name",I),(!R||E[0]&128)&&(o.disabled=k[7]),E[0]&4&&$(o,k[2]),(!R||E[0]&8192)&&J(o,"is-invalid",k[13]),(!R||E[0]&2&&b!==(b=k[1]+"-amount"))&&_(r,"name",b),(!R||E[0]&128)&&(r.disabled=k[7]),E[0]&1&&r.value!==k[0].amount&&$(r,k[0].amount),(!R||E[0]&16384)&&J(r,"is-invalid",k[14]),(!R||E[0]&2&&C!==(C=k[1]+"-description"))&&_(f,"name",C),(!R||E[0]&128)&&(f.disabled=k[7]),E[0]&1&&f.value!==k[0].description&&$(f,k[0].description),(!R||E[0]&64)&&J(f,"is-invalid",k[6]),(!R||E[0]&2&&me!==(me=k[1]+"-source"))&&_(B,"name",me),(!R||E[0]&128)&&(B.disabled=k[7]),E[0]&1&&B.value!==k[0].source&&$(B,k[0].source),(!R||E[0]&32)&&J(B,"is-invalid",k[5]),(!R||E[0]&4096)&&_e!==(_e=k[12].message+"")&&le(he,_e),(!R||E[0]&4096&&ge!==(ge="fw-lighter fst-italic text-"+k[12].type))&&_(te,"class",ge),(!R||E[0]&128)&&J(ne,"d-none",!k[7]),k[4]?F?F.p(k,E):(F=at(k),F.c(),F.m(z,ve)):F&&(F.d(1),F=null),Le!==(Le=Ze(k))&&(ae.d(1),ae=Le(k),ae&&(ae.c(),ae.m(x,Be))),k[15]?K||(K=lt(),K.c(),K.m(x,null)):K&&(K.d(1),K=null)},i(k){R||(re(v.$$.fragment,k),R=!0)},o(k){fe(v.$$.fragment,k),R=!1},d(k){k&&D(e),s[21](null),s[25](null),s[29](null),s[33](null),ze(v),F&&F.d(),ae.d(),K&&K.d(),Ye=!1,_t(Xe)}}}function at(s){let e,n="<span>Delete</span>",t,a;return{c(){e=w("button"),e.innerHTML=n,this.h()},l(u){e=T(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-4hjfsp"&&(e.innerHTML=n),this.h()},h(){_(e,"class","btn btn-danger position-relative")},m(u,o){Y(u,e,o),t||(a=U(e,"click",s[16]),t=!0)},p:Re,d(u){u&&D(e),t=!1,a()}}}function Ot(s){let e,n="Create";return{c(){e=w("span"),e.textContent=n},l(t){e=T(t,"SPAN",{"data-svelte-h":!0}),Q(e)!=="svelte-1wf0js6"&&(e.textContent=n)},m(t,a){Y(t,e,a)},d(t){t&&D(e)}}}function Pt(s){let e,n="Save";return{c(){e=w("span"),e.textContent=n},l(t){e=T(t,"SPAN",{"data-svelte-h":!0}),Q(e)!=="svelte-l126tb"&&(e.textContent=n)},m(t,a){Y(t,e,a)},d(t){t&&D(e)}}}function lt(s){let e,n='<span class="visually-hidden">Item not saved</span>';return{c(){e=w("span"),e.innerHTML=n,this.h()},l(t){e=T(t,"SPAN",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1sxrz4i"&&(e.innerHTML=n),this.h()},h(){_(e,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(t,a){Y(t,e,a)},d(t){t&&D(e)}}}function jt(s){let e,n,t=s[0]&&st(s);return{c(){t&&t.c(),e=De()},l(a){t&&t.l(a),e=De()},m(a,u){t&&t.m(a,u),Y(a,e,u),n=!0},p(a,u){a[0]?t?(t.p(a,u),u[0]&1&&re(t,1)):(t=st(a),t.c(),re(t,1),t.m(e.parentNode,e)):t&&(ht(),fe(t,1,1,()=>{t=null}),gt())},i(a){n||(re(t),n=!0)},o(a){fe(t),n=!1},d(a){a&&D(e),t&&t.d(a)}}}function qt(s,e,n){let t,a,u,o,I,h,p,{name:g=""}=e,{drawerId:d=""}=e,{transaction:l}=e;const{actions:{reload:r}}=vt();let b=!1,N,V=0,A,y,S,M,q={message:"",type:"info"},c,f={source:!1,description:!1,amount:!1,date:!1};const C=()=>{const v=`[data-bs-target="#${d}"]`,se=document.querySelector(v);se&&se.click()},O=()=>{n(3,f={source:!1,description:!1,date:!1,amount:!1}),n(0,l={...Nt}),n(7,b=!1)},m=(v,se=0,ve="info")=>{n(12,q.message=v,q),n(12,q.type=ve,q),se&&setTimeout(()=>{n(12,q.message="",q)},se)},W=async()=>{if(!t){m("ID is not defined",0,"danger");return}try{await Bt(t),await r(!0),setTimeout(()=>{n(7,b=!1),n(20,c={...l,id:t,date:pe(N,"yyyy-MM-dd",new Date).toISOString()}),m("Transaction Deleted",3e3,"success"),C()},800)}catch(v){setTimeout(()=>{n(7,b=!1),console.error("Save failed:",v),m("Failed to save event. Please try again.",7e3,"danger")},800)}},oe=()=>{n(7,b=!0),Tt({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:v=>{v&&W(),O()}})},H=async()=>{if(!a){m("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!p){let v=[];o&&v.push("Amount is invalid"),u&&v.push("Date is invalid"),h&&v.push("Description is invalid"),I&&v.push("Source is invalid"),m(v.join(". ")+".  Please address accordingly.",0,"danger");return}if(!b){m("Saving ..."),n(7,b=!0);try{const v={...l,date:pe(N,"yyyy-MM-dd",new Date).toISOString()};delete v.balance,t?await At(t,v):await Vt(v),await r(!0),setTimeout(()=>{n(7,b=!1),n(20,c={...l,id:t}),m("Saved",3e3,"success"),t||O(),C()},800)}catch(v){setTimeout(()=>{n(7,b=!1),console.error("Save failed:",v),m("Failed to save event. Please try again.",7e3,"danger"),t||O()},800)}}};function G(v){je[v?"unshift":"push"](()=>{S=v,n(10,S)})}const de=()=>S.select(),ie=()=>n(3,f.date=!0,f);function B(){N=this.value,n(2,N),n(4,t),n(0,l),n(19,V)}function me(v){je[v?"unshift":"push"](()=>{M=v,n(11,M)})}const Ce=()=>M.select(),ee=()=>n(3,f.amount=!0,f);function Ae(){l.amount=this.value,n(0,l)}function Ee(v){je[v?"unshift":"push"](()=>{A=v,n(8,A)})}const z=()=>A.select(),te=()=>n(3,f.description=!0,f);function _e(){l.description=this.value,n(0,l)}function he(v){je[v?"unshift":"push"](()=>{y=v,n(9,y)})}const ge=()=>y.select(),Se=()=>n(3,f.source=!0,f);function ne(){l.source=this.value,n(0,l)}return s.$$set=v=>{"name"in v&&n(1,g=v.name),"drawerId"in v&&n(18,d=v.drawerId),"transaction"in v&&n(0,l=v.transaction)},s.$$.update=()=>{s.$$.dirty[0]&1&&n(4,t=l?.id),s.$$.dirty[0]&524305&&t&&l&&V!==t&&(n(7,b=!0),setTimeout(()=>{n(20,c={...l}),n(19,V=t),n(2,N=Ve(l.date,"yyyy-MM-dd")),n(7,b=!1)},800)),s.$$.dirty[0]&1048581&&n(15,a=c?.date!==N||c?.amount!==l?.amount||c?.description!==l?.description||c?.source!==l?.source),s.$$.dirty[0]&9&&n(13,u=f.date&&l.date===""),s.$$.dirty[0]&9&&n(14,o=f.amount&&l.amount===0),s.$$.dirty[0]&9&&n(5,I=f.source&&l.source===""),s.$$.dirty[0]&9&&n(6,h=f.description&&l.description===""),s.$$.dirty[0]&96&&(p=!I&&!h)},[l,g,N,f,t,I,h,b,A,y,S,M,q,u,o,a,oe,H,d,V,c,G,de,ie,B,me,Ce,ee,Ae,Ee,z,te,_e,he,ge,Se,ne]}class Rt extends pt{constructor(e){super(),mt(this,e,qt,jt,dt,{name:1,drawerId:18,transaction:0},null,[-1,-1])}}function rt(s,e,n){const t=s.slice();return t[21]=e[n],t}function ot(s,e,n){const t=s.slice();return t[24]=e[n],t}function it(s,e,n){const t=s.slice();return t[27]=e[n],t}function Ut(s){let e,n;return e=new Rt({props:{name:"member-list-item-form-new",drawerId:ke,transaction:s[1]}}),{c(){Ue(e.$$.fragment)},l(t){Fe(e.$$.fragment,t)},m(t,a){He(e,t,a),n=!0},p(t,a){const u={};a&2&&(u.transaction=t[1]),e.$set(u)},i(t){n||(re(e.$$.fragment,t),n=!0)},o(t){fe(e.$$.fragment,t),n=!1},d(t){ze(e,t)}}}function ut(s){let e,n=s[27].start+"",t,a,u=s[27].end+"",o,I,h=Te(s[27].max_spending_limit)+"",p,g,d;return{c(){e=w("option"),t=X(n),a=X(" to "),o=X(u),I=X(" ("),p=X(h),g=X(`)
			`),this.h()},l(l){e=T(l,"OPTION",{});var r=L(e);t=Z(r,n),a=Z(r," to "),o=Z(r,u),I=Z(r," ("),p=Z(r,h),g=Z(r,`)
			`),r.forEach(D),this.h()},h(){e.__value=d=s[27].id,$(e,e.__value)},m(l,r){Y(l,e,r),i(e,t),i(e,a),i(e,o),i(e,I),i(e,p),i(e,g)},p(l,r){r&8&&n!==(n=l[27].start+"")&&le(t,n),r&8&&u!==(u=l[27].end+"")&&le(o,u),r&8&&h!==(h=Te(l[27].max_spending_limit)+"")&&le(p,h),r&8&&d!==(d=l[27].id)&&(e.__value=d,$(e,e.__value))},d(l){l&&D(e)}}}function Ft(s){let e,n=Ie(s[6]),t=[];for(let a=0;a<n.length;a+=1)t[a]=ft(rt(s,n,a));return{c(){for(let a=0;a<t.length;a+=1)t[a].c();e=De()},l(a){for(let u=0;u<t.length;u+=1)t[u].l(a);e=De()},m(a,u){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(a,u);Y(a,e,u)},p(a,u){if(u&2112){n=Ie(a[6]);let o;for(o=0;o<n.length;o+=1){const I=rt(a,n,o);t[o]?t[o].p(I,u):(t[o]=ft(I),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=n.length}},i:Re,o:Re,d(a){a&&D(e),Qe(t,a)}}}function Ht(s){let e,n;return e=new Ct({}),{c(){Ue(e.$$.fragment)},l(t){Fe(e.$$.fragment,t)},m(t,a){He(e,t,a),n=!0},p:Re,i(t){n||(re(e.$$.fragment,t),n=!0)},o(t){fe(e.$$.fragment,t),n=!1},d(t){ze(e,t)}}}function ct(s){let e,n,t,a=s[24].description+"",u,o,I,h=s[24].source+"",p,g,d,l,r,b=Te(s[24].amount)+"",N,V,A,y,S=Te(s[24]?.balance)+"",M,q,c,f;function C(){return s[16](s[24])}return{c(){e=w("div"),n=w("div"),t=w("div"),u=X(a),o=P(),I=w("div"),p=X(h),g=P(),d=w("div"),l=w("div"),r=w("button"),N=X(b),A=P(),y=w("div"),M=X(S),q=P(),this.h()},l(O){e=T(O,"DIV",{class:!0});var m=L(e);n=T(m,"DIV",{});var W=L(n);t=T(W,"DIV",{});var oe=L(t);u=Z(oe,a),oe.forEach(D),o=j(W),I=T(W,"DIV",{class:!0});var H=L(I);p=Z(H,h),H.forEach(D),W.forEach(D),g=j(m),d=T(m,"DIV",{class:!0});var G=L(d);l=T(G,"DIV",{class:!0});var de=L(l);r=T(de,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var ie=L(r);N=Z(ie,b),ie.forEach(D),de.forEach(D),A=j(G),y=T(G,"DIV",{class:!0});var B=L(y);M=Z(B,S),B.forEach(D),G.forEach(D),q=j(m),m.forEach(D),this.h()},h(){_(I,"class","fw-light text-muted"),_(r,"class","btn btn-sm btn-link ps-0"),_(r,"type","button"),_(r,"data-bs-toggle","offcanvas"),_(r,"data-bs-target","#"+ke),_(r,"aria-controls",ke),_(l,"class",V=et(s[24].type)+" svelte-xe6rrl"),_(y,"class","fw-lighter"),J(y,"text-warning",s[24]?.balance!==void 0&&s[24]?.balance<0),_(d,"class","d-flex justify-content-between align-items-center"),_(e,"class","border-top p-2")},m(O,m){Y(O,e,m),i(e,n),i(n,t),i(t,u),i(n,o),i(n,I),i(I,p),i(e,g),i(e,d),i(d,l),i(l,r),i(r,N),i(d,A),i(d,y),i(y,M),i(e,q),c||(f=U(r,"click",C),c=!0)},p(O,m){s=O,m&64&&a!==(a=s[24].description+"")&&le(u,a),m&64&&h!==(h=s[24].source+"")&&le(p,h),m&64&&b!==(b=Te(s[24].amount)+"")&&le(N,b),m&64&&V!==(V=et(s[24].type)+" svelte-xe6rrl")&&_(l,"class",V),m&64&&S!==(S=Te(s[24]?.balance)+"")&&le(M,S),m&64&&J(y,"text-warning",s[24]?.balance!==void 0&&s[24]?.balance<0)},d(O){O&&D(e),c=!1,f()}}}function ft(s){let e,n,t=nt(s[21]?.dateStr)+"",a,u,o,I,h=Ie(s[21].transactions),p=[];for(let g=0;g<h.length;g+=1)p[g]=ct(ot(s,h,g));return{c(){e=w("div"),n=w("div"),a=X(t),u=P(),o=w("div");for(let g=0;g<p.length;g+=1)p[g].c();I=P(),this.h()},l(g){e=T(g,"DIV",{});var d=L(e);n=T(d,"DIV",{class:!0});var l=L(n);a=Z(l,t),l.forEach(D),u=j(d),o=T(d,"DIV",{});var r=L(o);for(let b=0;b<p.length;b+=1)p[b].l(r);r.forEach(D),I=j(d),d.forEach(D),this.h()},h(){_(n,"class","fw-bolder text-uppercase p-2")},m(g,d){Y(g,e,d),i(e,n),i(n,a),i(e,u),i(e,o);for(let l=0;l<p.length;l+=1)p[l]&&p[l].m(o,null);i(e,I)},p(g,d){if(d&64&&t!==(t=nt(g[21]?.dateStr)+"")&&le(a,t),d&2112){h=Ie(g[21].transactions);let l;for(l=0;l<h.length;l+=1){const r=ot(g,h,l);p[l]?p[l].p(r,d):(p[l]=ct(r),p[l].c(),p[l].m(o,null))}for(;l<p.length;l+=1)p[l].d(1);p.length=h.length}},d(g){g&&D(e),Qe(p,g)}}}function zt(s){let e,n,t,a,u,o="Range",I,h,p,g,d,l,r,b,N,V;e=new kt({props:{title:s[4],id:ke,$$slots:{default:[Ut]},$$scope:{ctx:s}}});let A=Ie(s[3]),y=[];for(let c=0;c<A.length;c+=1)y[c]=ut(it(s,A,c));const S=[Ht,Ft],M=[];function q(c,f){return c[5]?0:c[6].length&&c[2]?1:-1}return~(d=q(s))&&(l=M[d]=S[d](s)),{c(){Ue(e.$$.fragment),n=P(),t=w("div"),a=w("select"),u=w("option"),u.textContent=o;for(let c=0;c<y.length;c+=1)y[c].c();I=P(),h=w("button"),p=w("i"),g=P(),l&&l.c(),r=De(),this.h()},l(c){Fe(e.$$.fragment,c),n=j(c),t=T(c,"DIV",{class:!0});var f=L(t);a=T(f,"SELECT",{class:!0,"aria-label":!0});var C=L(a);u=T(C,"OPTION",{"data-svelte-h":!0}),Q(u)!=="svelte-1k3fjyk"&&(u.textContent=o);for(let m=0;m<y.length;m+=1)y[m].l(C);C.forEach(D),I=j(f),h=T(f,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var O=L(h);p=T(O,"I",{class:!0}),L(p).forEach(D),O.forEach(D),f.forEach(D),g=j(c),l&&l.l(c),r=De(),this.h()},h(){u.selected=!0,u.__value="Range",$(u,u.__value),_(a,"class","form-select"),_(a,"aria-label","Default select example"),s[0]===void 0&&bt(()=>s[14].call(a)),_(p,"class","bi bi-plus"),_(h,"class","btn btn-sm btn-secondary"),_(h,"type","button"),_(h,"data-bs-toggle","offcanvas"),_(h,"data-bs-target","#"+ke),_(h,"aria-controls",ke),_(t,"class","transaction-page d-flex justify-content-between gap-3")},m(c,f){He(e,c,f),Y(c,n,f),Y(c,t,f),i(t,a),i(a,u);for(let C=0;C<y.length;C+=1)y[C]&&y[C].m(a,null);tt(a,s[0],!0),i(t,I),i(t,h),i(h,p),Y(c,g,f),~d&&M[d].m(c,f),Y(c,r,f),b=!0,N||(V=[U(a,"change",s[14]),U(h,"click",s[15])],N=!0)},p(c,[f]){const C={};if(f&16&&(C.title=c[4]),f&1073741826&&(C.$$scope={dirty:f,ctx:c}),e.$set(C),f&8){A=Ie(c[3]);let m;for(m=0;m<A.length;m+=1){const W=it(c,A,m);y[m]?y[m].p(W,f):(y[m]=ut(W),y[m].c(),y[m].m(a,null))}for(;m<y.length;m+=1)y[m].d(1);y.length=A.length}f&9&&tt(a,c[0]);let O=d;d=q(c),d===O?~d&&M[d].p(c,f):(l&&(ht(),fe(M[O],1,1,()=>{M[O]=null}),gt()),~d?(l=M[d],l?l.p(c,f):(l=M[d]=S[d](c),l.c()),re(l,1),l.m(r.parentNode,r)):l=null)},i(c){b||(re(e.$$.fragment,c),re(l),b=!0)},o(c){fe(e.$$.fragment,c),fe(l),b=!1},d(c){c&&(D(n),D(t),D(g),D(r)),ze(e,c),Qe(y,c),~d&&M[d].d(c),N=!1,_t(V)}}}const ke="transactions-form";function Kt(s,e,n){let t,a,u,o;const{stores:{loading:I,targetBudget:h,dayTransactions:p,startDate:g,endDate:d},actions:{reload:l}}=vt();Ge(s,I,C=>n(5,u=C)),Ge(s,h,C=>n(2,a=C)),Ge(s,p,C=>n(6,o=C));let r=[],b,N=[],V,A,y=!1;const S={type:"expense",amount:0,description:"test",source:"test",date:Ve(new Date,"yyyy-mm-dd")},M=C=>{n(1,A=C)};yt(async()=>{n(12,N=await Dt()),n(3,r=St(N)),V=Mt(N),n(0,b=V?.id)});function q(){b=wt(this),n(0,b),n(3,r)}const c=()=>M({...S}),f=C=>M(C);return s.$$.update=()=>{if(s.$$.dirty&12293&&b&&!y&&a?.id!==b&&(h.set(N.find(C=>C.id===b)),a&&a.start_at&&a.end_at)){n(13,y=!0);const C=a.start_at.split("T")[0],O=a.end_at.split("T")[0];g.set(C),d.set(O),l(),n(13,y=!1)}s.$$.dirty&2&&n(4,t=A?.id?"Edit Transaction":"Create Transaction")},[b,A,a,r,t,u,o,I,h,p,S,M,N,y,q,c,f]}class $t extends pt{constructor(e){super(),mt(this,e,Kt,zt,dt,{})}}export{$t as T};
