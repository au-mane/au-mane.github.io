import{k as je,s as dt,r as _t,n as qe,h as Pe,v as bt,b as Ge,o as yt,B as et}from"./scheduler.DyivmMiW.js";import{S as pt,i as mt,v as Ie,o as Y,t as re,x as ht,a as fe,w as gt,d as I,e as w,s as P,b as X,c as Ue,j as T,k as B,l as Q,f as j,m as Z,g as Fe,n as p,y as J,q as u,C as $,p as He,B as U,r as le,u as ze,E as tt,D as Qe,F as wt}from"./index.BqK79KpI.js";import{s as Ne,e as De}from"./supabase-config.DGP-irWd.js";import{f as Re,p as pe,c as Tt,D as kt,g as It}from"./confirm.service.D8NKo1ly.js";import{f as Te}from"./app.state.DIzCX3o3.js";import{S as Dt}from"./Spinner.BlcZoQhc.js";import{w as ce}from"./index.Cdixjbko.js";import{L as Ct}from"./Loading.Do7G-gm4.js";function Et(s){const e={};return s.forEach(n=>{const t=n.date.split("T")[0];e[t]||(e[t]=[]),e[t].push(n)}),Object.entries(e).map(([n,t])=>({dateStr:n,transactions:t}))}const nt=s=>s?Re(pe(s,"yyyy-MM-dd",new Date),"MMM dd"):"",St=s=>s.map(e=>({id:e?.id||0,start:e?.start_at?Re(pe(e.start_at.split("T")[0],"yyyy-MM-dd",new Date),"MMM dd"):"",end:e?.end_at?Re(pe(e.end_at.split("T")[0],"yyyy-MM-dd",new Date),"MMM dd"):"",max_spending_limit:e?.settings?.max_spend_limit??0}));function Mt(s){const e=new Date;return s.find(n=>{if(n.start_at&&n.end_at){const t=pe(n.start_at.split("T")[0],"yyyy-MM-dd",new Date),a=pe(n.end_at.split("T")[0],"yyyy-MM-dd",new Date);return e>=t&&e<=a}return!1})}const Nt={type:"expense",amount:0,description:"",source:"",date:""},We=ce([]);let Je=!1;async function Ke(s="",e=""){if(Je)return je(We);Je=!0;let n=[];if(s&&e){const t=`${e}T23:59:59`,{data:a,error:o}=await Ne.from("transactions").select("*").gte("date",s).lte("date",t).order("created_at",{ascending:!1});if(o)throw o;n=a||[],We.set(n)}else{const{data:t,error:a}=await Ne.from("transactions").select("*").order("date",{ascending:!1});if(a)throw a;n=t||[],We.set(n)}return Je=!1,n}async function Vt(s){const{data:e,error:n}=await Ne.from("transactions").insert([s]).select();if(n)throw n;return await Ke(),e?e[0]:void 0}async function At(s,e){const{data:n,error:t}=await Ne.from("transactions").update(e).eq("id",s).select();if(t)throw t;return await Ke(),n?n[0]:void 0}async function Bt(s){const{error:e}=await Ne.from("transactions").delete().eq("id",s);if(e)throw e;await Ke()}let Me=null;const Lt=()=>{const s=ce(!1),e=ce([]),n=ce([]),t=ce(void 0),a=ce([]),o=ce(""),i=ce("");let D,h;return Me={stores:{loading:s,data:e,dbData:n,dayTransactions:a,startDate:o,endDate:i,targetBudget:t},actions:{reload:async(g=!1)=>{s.set(!0);const d=je(o),l=je(i);if(g||D!==d&&h!==l){D=d,h=l;const r=await Ke(d,l);let b=je(t)?.settings?.max_spend_limit||0;const N=r.reverse().map(A=>{const{type:y,amount:S}=A;return b=y==="expense"?b-S:b,{...A,balance:b}}).reverse(),V=Et(N);a.set(V)}s.set(!1)}}},Me},vt=()=>Me?.stores&&Object.keys(Me.stores).length>0?Me:Lt();function st(s){let e,n,t,a="Date*",o,i,D,h,_,g,d="Amount*",l,r,b,N,V,A="How much money was spent",y,S,M,q="Description*",c,f,C,L,m,W="Expense description i.e. Groceries, Tuition, Tennis fee",oe,H,G,de="Source*",ie,O,me,Ce,ee,Ve="Expense source. i.e. Walmart, Costco, Cafe Trang etc.",Ee,z,te,_e=s[12].message+"",he,ge,Se,ne,v,se,ve,x,Ae,R,Ye,Xe;v=new Dt({props:{size:"xs"}});let F=s[4]&&at(s);function Ze(k,E){return k[4]?Pt:Ot}let Be=Ze(s),ae=Be(s),K=s[15]&&lt();return{c(){e=w("div"),n=w("div"),t=w("div"),t.textContent=a,o=P(),i=w("input"),h=P(),_=w("div"),g=w("div"),g.textContent=d,l=P(),r=w("input"),N=P(),V=w("small"),V.textContent=A,y=P(),S=w("div"),M=w("div"),M.textContent=q,c=P(),f=w("input"),L=P(),m=w("small"),m.textContent=W,oe=P(),H=w("div"),G=w("div"),G.textContent=de,ie=P(),O=w("input"),Ce=P(),ee=w("small"),ee.textContent=Ve,Ee=P(),z=w("div"),te=w("small"),he=X(_e),Se=P(),ne=w("span"),Ue(v.$$.fragment),se=P(),F&&F.c(),ve=P(),x=w("button"),ae.c(),Ae=P(),K&&K.c(),this.h()},l(k){e=T(k,"DIV",{class:!0});var E=B(e);n=T(E,"DIV",{class:!0});var Le=B(n);t=T(Le,"DIV",{"data-svelte-h":!0}),Q(t)!=="svelte-1992pd0"&&(t.textContent=a),o=j(Le),i=T(Le,"INPUT",{name:!0,type:!0,class:!0}),Le.forEach(I),h=j(E),_=T(E,"DIV",{class:!0});var be=B(_);g=T(be,"DIV",{"data-svelte-h":!0}),Q(g)!=="svelte-r3jt44"&&(g.textContent=d),l=j(be),r=T(be,"INPUT",{name:!0,type:!0,class:!0}),N=j(be),V=T(be,"SMALL",{class:!0,"data-svelte-h":!0}),Q(V)!=="svelte-1kwt4h6"&&(V.textContent=A),be.forEach(I),y=j(E),S=T(E,"DIV",{class:!0});var ye=B(S);M=T(ye,"DIV",{"data-svelte-h":!0}),Q(M)!=="svelte-8167a8"&&(M.textContent=q),c=j(ye),f=T(ye,"INPUT",{name:!0,type:!0,class:!0}),L=j(ye),m=T(ye,"SMALL",{class:!0,"data-svelte-h":!0}),Q(m)!=="svelte-1g8l3ub"&&(m.textContent=W),ye.forEach(I),oe=j(E),H=T(E,"DIV",{class:!0});var we=B(H);G=T(we,"DIV",{"data-svelte-h":!0}),Q(G)!=="svelte-1irjajf"&&(G.textContent=de),ie=j(we),O=T(we,"INPUT",{name:!0,type:!0,class:!0}),Ce=j(we),ee=T(we,"SMALL",{class:!0,"data-svelte-h":!0}),Q(ee)!=="svelte-tmui2k"&&(ee.textContent=Ve),we.forEach(I),Ee=j(E),z=T(E,"DIV",{class:!0});var ue=B(z);te=T(ue,"SMALL",{class:!0});var xe=B(te);he=Z(xe,_e),xe.forEach(I),Se=j(ue),ne=T(ue,"SPAN",{});var $e=B(ne);Fe(v.$$.fragment,$e),$e.forEach(I),se=j(ue),F&&F.l(ue),ve=j(ue),x=T(ue,"BUTTON",{class:!0});var Oe=B(x);ae.l(Oe),Ae=j(Oe),K&&K.l(Oe),Oe.forEach(I),ue.forEach(I),E.forEach(I),this.h()},h(){p(i,"name",D=s[1]+"-date"),p(i,"type","date"),p(i,"class","form-control"),i.disabled=s[7],i.required=!0,J(i,"is-invalid",s[13]),p(n,"class","d-flex flex-column gap-2"),p(r,"name",b=s[1]+"-amount"),p(r,"type","text"),p(r,"class","form-control text-end"),r.disabled=s[7],r.required=!0,J(r,"is-invalid",s[14]),p(V,"class","fw-lighter fst-italic"),p(_,"class","d-flex flex-column gap-2"),p(f,"name",C=s[1]+"-description"),p(f,"type","text"),p(f,"class","form-control"),f.disabled=s[7],f.required=!0,J(f,"is-invalid",s[6]),p(m,"class","fw-lighter fst-italic"),p(S,"class","d-flex flex-column gap-2"),p(O,"name",me=s[1]+"-source"),p(O,"type","text"),p(O,"class","form-control"),O.disabled=s[7],O.required=!0,J(O,"is-invalid",s[5]),p(ee,"class","fw-lighter fst-italic"),p(H,"class","d-flex flex-column gap-2"),p(te,"class",ge="fw-lighter fst-italic text-"+s[12].type),J(ne,"d-none",!s[7]),p(x,"class","btn btn-primary position-relative"),p(z,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),p(e,"class","d-flex flex-column gap-4")},m(k,E){Y(k,e,E),u(e,n),u(n,t),u(n,o),u(n,i),s[21](i),$(i,s[2]),u(e,h),u(e,_),u(_,g),u(_,l),u(_,r),s[25](r),$(r,s[0].amount),u(_,N),u(_,V),u(e,y),u(e,S),u(S,M),u(S,c),u(S,f),s[29](f),$(f,s[0].description),u(S,L),u(S,m),u(e,oe),u(e,H),u(H,G),u(H,ie),u(H,O),s[33](O),$(O,s[0].source),u(H,Ce),u(H,ee),u(e,Ee),u(e,z),u(z,te),u(te,he),u(z,Se),u(z,ne),He(v,ne,null),u(z,se),F&&F.m(z,null),u(z,ve),u(z,x),ae.m(x,null),u(x,Ae),K&&K.m(x,null),R=!0,Ye||(Xe=[U(i,"focus",s[22]),U(i,"keyup",s[23]),U(i,"input",s[24]),U(r,"focus",s[26]),U(r,"keyup",s[27]),U(r,"input",s[28]),U(f,"focus",s[30]),U(f,"keyup",s[31]),U(f,"input",s[32]),U(O,"focus",s[34]),U(O,"keyup",s[35]),U(O,"input",s[36]),U(x,"click",s[17])],Ye=!0)},p(k,E){(!R||E[0]&2&&D!==(D=k[1]+"-date"))&&p(i,"name",D),(!R||E[0]&128)&&(i.disabled=k[7]),E[0]&4&&$(i,k[2]),(!R||E[0]&8192)&&J(i,"is-invalid",k[13]),(!R||E[0]&2&&b!==(b=k[1]+"-amount"))&&p(r,"name",b),(!R||E[0]&128)&&(r.disabled=k[7]),E[0]&1&&r.value!==k[0].amount&&$(r,k[0].amount),(!R||E[0]&16384)&&J(r,"is-invalid",k[14]),(!R||E[0]&2&&C!==(C=k[1]+"-description"))&&p(f,"name",C),(!R||E[0]&128)&&(f.disabled=k[7]),E[0]&1&&f.value!==k[0].description&&$(f,k[0].description),(!R||E[0]&64)&&J(f,"is-invalid",k[6]),(!R||E[0]&2&&me!==(me=k[1]+"-source"))&&p(O,"name",me),(!R||E[0]&128)&&(O.disabled=k[7]),E[0]&1&&O.value!==k[0].source&&$(O,k[0].source),(!R||E[0]&32)&&J(O,"is-invalid",k[5]),(!R||E[0]&4096)&&_e!==(_e=k[12].message+"")&&le(he,_e),(!R||E[0]&4096&&ge!==(ge="fw-lighter fst-italic text-"+k[12].type))&&p(te,"class",ge),(!R||E[0]&128)&&J(ne,"d-none",!k[7]),k[4]?F?F.p(k,E):(F=at(k),F.c(),F.m(z,ve)):F&&(F.d(1),F=null),Be!==(Be=Ze(k))&&(ae.d(1),ae=Be(k),ae&&(ae.c(),ae.m(x,Ae))),k[15]?K||(K=lt(),K.c(),K.m(x,null)):K&&(K.d(1),K=null)},i(k){R||(re(v.$$.fragment,k),R=!0)},o(k){fe(v.$$.fragment,k),R=!1},d(k){k&&I(e),s[21](null),s[25](null),s[29](null),s[33](null),ze(v),F&&F.d(),ae.d(),K&&K.d(),Ye=!1,_t(Xe)}}}function at(s){let e,n="<span>Delete</span>",t,a;return{c(){e=w("button"),e.innerHTML=n,this.h()},l(o){e=T(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-4hjfsp"&&(e.innerHTML=n),this.h()},h(){p(e,"class","btn btn-danger position-relative")},m(o,i){Y(o,e,i),t||(a=U(e,"click",s[16]),t=!0)},p:qe,d(o){o&&I(e),t=!1,a()}}}function Ot(s){let e,n="Create";return{c(){e=w("span"),e.textContent=n},l(t){e=T(t,"SPAN",{"data-svelte-h":!0}),Q(e)!=="svelte-1wf0js6"&&(e.textContent=n)},m(t,a){Y(t,e,a)},d(t){t&&I(e)}}}function Pt(s){let e,n="Save";return{c(){e=w("span"),e.textContent=n},l(t){e=T(t,"SPAN",{"data-svelte-h":!0}),Q(e)!=="svelte-l126tb"&&(e.textContent=n)},m(t,a){Y(t,e,a)},d(t){t&&I(e)}}}function lt(s){let e,n='<span class="visually-hidden">Item not saved</span>';return{c(){e=w("span"),e.innerHTML=n,this.h()},l(t){e=T(t,"SPAN",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-1sxrz4i"&&(e.innerHTML=n),this.h()},h(){p(e,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(t,a){Y(t,e,a)},d(t){t&&I(e)}}}function jt(s){let e,n,t=s[0]&&st(s);return{c(){t&&t.c(),e=Ie()},l(a){t&&t.l(a),e=Ie()},m(a,o){t&&t.m(a,o),Y(a,e,o),n=!0},p(a,o){a[0]?t?(t.p(a,o),o[0]&1&&re(t,1)):(t=st(a),t.c(),re(t,1),t.m(e.parentNode,e)):t&&(ht(),fe(t,1,1,()=>{t=null}),gt())},i(a){n||(re(t),n=!0)},o(a){fe(t),n=!1},d(a){a&&I(e),t&&t.d(a)}}}function qt(s,e,n){let t,a,o,i,D,h,_,{name:g=""}=e,{drawerId:d=""}=e,{transaction:l}=e;const{actions:{reload:r}}=vt();let b=!1,N,V=0,A,y,S,M,q={message:"",type:"info"},c,f={source:!1,description:!1,amount:!1,date:!1};const C=()=>{const v=`[data-bs-target="#${d}"]`,se=document.querySelector(v);se&&se.click()},L=()=>{n(3,f={source:!1,description:!1,date:!1,amount:!1}),n(0,l={...Nt}),n(7,b=!1)},m=(v,se=0,ve="info")=>{n(12,q.message=v,q),n(12,q.type=ve,q),se&&setTimeout(()=>{n(12,q.message="",q)},se)},W=async()=>{if(!t){m("ID is not defined",0,"danger");return}try{await Bt(t),await r(!0),setTimeout(()=>{n(7,b=!1),n(20,c={...l,id:t,date:pe(N,"yyyy-MM-dd",new Date).toISOString()}),m("Transaction Deleted",3e3,"success"),C()},800)}catch(v){setTimeout(()=>{n(7,b=!1),console.error("Save failed:",v),m("Failed to save event. Please try again.",7e3,"danger")},800)}},oe=()=>{n(7,b=!0),Tt({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:v=>{v&&W(),L()}})},H=async()=>{if(!a){m("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!_){let v=[];i&&v.push("Amount is invalid"),o&&v.push("Date is invalid"),h&&v.push("Description is invalid"),D&&v.push("Source is invalid"),m(v.join(". ")+".  Please address accordingly.",0,"danger");return}if(!b){m("Saving ..."),n(7,b=!0);try{const v={...l,date:pe(N,"yyyy-MM-dd",new Date).toISOString()};delete v.balance,t?await At(t,v):await Vt(v),await r(!0),setTimeout(()=>{n(7,b=!1),n(20,c={...l,id:t}),m("Saved",3e3,"success"),t||L(),C()},800)}catch(v){setTimeout(()=>{n(7,b=!1),console.error("Save failed:",v),m("Failed to save event. Please try again.",7e3,"danger"),t||L()},800)}}};function G(v){Pe[v?"unshift":"push"](()=>{S=v,n(10,S)})}const de=()=>S.select(),ie=()=>n(3,f.date=!0,f);function O(){N=this.value,n(2,N),n(0,l),n(19,V),n(4,t)}function me(v){Pe[v?"unshift":"push"](()=>{M=v,n(11,M)})}const Ce=()=>M.select(),ee=()=>n(3,f.amount=!0,f);function Ve(){l.amount=this.value,n(0,l)}function Ee(v){Pe[v?"unshift":"push"](()=>{A=v,n(8,A)})}const z=()=>A.select(),te=()=>n(3,f.description=!0,f);function _e(){l.description=this.value,n(0,l)}function he(v){Pe[v?"unshift":"push"](()=>{y=v,n(9,y)})}const ge=()=>y.select(),Se=()=>n(3,f.source=!0,f);function ne(){l.source=this.value,n(0,l)}return s.$$set=v=>{"name"in v&&n(1,g=v.name),"drawerId"in v&&n(18,d=v.drawerId),"transaction"in v&&n(0,l=v.transaction)},s.$$.update=()=>{s.$$.dirty[0]&1&&n(4,t=l?.id),s.$$.dirty[0]&524305&&l&&V!==t&&(n(7,b=!0),setTimeout(()=>{n(20,c={...l}),n(19,V=l?.id),n(2,N=Re(l.date,"yyyy-MM-dd")),n(7,b=!1)},800)),s.$$.dirty[0]&1048581&&n(15,a=c?.date!==N||c?.amount!==l?.amount||c?.description!==l?.description||c?.source!==l?.source),s.$$.dirty[0]&9&&n(13,o=f.date&&l.date===""),s.$$.dirty[0]&9&&n(14,i=f.amount&&l.amount===0),s.$$.dirty[0]&9&&n(5,D=f.source&&l.source===""),s.$$.dirty[0]&9&&n(6,h=f.description&&l.description===""),s.$$.dirty[0]&96&&(_=!D&&!h)},[l,g,N,f,t,D,h,b,A,y,S,M,q,o,i,a,oe,H,d,V,c,G,de,ie,O,me,Ce,ee,Ve,Ee,z,te,_e,he,ge,Se,ne]}class Rt extends pt{constructor(e){super(),mt(this,e,qt,jt,dt,{name:1,drawerId:18,transaction:0},null,[-1,-1])}}function rt(s,e,n){const t=s.slice();return t[21]=e[n],t}function ot(s,e,n){const t=s.slice();return t[24]=e[n],t}function it(s,e,n){const t=s.slice();return t[27]=e[n],t}function Ut(s){let e,n;return e=new Rt({props:{name:"member-list-item-form-new",drawerId:ke,transaction:s[1]}}),{c(){Ue(e.$$.fragment)},l(t){Fe(e.$$.fragment,t)},m(t,a){He(e,t,a),n=!0},p(t,a){const o={};a&2&&(o.transaction=t[1]),e.$set(o)},i(t){n||(re(e.$$.fragment,t),n=!0)},o(t){fe(e.$$.fragment,t),n=!1},d(t){ze(e,t)}}}function ut(s){let e,n=s[27].start+"",t,a,o=s[27].end+"",i,D,h=Te(s[27].max_spending_limit)+"",_,g,d;return{c(){e=w("option"),t=X(n),a=X(" to "),i=X(o),D=X(" ("),_=X(h),g=X(`)
			`),this.h()},l(l){e=T(l,"OPTION",{});var r=B(e);t=Z(r,n),a=Z(r," to "),i=Z(r,o),D=Z(r," ("),_=Z(r,h),g=Z(r,`)
			`),r.forEach(I),this.h()},h(){e.__value=d=s[27].id,$(e,e.__value)},m(l,r){Y(l,e,r),u(e,t),u(e,a),u(e,i),u(e,D),u(e,_),u(e,g)},p(l,r){r&8&&n!==(n=l[27].start+"")&&le(t,n),r&8&&o!==(o=l[27].end+"")&&le(i,o),r&8&&h!==(h=Te(l[27].max_spending_limit)+"")&&le(_,h),r&8&&d!==(d=l[27].id)&&(e.__value=d,$(e,e.__value))},d(l){l&&I(e)}}}function Ft(s){let e,n=De(s[6]),t=[];for(let a=0;a<n.length;a+=1)t[a]=ft(rt(s,n,a));return{c(){for(let a=0;a<t.length;a+=1)t[a].c();e=Ie()},l(a){for(let o=0;o<t.length;o+=1)t[o].l(a);e=Ie()},m(a,o){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(a,o);Y(a,e,o)},p(a,o){if(o&2112){n=De(a[6]);let i;for(i=0;i<n.length;i+=1){const D=rt(a,n,i);t[i]?t[i].p(D,o):(t[i]=ft(D),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=n.length}},i:qe,o:qe,d(a){a&&I(e),Qe(t,a)}}}function Ht(s){let e,n;return e=new Ct({}),{c(){Ue(e.$$.fragment)},l(t){Fe(e.$$.fragment,t)},m(t,a){He(e,t,a),n=!0},p:qe,i(t){n||(re(e.$$.fragment,t),n=!0)},o(t){fe(e.$$.fragment,t),n=!1},d(t){ze(e,t)}}}function ct(s){let e,n,t,a=s[24].description+"",o,i,D,h=s[24].source+"",_,g,d,l,r,b=Te(s[24].amount)+"",N,V,A,y,S=Te(s[24]?.balance)+"",M,q,c,f;function C(){return s[16](s[24])}return{c(){e=w("div"),n=w("div"),t=w("div"),o=X(a),i=P(),D=w("div"),_=X(h),g=P(),d=w("div"),l=w("div"),r=w("button"),N=X(b),A=P(),y=w("div"),M=X(S),q=P(),this.h()},l(L){e=T(L,"DIV",{class:!0});var m=B(e);n=T(m,"DIV",{});var W=B(n);t=T(W,"DIV",{});var oe=B(t);o=Z(oe,a),oe.forEach(I),i=j(W),D=T(W,"DIV",{class:!0});var H=B(D);_=Z(H,h),H.forEach(I),W.forEach(I),g=j(m),d=T(m,"DIV",{class:!0});var G=B(d);l=T(G,"DIV",{class:!0});var de=B(l);r=T(de,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var ie=B(r);N=Z(ie,b),ie.forEach(I),de.forEach(I),A=j(G),y=T(G,"DIV",{class:!0});var O=B(y);M=Z(O,S),O.forEach(I),G.forEach(I),q=j(m),m.forEach(I),this.h()},h(){p(D,"class","fw-light text-muted"),p(r,"class","btn btn-sm btn-link ps-0"),p(r,"type","button"),p(r,"data-bs-toggle","offcanvas"),p(r,"data-bs-target","#"+ke),p(r,"aria-controls",ke),p(l,"class",V=et(s[24].type)+" svelte-xe6rrl"),p(y,"class","fw-lighter"),J(y,"text-warning",s[24]?.balance!==void 0&&s[24]?.balance<0),p(d,"class","d-flex justify-content-between align-items-center"),p(e,"class","border-top p-2")},m(L,m){Y(L,e,m),u(e,n),u(n,t),u(t,o),u(n,i),u(n,D),u(D,_),u(e,g),u(e,d),u(d,l),u(l,r),u(r,N),u(d,A),u(d,y),u(y,M),u(e,q),c||(f=U(r,"click",C),c=!0)},p(L,m){s=L,m&64&&a!==(a=s[24].description+"")&&le(o,a),m&64&&h!==(h=s[24].source+"")&&le(_,h),m&64&&b!==(b=Te(s[24].amount)+"")&&le(N,b),m&64&&V!==(V=et(s[24].type)+" svelte-xe6rrl")&&p(l,"class",V),m&64&&S!==(S=Te(s[24]?.balance)+"")&&le(M,S),m&64&&J(y,"text-warning",s[24]?.balance!==void 0&&s[24]?.balance<0)},d(L){L&&I(e),c=!1,f()}}}function ft(s){let e,n,t=nt(s[21]?.dateStr)+"",a,o,i,D,h=De(s[21].transactions),_=[];for(let g=0;g<h.length;g+=1)_[g]=ct(ot(s,h,g));return{c(){e=w("div"),n=w("div"),a=X(t),o=P(),i=w("div");for(let g=0;g<_.length;g+=1)_[g].c();D=P(),this.h()},l(g){e=T(g,"DIV",{});var d=B(e);n=T(d,"DIV",{class:!0});var l=B(n);a=Z(l,t),l.forEach(I),o=j(d),i=T(d,"DIV",{});var r=B(i);for(let b=0;b<_.length;b+=1)_[b].l(r);r.forEach(I),D=j(d),d.forEach(I),this.h()},h(){p(n,"class","fw-bolder text-uppercase p-2")},m(g,d){Y(g,e,d),u(e,n),u(n,a),u(e,o),u(e,i);for(let l=0;l<_.length;l+=1)_[l]&&_[l].m(i,null);u(e,D)},p(g,d){if(d&64&&t!==(t=nt(g[21]?.dateStr)+"")&&le(a,t),d&2112){h=De(g[21].transactions);let l;for(l=0;l<h.length;l+=1){const r=ot(g,h,l);_[l]?_[l].p(r,d):(_[l]=ct(r),_[l].c(),_[l].m(i,null))}for(;l<_.length;l+=1)_[l].d(1);_.length=h.length}},d(g){g&&I(e),Qe(_,g)}}}function zt(s){let e,n,t,a,o,i="Range",D,h,_,g,d,l,r,b,N,V;e=new kt({props:{title:s[4],id:ke,$$slots:{default:[Ut]},$$scope:{ctx:s}}});let A=De(s[3]),y=[];for(let c=0;c<A.length;c+=1)y[c]=ut(it(s,A,c));const S=[Ht,Ft],M=[];function q(c,f){return c[5]?0:c[6].length&&c[2]?1:-1}return~(d=q(s))&&(l=M[d]=S[d](s)),{c(){Ue(e.$$.fragment),n=P(),t=w("div"),a=w("select"),o=w("option"),o.textContent=i;for(let c=0;c<y.length;c+=1)y[c].c();D=P(),h=w("button"),_=w("i"),g=P(),l&&l.c(),r=Ie(),this.h()},l(c){Fe(e.$$.fragment,c),n=j(c),t=T(c,"DIV",{class:!0});var f=B(t);a=T(f,"SELECT",{class:!0,"aria-label":!0});var C=B(a);o=T(C,"OPTION",{"data-svelte-h":!0}),Q(o)!=="svelte-1k3fjyk"&&(o.textContent=i);for(let m=0;m<y.length;m+=1)y[m].l(C);C.forEach(I),D=j(f),h=T(f,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var L=B(h);_=T(L,"I",{class:!0}),B(_).forEach(I),L.forEach(I),f.forEach(I),g=j(c),l&&l.l(c),r=Ie(),this.h()},h(){o.selected=!0,o.__value="Range",$(o,o.__value),p(a,"class","form-select"),p(a,"aria-label","Default select example"),s[0]===void 0&&bt(()=>s[14].call(a)),p(_,"class","bi bi-plus"),p(h,"class","btn btn-sm btn-secondary"),p(h,"type","button"),p(h,"data-bs-toggle","offcanvas"),p(h,"data-bs-target","#"+ke),p(h,"aria-controls",ke),p(t,"class","transaction-page d-flex justify-content-between gap-3")},m(c,f){He(e,c,f),Y(c,n,f),Y(c,t,f),u(t,a),u(a,o);for(let C=0;C<y.length;C+=1)y[C]&&y[C].m(a,null);tt(a,s[0],!0),u(t,D),u(t,h),u(h,_),Y(c,g,f),~d&&M[d].m(c,f),Y(c,r,f),b=!0,N||(V=[U(a,"change",s[14]),U(h,"click",s[15])],N=!0)},p(c,[f]){const C={};if(f&16&&(C.title=c[4]),f&1073741826&&(C.$$scope={dirty:f,ctx:c}),e.$set(C),f&8){A=De(c[3]);let m;for(m=0;m<A.length;m+=1){const W=it(c,A,m);y[m]?y[m].p(W,f):(y[m]=ut(W),y[m].c(),y[m].m(a,null))}for(;m<y.length;m+=1)y[m].d(1);y.length=A.length}f&9&&tt(a,c[0]);let L=d;d=q(c),d===L?~d&&M[d].p(c,f):(l&&(ht(),fe(M[L],1,1,()=>{M[L]=null}),gt()),~d?(l=M[d],l?l.p(c,f):(l=M[d]=S[d](c),l.c()),re(l,1),l.m(r.parentNode,r)):l=null)},i(c){b||(re(e.$$.fragment,c),re(l),b=!0)},o(c){fe(e.$$.fragment,c),fe(l),b=!1},d(c){c&&(I(n),I(t),I(g),I(r)),ze(e,c),Qe(y,c),~d&&M[d].d(c),N=!1,_t(V)}}}const ke="transactions-form";function Kt(s,e,n){let t,a,o,i;const{stores:{loading:D,targetBudget:h,dayTransactions:_,startDate:g,endDate:d},actions:{reload:l}}=vt();Ge(s,D,C=>n(5,o=C)),Ge(s,h,C=>n(2,a=C)),Ge(s,_,C=>n(6,i=C));let r=[],b,N=[],V,A,y=!1;const S={type:"expense",amount:0,description:"",source:"",date:new Date().toISOString()},M=C=>{n(1,A=C)};yt(async()=>{n(12,N=await It()),n(3,r=St(N)),V=Mt(N),n(0,b=V?.id)});function q(){b=wt(this),n(0,b),n(3,r)}const c=()=>M({...S}),f=C=>M(C);return s.$$.update=()=>{if(s.$$.dirty&12293&&b&&!y&&a?.id!==b&&(h.set(N.find(C=>C.id===b)),a&&a.start_at&&a.end_at)){n(13,y=!0);const C=a.start_at.split("T")[0],L=a.end_at.split("T")[0];g.set(C),d.set(L),l(),n(13,y=!1)}s.$$.dirty&2&&n(4,t=A?.id?"Edit Transaction":"Create Transaction")},[b,A,a,r,t,o,i,D,h,_,S,M,N,y,q,c,f]}class $t extends pt{constructor(e){super(),mt(this,e,Kt,zt,dt,{})}}export{$t as T};
