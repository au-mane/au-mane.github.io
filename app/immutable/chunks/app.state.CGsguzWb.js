import{d as N,w as b}from"./index.XVz5aN3V.js";import{b as O}from"./scheduler.CgjAsyDf.js";var t=(e=>(e.UnAuthenticated="un-authenticated",e.Authenticated="authenticated",e.Admin="admin",e.Root="root",e))(t||{});const l={username:"User",role:t.UnAuthenticated},m={username:"Auth",role:t.Authenticated},S={username:"Admin",role:t.Admin},A={username:"Root",role:t.Root},w=[{label:"Home",url:"/home",roles:[t.UnAuthenticated,t.Authenticated,t.Admin,t.Root],index:1},{label:"Transactions",url:"/transactions",roles:[t.Authenticated,t.Admin,t.Root],index:2},{label:"Categories",url:"/categories",roles:[t.Authenticated,t.Admin,t.Root],index:3},{label:"Tags",url:"/tags",roles:[t.Authenticated,t.Admin,t.Root],index:4},{label:"Budgets",url:"/budgets",roles:[t.Authenticated,t.Admin,t.Root],index:5}];function R(e){const s=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&s==="[object Date]"?new e.constructor(+e):typeof e=="number"||s==="[object Number]"||typeof e=="string"||s==="[object String]"?new Date(e):new Date(NaN)}function k(e){return R(e).getDay()===0}const D=()=>{const{stores:{authenticated:e,currentUser:s},actions:{init:o}}=x();o();const a=O(e),d=O(s);let c=[];const g={label:"Login",url:"/auth/login",roles:[t.UnAuthenticated],index:100},y={label:"Logout",url:"/auth/logout",roles:[t.Authenticated,t.Admin,t.Root],index:100},U=a?[y]:[g];c=[...c,...w,...U];const I=(r,n)=>r&&r.find(i=>i.role===n)?.sundayOnly?k(new Date):!0;return c.filter(r=>{const n=d.role,f=!!r.roles.find(T=>T===n),i=I(r.visibilities,n);return f&&i}).sort((r,n)=>r.index-n.index)};async function h(e){function s(c){return Array.from(new Uint8Array(c)).map(g=>g.toString(16).padStart(2,"0")).join("")}const a=new TextEncoder().encode(e),d=await crypto.subtle.digest("SHA-256",a);return s(d)}const j=(e,s="USD",o="en-US")=>new Intl.NumberFormat(o,{style:"currency",currency:s}).format(e);let u=null;const p=()=>{const e=b(!1),s=b("Home"),o=b(!1),a=b(l),d=N([a],([r])=>r.role===t.Admin),c=N([a],([r])=>r.role===t.Root);return u={stores:{darkTheme:e,pageName:s,authenticated:o,currentUser:a,currentUserIsAdmin:d,currentUserIsRoot:c},actions:{init:()=>{const r=localStorage.getItem("theme"),n=r??"light";e.set(r==="dark"),document.documentElement.setAttribute("data-bs-theme",n),localStorage.setItem("theme",n);const f=localStorage.getItem("currentUser"),i=f?JSON.parse(f):l;switch(a.set(i),localStorage.setItem("currentUser",JSON.stringify(i)),i.username){case m.username:o.set(!0);break;case S.username:o.set(!0);break;case A.username:o.set(!0);break;case l.username:default:o.set(!1)}},toggleTheme:()=>{const r=localStorage.getItem("theme");let n="light";r==="light"&&(n="dark"),e.set(n==="dark"),document.documentElement.setAttribute("data-bs-theme",n),localStorage.setItem("theme",n)},login:async(r,n)=>!r||!n?!1:r.toLowerCase()==="taatu"&&await h(n)==="3821b3532602dbb515dba36e8ef7a6d28b0e1c0609f70bf2e7101083efe2a76c"||r.toLowerCase()==="josh"&&await h(n)==="3821b3532602dbb515dba36e8ef7a6d28b0e1c0609f70bf2e7101083efe2a76c"?(a.set(m),o.set(!0),localStorage.setItem("currentUser",JSON.stringify(m)),!0):r.toLowerCase()==="admin"&&await h(n)==="87b93ee4a38ae3ad0662f4c607bd7fa4c0396e580377743391cb4dfcaec89a33"?(a.set(S),o.set(!0),localStorage.setItem("currentUser",JSON.stringify(S)),!0):r.toLowerCase()==="root"&&await h(n)==="87b93ee4a38ae3ad0662f4c607bd7fa4c0396e580377743391cb4dfcaec89a33"?(a.set(A),o.set(!0),localStorage.setItem("currentUser",JSON.stringify(A)),!0):(localStorage.setItem("currentUser",JSON.stringify(l)),a.set(l),o.set(!1),!1),logout:()=>{o.set(!1),localStorage.setItem("currentUser",JSON.stringify(l)),a.set(l)}}},u},x=()=>u?.stores&&Object.keys(u.stores).length>0&&u?.actions&&Object.keys(u.actions).length>0?u:p();export{D as a,j as f,x as g,R as t};
