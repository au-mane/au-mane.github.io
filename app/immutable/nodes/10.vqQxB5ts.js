import{s as A,F as Z,a6 as me,E as be,A as V,o as F,f as p,e as k,d as B,j as C,k as T,i as P,n as b,p as h,t as G,m as X,w as U,M as ve,l as Q,D as se,q as we,y as ye,r as W,v as ke,a7 as Ce}from"../chunks/scheduler.CBku5hu2.js";import{S as R,i as O,f as _e,c as E,b as D,m as L,t as w,a as I,d as S,g as x,e as ee}from"../chunks/index.EWtk3-rK.js";import{P as Ie}from"../chunks/PageLayout.Dcj36uxz.js";import{B as z,c as pe,D as Te,F as Ee}from"../chunks/FormSkeleton.DWivrZgw.js";import{T as De}from"../chunks/TextField.D8bvZ5xU.js";import{g as M,d as Le}from"../chunks/categories.state._WgII0dM.js";import{e as ie}from"../chunks/Header.CXyzlo_a.js";const Se=!0,st=Object.freeze(Object.defineProperty({__proto__:null,prerender:Se},Symbol.toStringTag,{value:"Module"}));function Fe(o){let e,a,t;function n(r){o[7](r)}let l={label:"Name",name:"category-name",placeholder:"",helperText:o[3],loading:o[1],required:!0,isInvalid:o[2]};return o[0]!==void 0&&(l.value=o[0]),e=new De({props:l}),Z.push(()=>_e(e,"value",n)),e.$on("valueChanged",o[4]),{c(){E(e.$$.fragment)},l(r){D(e.$$.fragment,r)},m(r,i){L(e,r,i),t=!0},p(r,[i]){const c={};i&8&&(c.helperText=r[3]),i&2&&(c.loading=r[1]),i&4&&(c.isInvalid=r[2]),!a&&i&1&&(a=!0,c.value=r[0],me(()=>a=!1)),e.$set(c)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){I(e.$$.fragment,r),t=!1},d(r){S(e,r)}}}const Ne="Pick a name for the category. i.e. Grocery, Subscriptions",Be="This field is required";function Pe(o,e,a){let t,n,{value:l}=e,{loading:r}=e;async function i(){return new Promise(_=>{setTimeout(()=>{a(6,s=!0),_(s&&!l.trim())})})}const c=be(),f=()=>{c("valueChanged",{value:l}),a(6,s=!0)};let s=!1;function m(_){l=_,a(0,l)}return o.$$set=_=>{"value"in _&&a(0,l=_.value),"loading"in _&&a(1,r=_.loading)},o.$$.update=()=>{o.$$.dirty&65&&a(2,t=s&&l.trim()===""),o.$$.dirty&4&&a(3,n=t?Be:Ne)},[l,r,t,n,f,i,s,m]}class Ve extends R{constructor(e){super(),O(this,e,Pe,Fe,A,{value:0,loading:1,validateFieldIsInvalid:5})}get validateFieldIsInvalid(){return this.$$.ctx[5]}}function ce(o){let e,a,t,n,l,r,i,c,f,s,m,_={loading:o[0],value:o[1].name};a=new Ve({props:_}),o[10](a),a.$on("valueChanged",o[11]);let u=o[1].id&&fe(o);return c=new z({props:{loading:o[0],variant:"secondary",$$slots:{default:[He]},$$scope:{ctx:o}}}),c.$on("click",o[4]),s=new z({props:{loading:o[0],variant:"primary",$$slots:{default:[Me]},$$scope:{ctx:o}}}),s.$on("click",o[5]),{c(){e=k("div"),E(a.$$.fragment),t=B(),n=k("div"),l=k("div"),u&&u.c(),r=B(),i=k("div"),E(c.$$.fragment),f=B(),E(s.$$.fragment),this.h()},l(g){e=C(g,"DIV",{class:!0});var d=T(e);D(a.$$.fragment,d),t=P(d),n=C(d,"DIV",{class:!0});var $=T(n);l=C($,"DIV",{});var y=T(l);u&&u.l(y),y.forEach(p),r=P($),i=C($,"DIV",{});var v=T(i);D(c.$$.fragment,v),f=P(v),D(s.$$.fragment,v),v.forEach(p),$.forEach(p),d.forEach(p),this.h()},h(){b(n,"class","d-flex justify-content-between"),b(e,"class","d-flex flex-column gap-3")},m(g,d){F(g,e,d),L(a,e,null),h(e,t),h(e,n),h(n,l),u&&u.m(l,null),h(n,r),h(n,i),L(c,i,null),h(i,f),L(s,i,null),m=!0},p(g,d){const $={};d&1&&($.loading=g[0]),d&2&&($.value=g[1].name),a.$set($),g[1].id?u?(u.p(g,d),d&2&&w(u,1)):(u=fe(g),u.c(),w(u,1),u.m(l,null)):u&&(x(),I(u,1,1,()=>{u=null}),ee());const y={};d&1&&(y.loading=g[0]),d&4096&&(y.$$scope={dirty:d,ctx:g}),c.$set(y);const v={};d&1&&(v.loading=g[0]),d&4096&&(v.$$scope={dirty:d,ctx:g}),s.$set(v)},i(g){m||(w(a.$$.fragment,g),w(u),w(c.$$.fragment,g),w(s.$$.fragment,g),m=!0)},o(g){I(a.$$.fragment,g),I(u),I(c.$$.fragment,g),I(s.$$.fragment,g),m=!1},d(g){g&&p(e),o[10](null),S(a),u&&u.d(),S(c),S(s)}}}function fe(o){let e,a;return e=new z({props:{loading:o[0],variant:"danger",$$slots:{default:[je]},$$scope:{ctx:o}}}),e.$on("click",o[6]),{c(){E(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){L(e,t,n),a=!0},p(t,n){const l={};n&1&&(l.loading=t[0]),n&4096&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){a||(w(e.$$.fragment,t),a=!0)},o(t){I(e.$$.fragment,t),a=!1},d(t){S(e,t)}}}function je(o){let e;return{c(){e=G("Delete")},l(a){e=X(a,"Delete")},m(a,t){F(a,e,t)},d(a){a&&p(e)}}}function He(o){let e;return{c(){e=G("Cancel")},l(a){e=X(a,"Cancel")},m(a,t){F(a,e,t)},d(a){a&&p(e)}}}function Me(o){let e;return{c(){e=G("Save")},l(a){e=X(a,"Save")},m(a,t){F(a,e,t)},d(a){a&&p(e)}}}function Ae(o){let e,a,t=o[1]&&ce(o);return{c(){t&&t.c(),e=V()},l(n){t&&t.l(n),e=V()},m(n,l){t&&t.m(n,l),F(n,e,l),a=!0},p(n,[l]){n[1]?t?(t.p(n,l),l&2&&w(t,1)):(t=ce(n),t.c(),w(t,1),t.m(e.parentNode,e)):t&&(x(),I(t,1,1,()=>{t=null}),ee())},i(n){a||(w(t),a=!0)},o(n){I(t),a=!1},d(n){n&&p(e),t&&t.d(n)}}}function Re(o,e,a){let{loading:t=!1}=e,{category:n}=e,{drawerId:l}=e,r=0,i={name:""},c;const f=(d,$)=>{const{value:y}=d.detail;if(i)switch($){case"name":a(1,i.name=y,i);break}},s=()=>{const d=`[data-bs-target="#${l}"]`,$=document.querySelector(d);$&&($.click(),a(7,n=void 0),a(9,r=void 0),a(1,i={name:""}))},m=async()=>{if(await c.validateFieldIsInvalid())return;const{actions:{reload:$,createCategory:y,updateCategory:v}}=M();i.id?await v(i.id,i):await y(i),await $(),s()},_=async()=>{if(!i?.id)return;const{actions:{reload:d,deleteCategory:$}}=M();pe({title:"Delete Confirmation",message:"Are you sure you want to do this? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async y=>{i?.id&&(y&&await $(i.id),await d(),s())}})};function u(d){Z[d?"unshift":"push"](()=>{c=d,a(2,c)})}const g=d=>f(d,"name");return o.$$set=d=>{"loading"in d&&a(0,t=d.loading),"category"in d&&a(7,n=d.category),"drawerId"in d&&a(8,l=d.drawerId)},o.$$.update=()=>{o.$$.dirty&642&&(!n||r!==n?.id)&&(a(1,i=n?{...i,...n}:i),a(9,r=n?.id))},[t,i,c,f,s,m,_,n,l,r,u,g]}class Oe extends R{constructor(e){super(),O(this,e,Re,Ae,A,{loading:0,category:7,drawerId:8})}}function ue(o,e,a){const t=o.slice();return t[6]=e[a],t}function de(o){let e,a=ie(o[0]),t=[];for(let n=0;n<a.length;n+=1)t[n]=ge(ue(o,a,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=V()},l(n){for(let l=0;l<t.length;l+=1)t[l].l(n);e=V()},m(n,l){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(n,l);F(n,e,l)},p(n,l){if(l&15){a=ie(n[0]);let r;for(r=0;r<a.length;r+=1){const i=ue(n,a,r);t[r]?t[r].p(i,l):(t[r]=ge(i),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=a.length}},d(n){n&&p(e),ve(t,n)}}}function ge(o){let e,a,t=o[6].name+"",n,l,r,i,c='<i class="bi bi-three-dots-vertical"></i>',f,s,m,_,u,g='<span>Edit</span> <i class="bi bi-pencil-fill"></i>',d,$,y,v,te='<span class="d-flex justify-content-between"><span>Delete</span> <i class="bi bi-trash-fill"></i></span>',K,J,ae;function he(){return o[4](o[6])}function $e(){return o[5](o[6])}return{c(){e=k("div"),a=k("div"),n=G(t),l=B(),r=k("div"),i=k("span"),i.innerHTML=c,f=B(),s=k("ul"),m=k("li"),_=k("button"),u=k("span"),u.innerHTML=g,$=B(),y=k("li"),v=k("button"),v.innerHTML=te,K=B(),this.h()},l(j){e=C(j,"DIV",{class:!0});var N=T(e);a=C(N,"DIV",{class:!0});var ne=T(a);n=X(ne,t),ne.forEach(p),l=P(N),r=C(N,"DIV",{class:!0});var Y=T(r);i=C(Y,"SPAN",{"data-bs-toggle":!0,"aria-expanded":!0,"data-svelte-h":!0}),Q(i)!=="svelte-r1z1n6"&&(i.innerHTML=c),f=P(Y),s=C(Y,"UL",{class:!0});var q=T(s);m=C(q,"LI",{});var re=T(m);_=C(re,"BUTTON",{type:!0,class:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var oe=T(_);u=C(oe,"SPAN",{class:!0,"data-svelte-h":!0}),Q(u)!=="svelte-16nxiu"&&(u.innerHTML=g),oe.forEach(p),re.forEach(p),$=P(q),y=C(q,"LI",{});var le=T(y);v=C(le,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Q(v)!=="svelte-bnsm9c"&&(v.innerHTML=te),le.forEach(p),q.forEach(p),Y.forEach(p),K=P(N),N.forEach(p),this.h()},h(){b(a,"class","fw-bold"),b(i,"data-bs-toggle","dropdown"),b(i,"aria-expanded","false"),b(u,"class","d-flex justify-content-between"),b(_,"type","button"),b(_,"class","dropdown-item"),b(_,"data-bs-toggle","offcanvas"),b(_,"data-bs-target",d="#"+o[1]),b(_,"aria-controls",o[1]),b(v,"type","button"),b(v,"class","dropdown-item"),b(s,"class","dropdown-menu dropdown-menu-dark"),b(r,"class","dropdown"),b(e,"class","d-flex justify-content-between")},m(j,N){F(j,e,N),h(e,a),h(a,n),h(e,l),h(e,r),h(r,i),h(r,f),h(r,s),h(s,m),h(m,_),h(_,u),h(s,$),h(s,y),h(y,v),h(e,K),J||(ae=[se(_,"click",he),se(v,"click",$e)],J=!0)},p(j,N){o=j,N&1&&t!==(t=o[6].name+"")&&we(n,t),N&2&&d!==(d="#"+o[1])&&b(_,"data-bs-target",d),N&2&&b(_,"aria-controls",o[1])},d(j){j&&p(e),J=!1,ye(ae)}}}function Ye(o){let e,a=o[0].length&&de(o);return{c(){a&&a.c(),e=V()},l(t){a&&a.l(t),e=V()},m(t,n){a&&a.m(t,n),F(t,e,n)},p(t,[n]){t[0].length?a?a.p(t,n):(a=de(t),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null)},i:U,o:U,d(t){t&&p(e),a&&a.d(t)}}}function qe(o,e,a){let{data:t=[]}=e,{drawerId:n=""}=e;const l=async f=>{if(!f)return;const{actions:{canDeleteCategory:s,deleteCategory:m,reload:_}}=M(),u=await s(f);pe({title:"Delete Confirmation",message:u?"Are you sure you want to do this? You won't be able to undo this.":"There are uses of this category in transactions. You cannot delete it",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",confirmButtonHide:!u,rejectButtonLabel:u?"No":"Close",callback:async d=>{f&&d&&u&&(await m(f),await _())}})},r=f=>{const{stores:{targetCategory:s,loading:m}}=M();m.set(!0),setTimeout(()=>{s.set(f),m.set(!1)},800)},i=f=>r(f),c=f=>l(f.id);return o.$$set=f=>{"data"in f&&a(0,t=f.data),"drawerId"in f&&a(1,n=f.drawerId)},[t,n,l,r,i,c]}class Ue extends R{constructor(e){super(),O(this,e,qe,Ye,A,{data:0,drawerId:1})}}function ze(o){let e,a;return e=new Ee({}),{c(){E(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){L(e,t,n),a=!0},p:U,i(t){a||(w(e.$$.fragment,t),a=!0)},o(t){I(e.$$.fragment,t),a=!1},d(t){S(e,t)}}}function Ge(o){let e,a,t;function n(r){o[8](r)}let l={category:o[0],drawerId:H};return o[2]!==void 0&&(l.loading=o[2]),e=new Oe({props:l}),Z.push(()=>_e(e,"loading",n)),{c(){E(e.$$.fragment)},l(r){D(e.$$.fragment,r)},m(r,i){L(e,r,i),t=!0},p(r,i){const c={};i&1&&(c.category=r[0]),!a&&i&4&&(a=!0,c.loading=r[2],me(()=>a=!1)),e.$set(c)},i(r){t||(w(e.$$.fragment,r),t=!0)},o(r){I(e.$$.fragment,r),t=!1},d(r){S(e,r)}}}function Xe(o){let e,a,t,n;const l=[Ge,ze],r=[];function i(c,f){return c[2]?1:0}return e=i(o),a=r[e]=l[e](o),{c(){a.c(),t=V()},l(c){a.l(c),t=V()},m(c,f){r[e].m(c,f),F(c,t,f),n=!0},p(c,f){let s=e;e=i(c),e===s?r[e].p(c,f):(x(),I(r[s],1,1,()=>{r[s]=null}),ee(),a=r[e],a?a.p(c,f):(a=r[e]=l[e](c),a.c()),w(a,1),a.m(t.parentNode,t))},i(c){n||(w(a),n=!0)},o(c){I(a),n=!1},d(c){c&&p(t),r[e].d(c)}}}function Ke(o){let e;return{c(){e=k("i"),this.h()},l(a){e=C(a,"I",{class:!0}),T(e).forEach(p),this.h()},h(){b(e,"class","bi bi-plus")},m(a,t){F(a,e,t)},p:U,d(a){a&&p(e)}}}function Je(o){let e,a,t,n,l,r,i,c,f;return e=new Te({props:{title:o[1],id:H,$$slots:{default:[Xe]},$$scope:{ctx:o}}}),r=new z({props:{variant:"primary",size:"sm","data-bs-toggle":"offcanvas","data-bs-target":"#"+H,"aria-controls":H,$$slots:{default:[Ke]},$$scope:{ctx:o}}}),r.$on("click",o[7]),c=new Ue({props:{drawerId:H,data:o[3]}}),{c(){E(e.$$.fragment),a=B(),t=k("div"),n=k("div"),l=k("div"),E(r.$$.fragment),i=B(),E(c.$$.fragment),this.h()},l(s){D(e.$$.fragment,s),a=P(s),t=C(s,"DIV",{class:!0});var m=T(t);n=C(m,"DIV",{class:!0});var _=T(n);l=C(_,"DIV",{});var u=T(l);D(r.$$.fragment,u),u.forEach(p),_.forEach(p),i=P(m),D(c.$$.fragment,m),m.forEach(p),this.h()},h(){b(n,"class","d-flex justify-content-end align-items-center"),b(t,"class","d-flex flex-column gap-3")},m(s,m){L(e,s,m),F(s,a,m),F(s,t,m),h(t,n),h(n,l),L(r,l,null),h(t,i),L(c,t,null),f=!0},p(s,[m]){const _={};m&2&&(_.title=s[1]),m&2053&&(_.$$scope={dirty:m,ctx:s}),e.$set(_);const u={};m&2048&&(u.$$scope={dirty:m,ctx:s}),r.$set(u);const g={};m&8&&(g.data=s[3]),c.$set(g)},i(s){f||(w(e.$$.fragment,s),w(r.$$.fragment,s),w(c.$$.fragment,s),f=!0)},o(s){I(e.$$.fragment,s),I(r.$$.fragment,s),I(c.$$.fragment,s),f=!1},d(s){s&&(p(a),p(t)),S(e,s),S(r),S(c)}}}const H="category-form";function Qe(o,e,a){let t,n,l,r;const{stores:{data:i,targetCategory:c,loading:f},actions:{reload:s}}=M();W(o,i,g=>a(3,r=g)),W(o,c,g=>a(0,n=g)),W(o,f,g=>a(2,l=g));const m={name:""},_=()=>{f.set(!0),setTimeout(()=>{c.set(m),f.set(!1)},1500)};ke(s),Ce(Le);function u(g){l=g,f.set(l)}return o.$$.update=()=>{o.$$.dirty&1&&a(1,t=n?.id?"Edit Category":"Create Category")},[n,t,l,r,i,c,f,_,u]}class We extends R{constructor(e){super(),O(this,e,Qe,Je,A,{})}}function Ze(o){let e,a;return e=new We({}),{c(){E(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){L(e,t,n),a=!0},i(t){a||(w(e.$$.fragment,t),a=!0)},o(t){I(e.$$.fragment,t),a=!1},d(t){S(e,t)}}}function xe(o){let e,a;return e=new Ie({props:{pageTitle:"Categories",$$slots:{default:[Ze]},$$scope:{ctx:o}}}),{c(){E(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,n){L(e,t,n),a=!0},p(t,[n]){const l={};n&1&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){a||(w(e.$$.fragment,t),a=!0)},o(t){I(e.$$.fragment,t),a=!1},d(t){S(e,t)}}}class it extends R{constructor(e){super(),O(this,e,null,xe,A,{})}}export{it as component,st as universal};
