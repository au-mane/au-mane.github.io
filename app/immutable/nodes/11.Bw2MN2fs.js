import{k as He,s as We,r as mt,n as ze,h as Fe,v as bt,b as Ge,o as yt,B as st}from"../chunks/scheduler.DyivmMiW.js";import{S as Xe,i as Ze,v as Ie,o as Y,t as te,x as ht,a as ne,w as gt,d as I,e as b,s as V,b as X,c as Ce,j as y,k as A,l as W,f as L,m as Z,g as Se,n as p,y as Q,q as u,C as ee,p as Me,B as U,r as ie,u as Ee,E as at,D as xe,F as wt}from"../chunks/index.BqK79KpI.js";import{P as Dt}from"../chunks/PageLayout.CkrZNwOL.js";import{e as ke}from"../chunks/Header.CZ_Bj7fP.js";import{f as Pe,p as pe,c as Tt,D as It,g as kt}from"../chunks/budget.api._7bV1x_p.js";import{f as De}from"../chunks/app.state.DIzCX3o3.js";import{S as Ct}from"../chunks/Spinner.BlcZoQhc.js";import{s as Be}from"../chunks/supabase-config.Y8iSvhNi.js";import{w as de}from"../chunks/index.Cdixjbko.js";import{L as St}from"../chunks/Loading.Do7G-gm4.js";const Mt=!0,rn=Object.freeze(Object.defineProperty({__proto__:null,prerender:Mt},Symbol.toStringTag,{value:"Module"}));function Et(s){const e={};return s.forEach(n=>{const t=n.date.split("T")[0];e[t]||(e[t]=[]),e[t].push(n)}),Object.entries(e).map(([n,t])=>({dateStr:n,transactions:t}))}const lt=s=>s?Pe(pe(s,"yyyy-MM-dd",new Date),"MMM dd"):"",Nt=s=>s.map(e=>({id:e?.id||0,start:e?.start_at?Pe(pe(e.start_at.split("T")[0],"yyyy-MM-dd",new Date),"MMM dd"):"",end:e?.end_at?Pe(pe(e.end_at.split("T")[0],"yyyy-MM-dd",new Date),"MMM dd"):"",max_spending_limit:e?.settings?.max_spend_limit??0}));function At(s){const e=new Date;return s.find(n=>{if(n.start_at&&n.end_at){const t=pe(n.start_at.split("T")[0],"yyyy-MM-dd",new Date),a=pe(n.end_at.split("T")[0],"yyyy-MM-dd",new Date);return e>=t&&e<=a}return!1})}const Vt={type:"expense",amount:0,description:"",source:"",date:""},Je=de([]);let Qe=!1;async function Ke(s="",e=""){if(Qe)return He(Je);Qe=!0;let n=[];if(s&&e){const{data:t,error:a}=await Be.from("transactions").select("*").gte("date",s).lte("date",e).order("date",{ascending:!1});if(a)throw a;n=t||[],Je.set(n)}else{const{data:t,error:a}=await Be.from("transactions").select("*").order("date",{ascending:!1});if(a)throw a;n=t||[],Je.set(n)}return Qe=!1,n}async function Lt(s){const{data:e,error:n}=await Be.from("transactions").insert([s]).select();if(n)throw n;return await Ke(),e?e[0]:void 0}async function Pt(s,e){const{data:n,error:t}=await Be.from("transactions").update(e).eq("id",s).select();if(t)throw t;return await Ke(),n?n[0]:void 0}async function Bt(s){const{error:e}=await Be.from("transactions").delete().eq("id",s);if(e)throw e;await Ke()}let Le=null;const Ot=()=>{const s=de(!1),e=de([]),n=de([]),t=de(void 0),a=de([]),o=de(""),i=de("");let k,h;return Le={stores:{loading:s,data:e,dbData:n,dayTransactions:a,startDate:o,endDate:i,targetBudget:t},actions:{reload:async(v=!1)=>{s.set(!0);const _=He(o),l=He(i);if(v||k!==_&&h!==l){k=_,h=l;const f=await Ke(_,l);let w=He(t)?.settings?.max_spend_limit||0;const N=f.reverse().map(M=>{const{type:D,amount:E}=M;return w=D==="expense"?w-E:w,{...M,balance:w}}).reverse(),C=Et(N);a.set(C)}s.set(!1)}}},Le},vt=()=>Le?.stores&&Object.keys(Le.stores).length>0?Le:Ot();function rt(s){let e,n,t,a="Date*",o,i,k,h,m,v="Date helper text here",_,l,f,w="Amount*",N,C,M,D,E,P="Amount helper text here",q,r,d,j="Description*",B,c,K,ue,J,se="Description helper text here",ce,G,x,Oe="Source*",Ne,O,me,Ae,H,ae,_e=s[12].message+"",he,ge,Ve,le,g,re,ve,$,je,R,Ye,$e;g=new Ct({props:{size:"xs"}});let F=s[4]&&ot(s);function et(T,S){return T[4]?qt:jt}let qe=et(s),oe=qe(s),z=s[15]&&it();return{c(){e=b("div"),n=b("div"),t=b("div"),t.textContent=a,o=V(),i=b("input"),h=V(),m=b("small"),m.textContent=v,_=V(),l=b("div"),f=b("div"),f.textContent=w,N=V(),C=b("input"),D=V(),E=b("small"),E.textContent=P,q=V(),r=b("div"),d=b("div"),d.textContent=j,B=V(),c=b("input"),ue=V(),J=b("small"),J.textContent=se,ce=V(),G=b("div"),x=b("div"),x.textContent=Oe,Ne=V(),O=b("input"),Ae=V(),H=b("div"),ae=b("small"),he=X(_e),Ve=V(),le=b("span"),Ce(g.$$.fragment),re=V(),F&&F.c(),ve=V(),$=b("button"),oe.c(),je=V(),z&&z.c(),this.h()},l(T){e=y(T,"DIV",{class:!0});var S=A(e);n=y(S,"DIV",{class:!0});var be=A(n);t=y(be,"DIV",{"data-svelte-h":!0}),W(t)!=="svelte-1992pd0"&&(t.textContent=a),o=L(be),i=y(be,"INPUT",{name:!0,type:!0,class:!0}),h=L(be),m=y(be,"SMALL",{class:!0,"data-svelte-h":!0}),W(m)!=="svelte-oew5wf"&&(m.textContent=v),be.forEach(I),_=L(S),l=y(S,"DIV",{class:!0});var ye=A(l);f=y(ye,"DIV",{"data-svelte-h":!0}),W(f)!=="svelte-r3jt44"&&(f.textContent=w),N=L(ye),C=y(ye,"INPUT",{name:!0,type:!0,class:!0}),D=L(ye),E=y(ye,"SMALL",{class:!0,"data-svelte-h":!0}),W(E)!=="svelte-1h9aie7"&&(E.textContent=P),ye.forEach(I),q=L(S),r=y(S,"DIV",{class:!0});var we=A(r);d=y(we,"DIV",{"data-svelte-h":!0}),W(d)!=="svelte-8167a8"&&(d.textContent=j),B=L(we),c=y(we,"INPUT",{name:!0,type:!0,class:!0,placeholder:!0}),ue=L(we),J=y(we,"SMALL",{class:!0,"data-svelte-h":!0}),W(J)!=="svelte-1x398eh"&&(J.textContent=se),we.forEach(I),ce=L(S),G=y(S,"DIV",{class:!0});var Re=A(G);x=y(Re,"DIV",{"data-svelte-h":!0}),W(x)!=="svelte-1irjajf"&&(x.textContent=Oe),Ne=L(Re),O=y(Re,"INPUT",{name:!0,type:!0,class:!0,placeholder:!0}),Re.forEach(I),Ae=L(S),H=y(S,"DIV",{class:!0});var fe=A(H);ae=y(fe,"SMALL",{class:!0});var tt=A(ae);he=Z(tt,_e),tt.forEach(I),Ve=L(fe),le=y(fe,"SPAN",{});var nt=A(le);Se(g.$$.fragment,nt),nt.forEach(I),re=L(fe),F&&F.l(fe),ve=L(fe),$=y(fe,"BUTTON",{class:!0});var Ue=A($);oe.l(Ue),je=L(Ue),z&&z.l(Ue),Ue.forEach(I),fe.forEach(I),S.forEach(I),this.h()},h(){p(i,"name",k=s[1]+"-date"),p(i,"type","date"),p(i,"class","form-control"),i.disabled=s[7],i.required=!0,Q(i,"is-invalid",s[13]),p(m,"class","fw-lighter fst-italic"),p(n,"class","d-flex flex-column gap-2"),p(C,"name",M=s[1]+"-amount"),p(C,"type","text"),p(C,"class","form-control text-end"),C.disabled=s[7],C.required=!0,Q(C,"is-invalid",s[14]),p(E,"class","fw-lighter fst-italic"),p(l,"class","d-flex flex-column gap-2"),p(c,"name",K=s[1]+"-description"),p(c,"type","text"),p(c,"class","form-control"),p(c,"placeholder","Description"),c.disabled=s[7],c.required=!0,Q(c,"is-invalid",s[6]),p(J,"class","fw-lighter fst-italic"),p(r,"class","d-flex flex-column gap-2"),p(O,"name",me=s[1]+"-source"),p(O,"type","text"),p(O,"class","form-control"),p(O,"placeholder","Source"),O.disabled=s[7],O.required=!0,Q(O,"is-invalid",s[5]),p(G,"class","d-flex flex-column gap-2"),p(ae,"class",ge="fw-lighter fst-italic text-"+s[12].type),Q(le,"d-none",!s[7]),p($,"class","btn btn-primary position-relative"),p(H,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),p(e,"class","d-flex flex-column gap-4")},m(T,S){Y(T,e,S),u(e,n),u(n,t),u(n,o),u(n,i),s[21](i),ee(i,s[2]),u(n,h),u(n,m),u(e,_),u(e,l),u(l,f),u(l,N),u(l,C),s[25](C),ee(C,s[0].amount),u(l,D),u(l,E),u(e,q),u(e,r),u(r,d),u(r,B),u(r,c),s[29](c),ee(c,s[0].description),u(r,ue),u(r,J),u(e,ce),u(e,G),u(G,x),u(G,Ne),u(G,O),s[33](O),ee(O,s[0].source),u(e,Ae),u(e,H),u(H,ae),u(ae,he),u(H,Ve),u(H,le),Me(g,le,null),u(H,re),F&&F.m(H,null),u(H,ve),u(H,$),oe.m($,null),u($,je),z&&z.m($,null),R=!0,Ye||($e=[U(i,"focus",s[22]),U(i,"keyup",s[23]),U(i,"input",s[24]),U(C,"focus",s[26]),U(C,"keyup",s[27]),U(C,"input",s[28]),U(c,"focus",s[30]),U(c,"keyup",s[31]),U(c,"input",s[32]),U(O,"focus",s[34]),U(O,"keyup",s[35]),U(O,"input",s[36]),U($,"click",s[17])],Ye=!0)},p(T,S){(!R||S[0]&2&&k!==(k=T[1]+"-date"))&&p(i,"name",k),(!R||S[0]&128)&&(i.disabled=T[7]),S[0]&4&&ee(i,T[2]),(!R||S[0]&8192)&&Q(i,"is-invalid",T[13]),(!R||S[0]&2&&M!==(M=T[1]+"-amount"))&&p(C,"name",M),(!R||S[0]&128)&&(C.disabled=T[7]),S[0]&1&&C.value!==T[0].amount&&ee(C,T[0].amount),(!R||S[0]&16384)&&Q(C,"is-invalid",T[14]),(!R||S[0]&2&&K!==(K=T[1]+"-description"))&&p(c,"name",K),(!R||S[0]&128)&&(c.disabled=T[7]),S[0]&1&&c.value!==T[0].description&&ee(c,T[0].description),(!R||S[0]&64)&&Q(c,"is-invalid",T[6]),(!R||S[0]&2&&me!==(me=T[1]+"-source"))&&p(O,"name",me),(!R||S[0]&128)&&(O.disabled=T[7]),S[0]&1&&O.value!==T[0].source&&ee(O,T[0].source),(!R||S[0]&32)&&Q(O,"is-invalid",T[5]),(!R||S[0]&4096)&&_e!==(_e=T[12].message+"")&&ie(he,_e),(!R||S[0]&4096&&ge!==(ge="fw-lighter fst-italic text-"+T[12].type))&&p(ae,"class",ge),(!R||S[0]&128)&&Q(le,"d-none",!T[7]),T[4]?F?F.p(T,S):(F=ot(T),F.c(),F.m(H,ve)):F&&(F.d(1),F=null),qe!==(qe=et(T))&&(oe.d(1),oe=qe(T),oe&&(oe.c(),oe.m($,je))),T[15]?z||(z=it(),z.c(),z.m($,null)):z&&(z.d(1),z=null)},i(T){R||(te(g.$$.fragment,T),R=!0)},o(T){ne(g.$$.fragment,T),R=!1},d(T){T&&I(e),s[21](null),s[25](null),s[29](null),s[33](null),Ee(g),F&&F.d(),oe.d(),z&&z.d(),Ye=!1,mt($e)}}}function ot(s){let e,n="<span>Delete</span>",t,a;return{c(){e=b("button"),e.innerHTML=n,this.h()},l(o){e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-4hjfsp"&&(e.innerHTML=n),this.h()},h(){p(e,"class","btn btn-danger position-relative")},m(o,i){Y(o,e,i),t||(a=U(e,"click",s[16]),t=!0)},p:ze,d(o){o&&I(e),t=!1,a()}}}function jt(s){let e,n="Create";return{c(){e=b("span"),e.textContent=n},l(t){e=y(t,"SPAN",{"data-svelte-h":!0}),W(e)!=="svelte-1wf0js6"&&(e.textContent=n)},m(t,a){Y(t,e,a)},d(t){t&&I(e)}}}function qt(s){let e,n="Save";return{c(){e=b("span"),e.textContent=n},l(t){e=y(t,"SPAN",{"data-svelte-h":!0}),W(e)!=="svelte-l126tb"&&(e.textContent=n)},m(t,a){Y(t,e,a)},d(t){t&&I(e)}}}function it(s){let e,n='<span class="visually-hidden">Item not saved</span>';return{c(){e=b("span"),e.innerHTML=n,this.h()},l(t){e=y(t,"SPAN",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-1sxrz4i"&&(e.innerHTML=n),this.h()},h(){p(e,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(t,a){Y(t,e,a)},d(t){t&&I(e)}}}function Rt(s){let e,n,t=s[0]&&rt(s);return{c(){t&&t.c(),e=Ie()},l(a){t&&t.l(a),e=Ie()},m(a,o){t&&t.m(a,o),Y(a,e,o),n=!0},p(a,o){a[0]?t?(t.p(a,o),o[0]&1&&te(t,1)):(t=rt(a),t.c(),te(t,1),t.m(e.parentNode,e)):t&&(ht(),ne(t,1,1,()=>{t=null}),gt())},i(a){n||(te(t),n=!0)},o(a){ne(t),n=!1},d(a){a&&I(e),t&&t.d(a)}}}function Ut(s,e,n){let t,a,o,i,k,h,m,{name:v=""}=e,{drawerId:_=""}=e,{transaction:l}=e;const{actions:{reload:f}}=vt();let w=!1,N,C=0,M,D,E,P,q={message:"",type:"info"},r,d={source:!1,description:!1,amount:!1,date:!1};const j=()=>{const g=`[data-bs-target="#${_}"]`,re=document.querySelector(g);re&&re.click()},B=()=>{n(3,d={source:!1,description:!1,date:!1,amount:!1}),n(0,l={...Vt}),n(7,w=!1)},c=(g,re=0,ve="info")=>{n(12,q.message=g,q),n(12,q.type=ve,q),re&&setTimeout(()=>{n(12,q.message="",q)},re)},K=async()=>{if(!t){c("ID is not defined",0,"danger");return}try{await Bt(t),await f(!0),setTimeout(()=>{n(7,w=!1),n(20,r={...l,id:t,date:pe(N,"yyyy-MM-dd",new Date).toISOString()}),c("Transaction Deleted",3e3,"success"),j()},800)}catch(g){setTimeout(()=>{n(7,w=!1),console.error("Save failed:",g),c("Failed to save event. Please try again.",7e3,"danger")},800)}},ue=()=>{n(7,w=!0),Tt({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:g=>{g&&K(),B()}})},J=async()=>{if(!a){c("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!m){let g=[];i&&g.push("Amount is invalid"),o&&g.push("Date is invalid"),h&&g.push("Description is invalid"),k&&g.push("Source is invalid"),c(g.join(". ")+".  Please address accordingly.",0,"danger");return}if(!w){c("Saving ..."),n(7,w=!0);try{const g={...l,date:pe(N,"yyyy-MM-dd",new Date).toISOString()};t?await Pt(t,g):await Lt(g),await f(!0),setTimeout(()=>{n(7,w=!1),n(20,r={...l,id:t}),c("Saved",3e3,"success"),t||B(),j()},800)}catch(g){setTimeout(()=>{n(7,w=!1),console.error("Save failed:",g),c("Failed to save event. Please try again.",7e3,"danger"),t||B()},800)}}};function se(g){Fe[g?"unshift":"push"](()=>{E=g,n(10,E)})}const ce=()=>E.select(),G=()=>n(3,d.date=!0,d);function x(){N=this.value,n(2,N),n(4,t),n(0,l),n(19,C)}function Oe(g){Fe[g?"unshift":"push"](()=>{P=g,n(11,P)})}const Ne=()=>P.select(),O=()=>n(3,d.amount=!0,d);function me(){l.amount=this.value,n(0,l)}function Ae(g){Fe[g?"unshift":"push"](()=>{M=g,n(8,M)})}const H=()=>M.select(),ae=()=>n(3,d.description=!0,d);function _e(){l.description=this.value,n(0,l)}function he(g){Fe[g?"unshift":"push"](()=>{D=g,n(9,D)})}const ge=()=>D.select(),Ve=()=>n(3,d.source=!0,d);function le(){l.source=this.value,n(0,l)}return s.$$set=g=>{"name"in g&&n(1,v=g.name),"drawerId"in g&&n(18,_=g.drawerId),"transaction"in g&&n(0,l=g.transaction)},s.$$.update=()=>{s.$$.dirty[0]&1&&n(4,t=l?.id),s.$$.dirty[0]&524305&&t&&l&&C!==t&&(n(7,w=!0),setTimeout(()=>{n(20,r={...l}),n(19,C=t),n(2,N=Pe(l.date,"yyyy-MM-dd")),n(7,w=!1)},800)),s.$$.dirty[0]&1048581&&n(15,a=r?.date!==N||r?.amount!==l?.amount||r?.description!==l?.description||r?.source!==l?.source),s.$$.dirty[0]&9&&n(13,o=d.date&&l.date===""),s.$$.dirty[0]&9&&n(14,i=d.amount&&l.amount===0),s.$$.dirty[0]&9&&n(5,k=d.source&&l.source===""),s.$$.dirty[0]&9&&n(6,h=d.description&&l.description===""),s.$$.dirty[0]&96&&(m=!k&&!h)},[l,v,N,d,t,k,h,w,M,D,E,P,q,o,i,a,ue,J,_,C,r,se,ce,G,x,Oe,Ne,O,me,Ae,H,ae,_e,he,ge,Ve,le]}class Ft extends Xe{constructor(e){super(),Ze(this,e,Ut,Rt,We,{name:1,drawerId:18,transaction:0},null,[-1,-1])}}function ut(s,e,n){const t=s.slice();return t[20]=e[n],t}function ct(s,e,n){const t=s.slice();return t[23]=e[n],t}function ft(s,e,n){const t=s.slice();return t[26]=e[n],t}function Ht(s){let e,n;return e=new Ft({props:{name:"member-list-item-form-new",drawerId:Te,transaction:s[3]}}),{c(){Ce(e.$$.fragment)},l(t){Se(e.$$.fragment,t)},m(t,a){Me(e,t,a),n=!0},p(t,a){const o={};a&8&&(o.transaction=t[3]),e.$set(o)},i(t){n||(te(e.$$.fragment,t),n=!0)},o(t){ne(e.$$.fragment,t),n=!1},d(t){Ee(e,t)}}}function dt(s){let e,n=s[26].start+"",t,a,o=s[26].end+"",i,k,h=De(s[26].max_spending_limit)+"",m,v,_;return{c(){e=b("option"),t=X(n),a=X(" to "),i=X(o),k=X(" ("),m=X(h),v=X(`)
			`),this.h()},l(l){e=y(l,"OPTION",{});var f=A(e);t=Z(f,n),a=Z(f," to "),i=Z(f,o),k=Z(f," ("),m=Z(f,h),v=Z(f,`)
			`),f.forEach(I),this.h()},h(){e.__value=_=s[26].id,ee(e,e.__value)},m(l,f){Y(l,e,f),u(e,t),u(e,a),u(e,i),u(e,k),u(e,m),u(e,v)},p(l,f){f&4&&n!==(n=l[26].start+"")&&ie(t,n),f&4&&o!==(o=l[26].end+"")&&ie(i,o),f&4&&h!==(h=De(l[26].max_spending_limit)+"")&&ie(m,h),f&4&&_!==(_=l[26].id)&&(e.__value=_,ee(e,e.__value))},d(l){l&&I(e)}}}function zt(s){let e,n=ke(s[5]),t=[];for(let a=0;a<n.length;a+=1)t[a]=pt(ut(s,n,a));return{c(){for(let a=0;a<t.length;a+=1)t[a].c();e=Ie()},l(a){for(let o=0;o<t.length;o+=1)t[o].l(a);e=Ie()},m(a,o){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(a,o);Y(a,e,o)},p(a,o){if(o&1056){n=ke(a[5]);let i;for(i=0;i<n.length;i+=1){const k=ut(a,n,i);t[i]?t[i].p(k,o):(t[i]=pt(k),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=n.length}},i:ze,o:ze,d(a){a&&I(e),xe(t,a)}}}function Kt(s){let e,n;return e=new St({}),{c(){Ce(e.$$.fragment)},l(t){Se(e.$$.fragment,t)},m(t,a){Me(e,t,a),n=!0},p:ze,i(t){n||(te(e.$$.fragment,t),n=!0)},o(t){ne(e.$$.fragment,t),n=!1},d(t){Ee(e,t)}}}function _t(s){let e,n,t,a=s[23].description+"",o,i,k,h=s[23].source+"",m,v,_,l,f,w=De(s[23].amount)+"",N,C,M,D,E=De(s[23]?.balance)+"",P,q,r,d;function j(){return s[15](s[23])}return{c(){e=b("div"),n=b("div"),t=b("div"),o=X(a),i=V(),k=b("div"),m=X(h),v=V(),_=b("div"),l=b("div"),f=b("button"),N=X(w),M=V(),D=b("div"),P=X(E),q=V(),this.h()},l(B){e=y(B,"DIV",{class:!0});var c=A(e);n=y(c,"DIV",{});var K=A(n);t=y(K,"DIV",{});var ue=A(t);o=Z(ue,a),ue.forEach(I),i=L(K),k=y(K,"DIV",{class:!0});var J=A(k);m=Z(J,h),J.forEach(I),K.forEach(I),v=L(c),_=y(c,"DIV",{class:!0});var se=A(_);l=y(se,"DIV",{class:!0});var ce=A(l);f=y(ce,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var G=A(f);N=Z(G,w),G.forEach(I),ce.forEach(I),M=L(se),D=y(se,"DIV",{class:!0});var x=A(D);P=Z(x,E),x.forEach(I),se.forEach(I),q=L(c),c.forEach(I),this.h()},h(){p(k,"class","fw-light text-muted"),p(f,"class","btn btn-sm btn-link ps-0"),p(f,"type","button"),p(f,"data-bs-toggle","offcanvas"),p(f,"data-bs-target","#"+Te),p(f,"aria-controls",Te),p(l,"class",C=st(s[23].type)+" svelte-xe6rrl"),p(D,"class","fw-lighter"),Q(D,"text-warning",s[23]?.balance!==void 0&&s[23]?.balance<0),p(_,"class","d-flex justify-content-between align-items-center"),p(e,"class","border-top p-2")},m(B,c){Y(B,e,c),u(e,n),u(n,t),u(t,o),u(n,i),u(n,k),u(k,m),u(e,v),u(e,_),u(_,l),u(l,f),u(f,N),u(_,M),u(_,D),u(D,P),u(e,q),r||(d=U(f,"click",j),r=!0)},p(B,c){s=B,c&32&&a!==(a=s[23].description+"")&&ie(o,a),c&32&&h!==(h=s[23].source+"")&&ie(m,h),c&32&&w!==(w=De(s[23].amount)+"")&&ie(N,w),c&32&&C!==(C=st(s[23].type)+" svelte-xe6rrl")&&p(l,"class",C),c&32&&E!==(E=De(s[23]?.balance)+"")&&ie(P,E),c&32&&Q(D,"text-warning",s[23]?.balance!==void 0&&s[23]?.balance<0)},d(B){B&&I(e),r=!1,d()}}}function pt(s){let e,n,t=lt(s[20]?.dateStr)+"",a,o,i,k,h=ke(s[20].transactions),m=[];for(let v=0;v<h.length;v+=1)m[v]=_t(ct(s,h,v));return{c(){e=b("div"),n=b("div"),a=X(t),o=V(),i=b("div");for(let v=0;v<m.length;v+=1)m[v].c();k=V(),this.h()},l(v){e=y(v,"DIV",{});var _=A(e);n=y(_,"DIV",{class:!0});var l=A(n);a=Z(l,t),l.forEach(I),o=L(_),i=y(_,"DIV",{});var f=A(i);for(let w=0;w<m.length;w+=1)m[w].l(f);f.forEach(I),k=L(_),_.forEach(I),this.h()},h(){p(n,"class","fw-bolder text-uppercase p-2")},m(v,_){Y(v,e,_),u(e,n),u(n,a),u(e,o),u(e,i);for(let l=0;l<m.length;l+=1)m[l]&&m[l].m(i,null);u(e,k)},p(v,_){if(_&32&&t!==(t=lt(v[20]?.dateStr)+"")&&ie(a,t),_&1056){h=ke(v[20].transactions);let l;for(l=0;l<h.length;l+=1){const f=ct(v,h,l);m[l]?m[l].p(f,_):(m[l]=_t(f),m[l].c(),m[l].m(i,null))}for(;l<m.length;l+=1)m[l].d(1);m.length=h.length}},d(v){v&&I(e),xe(m,v)}}}function Yt(s){let e,n,t,a,o,i="Range",k,h,m,v,_,l,f,w,N,C;e=new It({props:{title:"Drawer Title",id:Te,$$slots:{default:[Ht]},$$scope:{ctx:s}}});let M=ke(s[2]),D=[];for(let r=0;r<M.length;r+=1)D[r]=dt(ft(s,M,r));const E=[Kt,zt],P=[];function q(r,d){return r[4]?0:r[5].length&&r[1]?1:-1}return~(_=q(s))&&(l=P[_]=E[_](s)),{c(){Ce(e.$$.fragment),n=V(),t=b("div"),a=b("select"),o=b("option"),o.textContent=i;for(let r=0;r<D.length;r+=1)D[r].c();k=V(),h=b("button"),m=b("i"),v=V(),l&&l.c(),f=Ie(),this.h()},l(r){Se(e.$$.fragment,r),n=L(r),t=y(r,"DIV",{class:!0});var d=A(t);a=y(d,"SELECT",{class:!0,"aria-label":!0});var j=A(a);o=y(j,"OPTION",{"data-svelte-h":!0}),W(o)!=="svelte-1k3fjyk"&&(o.textContent=i);for(let c=0;c<D.length;c+=1)D[c].l(j);j.forEach(I),k=L(d),h=y(d,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var B=A(h);m=y(B,"I",{class:!0}),A(m).forEach(I),B.forEach(I),d.forEach(I),v=L(r),l&&l.l(r),f=Ie(),this.h()},h(){o.selected=!0,o.__value="Range",ee(o,o.__value),p(a,"class","form-select"),p(a,"aria-label","Default select example"),s[0]===void 0&&bt(()=>s[13].call(a)),p(m,"class","bi bi-plus"),p(h,"class","btn btn-sm btn-secondary"),p(h,"type","button"),p(h,"data-bs-toggle","offcanvas"),p(h,"data-bs-target","#"+Te),p(h,"aria-controls",Te),p(t,"class","transaction-page d-flex justify-content-between gap-3")},m(r,d){Me(e,r,d),Y(r,n,d),Y(r,t,d),u(t,a),u(a,o);for(let j=0;j<D.length;j+=1)D[j]&&D[j].m(a,null);at(a,s[0],!0),u(t,k),u(t,h),u(h,m),Y(r,v,d),~_&&P[_].m(r,d),Y(r,f,d),w=!0,N||(C=[U(a,"change",s[13]),U(h,"click",s[14])],N=!0)},p(r,[d]){const j={};if(d&536870920&&(j.$$scope={dirty:d,ctx:r}),e.$set(j),d&4){M=ke(r[2]);let c;for(c=0;c<M.length;c+=1){const K=ft(r,M,c);D[c]?D[c].p(K,d):(D[c]=dt(K),D[c].c(),D[c].m(a,null))}for(;c<D.length;c+=1)D[c].d(1);D.length=M.length}d&5&&at(a,r[0]);let B=_;_=q(r),_===B?~_&&P[_].p(r,d):(l&&(ht(),ne(P[B],1,1,()=>{P[B]=null}),gt()),~_?(l=P[_],l?l.p(r,d):(l=P[_]=E[_](r),l.c()),te(l,1),l.m(f.parentNode,f)):l=null)},i(r){w||(te(e.$$.fragment,r),te(l),w=!0)},o(r){ne(e.$$.fragment,r),ne(l),w=!1},d(r){r&&(I(n),I(t),I(v),I(f)),Ee(e,r),xe(D,r),~_&&P[_].d(r),N=!1,mt(C)}}}const Te="transactions-form";function Gt(s,e,n){let t,a,o;const{stores:{loading:i,targetBudget:k,dayTransactions:h,startDate:m,endDate:v},actions:{reload:_}}=vt();Ge(s,i,d=>n(4,a=d)),Ge(s,k,d=>n(1,t=d)),Ge(s,h,d=>n(5,o=d));let l=[],f,w=[],N,C,M=!1;const D={type:"expense",amount:0,description:"test",source:"test",date:Pe(new Date,"yyyy-mm-dd")},E=d=>{n(3,C=d)};yt(async()=>{n(11,w=await kt()),n(2,l=Nt(w)),N=At(w),n(0,f=N?.id)});function P(){f=wt(this),n(0,f),n(2,l)}const q=()=>E({...D}),r=d=>E(d);return s.$$.update=()=>{if(s.$$.dirty&6147&&f&&!M&&t?.id!==f&&(k.set(w.find(d=>d.id===f)),t&&t.start_at&&t.end_at)){n(12,M=!0);const d=t.start_at.split("T")[0],j=t.end_at.split("T")[0];m.set(d),v.set(j),_(),n(12,M=!1)}},[f,t,l,C,a,o,i,k,h,D,E,w,M,P,q,r]}class Jt extends Xe{constructor(e){super(),Ze(this,e,Gt,Yt,We,{})}}function Qt(s){let e,n;return e=new Jt({}),{c(){Ce(e.$$.fragment)},l(t){Se(e.$$.fragment,t)},m(t,a){Me(e,t,a),n=!0},i(t){n||(te(e.$$.fragment,t),n=!0)},o(t){ne(e.$$.fragment,t),n=!1},d(t){Ee(e,t)}}}function Wt(s){let e,n;return e=new Dt({props:{pageTitle:"Transactions",$$slots:{default:[Qt]},$$scope:{ctx:s}}}),{c(){Ce(e.$$.fragment)},l(t){Se(e.$$.fragment,t)},m(t,a){Me(e,t,a),n=!0},p(t,[a]){const o={};a&1&&(o.$$scope={dirty:a,ctx:t}),e.$set(o)},i(t){n||(te(e.$$.fragment,t),n=!0)},o(t){ne(e.$$.fragment,t),n=!1},d(t){Ee(e,t)}}}class on extends Xe{constructor(e){super(),Ze(this,e,null,Wt,We,{})}}export{on as component,rn as universal};
