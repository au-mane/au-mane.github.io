import{K as we,s as z,F as X,a7 as te,M as ce,z as H,n as U,d as p,e as A,b as P,i as y,j as F,f as L,k as Z,m as $,o as _,H as Q,x as Ce,v as x,L as ke,t as le,l as oe,p as ue,q as se,r as $e}from"../chunks/scheduler.DhhAuCu-.js";import{S as M,i as J,f as ne,c as O,b as N,m as V,t as I,a as S,d as j,g as pe,e as be}from"../chunks/index.u5q9Pbhc.js";import{P as Ae}from"../chunks/PageLayout.Cm1Q0z2H.js";import{c as ye,D as Te,F as Ie}from"../chunks/FormSkeleton.BsYJ32fv.js";import{w as W}from"../chunks/index.sYBPruaS.js";import{s as ae}from"../chunks/supabase-config.Y8iSvhNi.js";import{T as Ee,N as Se,S as De}from"../chunks/SelectField.Bx6iKZRJ.js";import{e as de}from"../chunks/Header.CQ7buZto.js";const Fe=!0,pt=Object.freeze(Object.defineProperty({__proto__:null,prerender:Fe},Symbol.toStringTag,{value:"Module"})),fe=W([]);let ie=!1;async function re(){if(ie)return we(fe);ie=!0;const{data:a,error:e}=await ae.from("accounts").select("*").order("sort_index",{ascending:!0});if(e)throw e;const n=a||[];return fe.set(n),ie=!1,n}async function Oe(a){const{data:e,error:n}=await ae.from("accounts").insert([a]).select();if(n)throw n;return await re(),e?e[0]:void 0}async function Ne(a,e){const{data:n,error:t}=await ae.from("accounts").update(e).eq("id",a).select();if(t)throw t;return await re(),n?n[0]:void 0}async function Ve(a){const{error:e}=await ae.from("accounts").delete().eq("id",a);if(e)throw e;await re()}let Y=null;const je=()=>{const a=W(!1),e=W([]),n=W();return Y={stores:{loading:a,targetAccount:n,data:e},actions:{reload:async()=>{a.set(!0);const o=await re();e.set(o),a.set(!1)},createAccount:async o=>{a.set(!0);try{await Oe(o)}catch(i){console.error(i)}finally{a.set(!1)}},updateAccount:async(o,i)=>{a.set(!0);try{await Ne(o,i)}catch(c){console.error(c)}finally{a.set(!1)}},deleteAccount:async o=>{a.set(!0);try{await Ve(o)}catch(i){console.error(i)}finally{a.set(!1)}}}},Y},ee=()=>Y?.stores&&Object.keys(Y.stores).length>0&&Y?.actions&&Object.keys(Y.actions).length>0?Y:je();function qe(a){let e,n,t;function l(r){a[7](r)}let s={label:"Name",name:"account-name-field",placeholder:"",helperText:a[3],loading:a[1],required:!0,isInvalid:a[2]};return a[0]!==void 0&&(s.value=a[0]),e=new Ee({props:s}),X.push(()=>ne(e,"value",l)),e.$on("valueChanged",a[4]),{c(){O(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,o){V(e,r,o),t=!0},p(r,[o]){const i={};o&8&&(i.helperText=r[3]),o&2&&(i.loading=r[1]),o&4&&(i.isInvalid=r[2]),!n&&o&1&&(n=!0,i.value=r[0],te(()=>n=!1)),e.$set(i)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){S(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}const Be="Account name i.e. Chase, American Express, America First",Pe="This field is required";function Le(a,e,n){let t,l,{value:s}=e,{loading:r}=e;function o(){return n(6,f=!0),!t}const i=ce(),c=()=>{i("valueChanged",{value:s}),n(6,f=!0)};let f=!1;function v(u){s=u,n(0,s)}return a.$$set=u=>{"value"in u&&n(0,s=u.value),"loading"in u&&n(1,r=u.loading)},a.$$.update=()=>{a.$$.dirty&65&&n(2,t=f&&!s.trim()),a.$$.dirty&4&&n(3,l=t?Pe:Be)},[s,r,t,l,c,o,f,v]}class Ue extends M{constructor(e){super(),J(this,e,Le,qe,z,{value:0,loading:1,validateField:5})}get validateField(){return this.$$.ctx[5]}}function Re(a){let e,n,t;function l(r){a[7](r)}let s={min:0,label:"Sort Index",name:"account-sort-index-field",placeholder:"",helperText:a[3],loading:a[1],required:!0,isInvalid:a[2]};return a[0]!==void 0&&(s.value=a[0]),e=new Se({props:s}),X.push(()=>ne(e,"value",l)),e.$on("valueChanged",a[4]),{c(){O(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,o){V(e,r,o),t=!0},p(r,[o]){const i={};o&8&&(i.helperText=r[3]),o&2&&(i.loading=r[1]),o&4&&(i.isInvalid=r[2]),!n&&o&1&&(n=!0,i.value=r[0],te(()=>n=!1)),e.$set(i)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){S(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function He(a,e,n){let t,l,{value:s}=e,{loading:r}=e;function o(){return n(6,f=!0),!t}const i=ce(),c=()=>{i("valueChanged",{value:s}),n(6,f=!0)};let f=!1;function v(u){s=u,n(0,s)}return a.$$set=u=>{"value"in u&&n(0,s=u.value),"loading"in u&&n(1,r=u.loading)},a.$$.update=()=>{a.$$.dirty&65&&n(2,t=f&&s<0),a.$$.dirty&4&&n(3,l=t?"Value should be 0 or more":"")},[s,r,t,l,c,o,f,v]}class Ye extends M{constructor(e){super(),J(this,e,He,Re,z,{value:0,loading:1,validateField:5})}get validateField(){return this.$$.ctx[5]}}const ze={creditCard:{label:"Credit Card",value:"credit-card",sort_order:0},checkings:{label:"Checkings",value:"checkings",sort_order:1},savings:{label:"Savings",value:"savings",sort_order:2},cash:{label:"Cash",value:"cash",sort_order:3},check:{label:"Check",value:"check",sort_order:4},other:{label:"Other",value:"other",sort_order:5}},Me=Object.values(ze).sort((a,e)=>a.sort_order-e.sort_order).map(a=>({key:a.label,value:a.value}));function Je(a){let e,n,t;function l(r){a[4](r)}let s={label:"Account type",name:"account-type",helperText:Ke,loading:a[1],required:!0,isInvalid:!1,disabled:!1,options:a[3]};return a[0]!==void 0&&(s.value=a[0]),e=new De({props:s}),X.push(()=>ne(e,"value",l)),e.$on("change",a[2]),{c(){O(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,o){V(e,r,o),t=!0},p(r,[o]){const i={};o&2&&(i.loading=r[1]),!n&&o&1&&(n=!0,i.value=r[0],te(()=>n=!1)),e.$set(i)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){S(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}const Ke="Specify the account type as follows Credit Card, Savings, Checking etc";function Xe(a,e,n){let{value:t}=e,{loading:l}=e;const s=ce(),r=()=>{s("valueChanged",{value:t})},o=Me;function i(c){t=c,n(0,t)}return a.$$set=c=>{"value"in c&&n(0,t=c.value),"loading"in c&&n(1,l=c.loading)},[t,l,r,o,i]}class Ge extends M{constructor(e){super(),J(this,e,Xe,Je,z,{value:0,loading:1})}}function ge(a){let e,n,t,l,s,r,o,i,c,f,v,u,D="Cancel",k,T,g="Save",b,E,d,h={loading:a[0],value:a[1].name};n=new Ue({props:h}),a[11](n),n.$on("valueChanged",a[12]),l=new Ge({props:{loading:a[0],value:a[1].type}}),l.$on("valueChanged",a[13]);let q={loading:a[0],value:a[1].sort_index};r=new Ye({props:q}),a[14](r),r.$on("valueChanged",a[15]);let w=a[1].id&&me(a);return{c(){e=A("div"),O(n.$$.fragment),t=P(),O(l.$$.fragment),s=P(),O(r.$$.fragment),o=P(),i=A("div"),c=A("div"),w&&w.c(),f=P(),v=A("div"),u=A("button"),u.textContent=D,k=P(),T=A("button"),T.textContent=g,this.h()},l(m){e=y(m,"DIV",{class:!0});var C=F(e);N(n.$$.fragment,C),t=L(C),N(l.$$.fragment,C),s=L(C),N(r.$$.fragment,C),o=L(C),i=y(C,"DIV",{class:!0});var B=F(i);c=y(B,"DIV",{});var K=F(c);w&&w.l(K),K.forEach(p),f=L(B),v=y(B,"DIV",{});var R=F(v);u=y(R,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(u)!=="svelte-1ujapj6"&&(u.textContent=D),k=L(R),T=y(R,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(T)!=="svelte-1av7h0z"&&(T.textContent=g),R.forEach(p),B.forEach(p),C.forEach(p),this.h()},h(){$(u,"class","btn btn-sm btn-secondary"),$(T,"class","btn btn-sm btn-primary"),$(i,"class","d-flex justify-content-between"),$(e,"class","d-flex flex-column gap-3")},m(m,C){U(m,e,C),V(n,e,null),_(e,t),V(l,e,null),_(e,s),V(r,e,null),_(e,o),_(e,i),_(i,c),w&&w.m(c,null),_(i,f),_(i,v),_(v,u),_(v,k),_(v,T),b=!0,E||(d=[Q(u,"click",a[5]),Q(T,"click",a[6])],E=!0)},p(m,C){const B={};C&1&&(B.loading=m[0]),C&2&&(B.value=m[1].name),n.$set(B);const K={};C&1&&(K.loading=m[0]),C&2&&(K.value=m[1].type),l.$set(K);const R={};C&1&&(R.loading=m[0]),C&2&&(R.value=m[1].sort_index),r.$set(R),m[1].id?w?w.p(m,C):(w=me(m),w.c(),w.m(c,null)):w&&(w.d(1),w=null)},i(m){b||(I(n.$$.fragment,m),I(l.$$.fragment,m),I(r.$$.fragment,m),b=!0)},o(m){S(n.$$.fragment,m),S(l.$$.fragment,m),S(r.$$.fragment,m),b=!1},d(m){m&&p(e),a[11](null),j(n),j(l),a[14](null),j(r),w&&w.d(),E=!1,Ce(d)}}}function me(a){let e,n="Delete",t,l;return{c(){e=A("button"),e.textContent=n,this.h()},l(s){e=y(s,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1a2qbe2"&&(e.textContent=n),this.h()},h(){$(e,"class","btn btn-sm btn-danger")},m(s,r){U(s,e,r),t||(l=Q(e,"click",a[7]),t=!0)},p:x,d(s){s&&p(e),t=!1,l()}}}function Qe(a){let e,n,t=a[1]&&ge(a);return{c(){t&&t.c(),e=H()},l(l){t&&t.l(l),e=H()},m(l,s){t&&t.m(l,s),U(l,e,s),n=!0},p(l,[s]){l[1]?t?(t.p(l,s),s&2&&I(t,1)):(t=ge(l),t.c(),I(t,1),t.m(e.parentNode,e)):t&&(pe(),S(t,1,1,()=>{t=null}),be())},i(l){n||(I(t),n=!0)},o(l){S(t),n=!1},d(l){l&&p(e),t&&t.d(l)}}}function We(a,e,n){let{loading:t=!1}=e,{account:l}=e,{drawerId:s}=e,r=0,o={name:"",type:"credit-card",sort_index:1},i,c;const f=(d,h)=>{const{value:q}=d.detail;if(o)switch(h){case"name":n(1,o.name=q,o);break;case"type":n(1,o.type=q,o);break;case"sort_index":n(1,o.sort_index=q,o);break}},v=()=>{const d=`[data-bs-target="#${s}"]`,h=document.querySelector(d);h&&(h.click(),n(8,l=void 0),n(10,r=void 0),n(1,o={name:"",type:"credit-card",sort_index:1}))},u=async()=>{const d=i.validateField(),h=c.validateField();if(d||h)return;const{actions:{reload:w,createAccount:m,updateAccount:C}}=ee();o.id?await C(o.id,o):await m(o),await w(),v()},D=async()=>{if(!o?.id)return;const{actions:{reload:d,deleteAccount:h}}=ee();ye({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async q=>{o?.id&&(q&&await h(o.id),await d(),v())}})};function k(d){X[d?"unshift":"push"](()=>{i=d,n(2,i)})}const T=d=>f(d,"name"),g=d=>f(d,"type");function b(d){X[d?"unshift":"push"](()=>{c=d,n(3,c)})}const E=d=>f(d,"sort_index");return a.$$set=d=>{"loading"in d&&n(0,t=d.loading),"account"in d&&n(8,l=d.account),"drawerId"in d&&n(9,s=d.drawerId)},a.$$.update=()=>{a.$$.dirty&1282&&(!l||r!==l?.id)&&(n(1,o=l?{...o,...l}:o),n(10,r=l?.id))},[t,o,i,c,f,v,u,D,l,s,r,k,T,g,b,E]}class Ze extends M{constructor(e){super(),J(this,e,We,Qe,z,{loading:0,account:8,drawerId:9})}}function _e(a,e,n){const t=a.slice();return t[6]=e[n],t}function he(a){let e,n=de(a[0]),t=[];for(let l=0;l<n.length;l+=1)t[l]=ve(_e(a,n,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=H()},l(l){for(let s=0;s<t.length;s+=1)t[s].l(l);e=H()},m(l,s){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(l,s);U(l,e,s)},p(l,s){if(s&7){n=de(l[0]);let r;for(r=0;r<n.length;r+=1){const o=_e(l,n,r);t[r]?t[r].p(o,s):(t[r]=ve(o),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=n.length}},d(l){l&&p(e),ke(t,l)}}}function ve(a){let e,n,t=a[6].name+"",l,s,r,o,i,c=a[6].type+"",f,v,u,D,k,T,g,b;function E(){return a[3](a[6])}return{c(){e=A("div"),n=A("div"),l=le(t),s=P(),r=A("div"),o=A("div"),i=A("div"),f=le(c),v=P(),u=A("button"),D=le("edit"),T=P(),this.h()},l(d){e=y(d,"DIV",{});var h=F(e);n=y(h,"DIV",{class:!0});var q=F(n);l=oe(q,t),q.forEach(p),s=L(h),r=y(h,"DIV",{class:!0});var w=F(r);o=y(w,"DIV",{class:!0});var m=F(o);i=y(m,"DIV",{class:!0});var C=F(i);f=oe(C,c),C.forEach(p),m.forEach(p),v=L(w),u=y(w,"BUTTON",{class:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var B=F(u);D=oe(B,"edit"),B.forEach(p),w.forEach(p),T=L(h),h.forEach(p),this.h()},h(){$(n,"class","fw-bold"),$(i,"class","fw-light"),$(o,"class","small"),$(u,"class","btn btn-sm btn-link ps-0"),$(u,"data-bs-toggle","offcanvas"),$(u,"data-bs-target",k="#"+a[1]),$(u,"aria-controls",a[1]),$(r,"class","d-flex justify-content-between")},m(d,h){U(d,e,h),_(e,n),_(n,l),_(e,s),_(e,r),_(r,o),_(o,i),_(i,f),_(r,v),_(r,u),_(u,D),_(e,T),g||(b=Q(u,"click",E),g=!0)},p(d,h){a=d,h&1&&t!==(t=a[6].name+"")&&ue(l,t),h&1&&c!==(c=a[6].type+"")&&ue(f,c),h&2&&k!==(k="#"+a[1])&&$(u,"data-bs-target",k),h&2&&$(u,"aria-controls",a[1])},d(d){d&&p(e),g=!1,b()}}}function xe(a){let e,n=a[0].length&&he(a);return{c(){n&&n.c(),e=H()},l(t){n&&n.l(t),e=H()},m(t,l){n&&n.m(t,l),U(t,e,l)},p(t,[l]){t[0].length?n?n.p(t,l):(n=he(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:x,o:x,d(t){t&&p(e),n&&n.d(t)}}}function et(a,e,n){let{data:t=[]}=e,{drawerId:l=""}=e;const{stores:{targetAccount:s,loading:r}}=ee(),o=c=>{r.set(!0),setTimeout(()=>{s.set(c),r.set(!1)},800)},i=c=>o(c);return a.$$set=c=>{"data"in c&&n(0,t=c.data),"drawerId"in c&&n(1,l=c.drawerId)},[t,l,o,i]}class tt extends M{constructor(e){super(),J(this,e,et,xe,z,{data:0,drawerId:1})}}function nt(a){let e,n;return e=new Ie({}),{c(){O(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){V(e,t,l),n=!0},p:x,i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function at(a){let e,n,t;function l(r){a[8](r)}let s={account:a[0],drawerId:G};return a[2]!==void 0&&(s.loading=a[2]),e=new Ze({props:s}),X.push(()=>ne(e,"loading",l)),{c(){O(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,o){V(e,r,o),t=!0},p(r,o){const i={};o&1&&(i.account=r[0]),!n&&o&4&&(n=!0,i.loading=r[2],te(()=>n=!1)),e.$set(i)},i(r){t||(I(e.$$.fragment,r),t=!0)},o(r){S(e.$$.fragment,r),t=!1},d(r){j(e,r)}}}function rt(a){let e,n,t,l;const s=[at,nt],r=[];function o(i,c){return i[2]?1:0}return e=o(a),n=r[e]=s[e](a),{c(){n.c(),t=H()},l(i){n.l(i),t=H()},m(i,c){r[e].m(i,c),U(i,t,c),l=!0},p(i,c){let f=e;e=o(i),e===f?r[e].p(i,c):(pe(),S(r[f],1,1,()=>{r[f]=null}),be(),n=r[e],n?n.p(i,c):(n=r[e]=s[e](i),n.c()),I(n,1),n.m(t.parentNode,t))},i(i){l||(I(n),l=!0)},o(i){S(n),l=!1},d(i){i&&p(t),r[e].d(i)}}}function lt(a){let e,n,t,l,s,r="Accounts",o,i,c,f,v,u,D,k,T;return e=new Te({props:{title:a[1],id:G,$$slots:{default:[rt]},$$scope:{ctx:a}}}),u=new tt({props:{drawerId:G,data:a[3]}}),{c(){O(e.$$.fragment),n=P(),t=A("div"),l=A("div"),s=A("h2"),s.textContent=r,o=P(),i=A("div"),c=A("button"),f=A("i"),v=P(),O(u.$$.fragment),this.h()},l(g){N(e.$$.fragment,g),n=L(g),t=y(g,"DIV",{class:!0});var b=F(t);l=y(b,"DIV",{class:!0});var E=F(l);s=y(E,"H2",{"data-svelte-h":!0}),Z(s)!=="svelte-f8ypd2"&&(s.textContent=r),o=L(E),i=y(E,"DIV",{});var d=F(i);c=y(d,"BUTTON",{class:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var h=F(c);f=y(h,"I",{class:!0}),F(f).forEach(p),h.forEach(p),d.forEach(p),E.forEach(p),v=L(b),N(u.$$.fragment,b),b.forEach(p),this.h()},h(){$(f,"class","bi bi-plus"),$(c,"class","btn btn-sm btn-secondary"),$(c,"data-bs-toggle","offcanvas"),$(c,"data-bs-target","#"+G),$(c,"aria-controls",G),$(l,"class","d-flex justify-content-between align-items-center"),$(t,"class","d-flex flex-column gap-3")},m(g,b){V(e,g,b),U(g,n,b),U(g,t,b),_(t,l),_(l,s),_(l,o),_(l,i),_(i,c),_(c,f),_(t,v),V(u,t,null),D=!0,k||(T=Q(c,"click",a[7]),k=!0)},p(g,[b]){const E={};b&2&&(E.title=g[1]),b&2053&&(E.$$scope={dirty:b,ctx:g}),e.$set(E);const d={};b&8&&(d.data=g[3]),u.$set(d)},i(g){D||(I(e.$$.fragment,g),I(u.$$.fragment,g),D=!0)},o(g){S(e.$$.fragment,g),S(u.$$.fragment,g),D=!1},d(g){g&&(p(n),p(t)),j(e,g),j(u),k=!1,T()}}}const G="account-form";function ot(a,e,n){let t,l,s,r;const{stores:{data:o,targetAccount:i,loading:c},actions:{reload:f}}=ee();se(a,o,k=>n(3,r=k)),se(a,i,k=>n(0,l=k)),se(a,c,k=>n(2,s=k));const v={name:"",type:"credit-card",sort_index:1};$e(()=>f());const u=()=>{c.set(!0),setTimeout(()=>{i.set(v),c.set(!1)},1500)};function D(k){s=k,c.set(s)}return a.$$.update=()=>{a.$$.dirty&1&&n(1,t=l?.id?"Edit Account":"Create Account")},[l,t,s,r,o,i,c,u,D]}class st extends M{constructor(e){super(),J(this,e,ot,lt,z,{})}}function it(a){let e,n;return e=new st({}),{c(){O(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){V(e,t,l),n=!0},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function ct(a){let e,n;return e=new Ae({props:{pageTitle:"Accounts",$$slots:{default:[it]},$$scope:{ctx:a}}}),{c(){O(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){V(e,t,l),n=!0},p(t,[l]){const s={};l&1&&(s.$$scope={dirty:l,ctx:t}),e.$set(s)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){S(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}class bt extends M{constructor(e){super(),J(this,e,null,ct,z,{})}}export{bt as component,pt as universal};
