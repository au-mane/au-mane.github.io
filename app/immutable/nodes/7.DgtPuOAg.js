import{s as Ie,r as qe,n as ze,h as we,b as Re,o as Fe}from"../chunks/scheduler.DyivmMiW.js";import{S as Te,i as Se,v as Me,o as q,t as X,x as Ye,a as $,w as Ge,d as y,e as b,s as P,b as be,c as ue,j as v,k as E,l as Z,f as O,m as ve,g as fe,n as m,y as W,q as f,C as ne,p as de,B as U,r as De,u as ce,D as Ke}from"../chunks/index.BqK79KpI.js";import{P as Je}from"../chunks/PageLayout.DaNfLRTD.js";import{e as Be}from"../chunks/supabase-config.DGP-irWd.js";import{g as Qe,f as ae,p as Y,c as We,u as Xe,a as Ze,d as xe,D as $e}from"../chunks/confirm.service.D8NKo1ly.js";import{S as et}from"../chunks/Spinner.BlcZoQhc.js";import{w as Le}from"../chunks/index.Cdixjbko.js";import{f as Ne}from"../chunks/app.state.DIzCX3o3.js";const tt=!0,Mt=Object.freeze(Object.defineProperty({__proto__:null,prerender:tt},Symbol.toStringTag,{value:"Module"})),ke={start_at:"",end_at:"",settings:{max_spend_limit:0}};let x=null;const st=()=>{const n=Le(!1),t=Le([]);return x={stores:{loading:n,data:t},actions:{reload:async()=>{n.set(!0);const e=await Qe();t.set(e),n.set(!1)}}},x},He=()=>x?.stores&&Object.keys(x.stores).length>0&&x?.actions&&Object.keys(x.actions).length>0?x:st();function Pe(n){let t,s,e,l="Start Date*",d,i,g,p,_,h,a="End Date*",u,r,I,T,S,N,z="Max Limit*",R,k,C,w,M,j,H=n[14].message+"",A,G,re,K,J,oe,ee,V,te,B,ie,me;J=new et({props:{size:"xs"}});let L=n[6]&&Oe(n);function _e(c,D){return c[6]?at:nt}let se=_e(n),F=se(n),o=n[15]&&Ae();return{c(){t=b("div"),s=b("div"),e=b("div"),e.textContent=l,d=P(),i=b("input"),p=P(),_=b("div"),h=b("div"),h.textContent=a,u=P(),r=b("input"),T=P(),S=b("div"),N=b("div"),N.textContent=z,R=P(),k=b("input"),w=P(),M=b("div"),j=b("small"),A=be(H),re=P(),K=b("span"),ue(J.$$.fragment),oe=P(),L&&L.c(),ee=P(),V=b("button"),F.c(),te=P(),o&&o.c(),this.h()},l(c){t=v(c,"DIV",{class:!0});var D=E(t);s=v(D,"DIV",{class:!0});var pe=E(s);e=v(pe,"DIV",{"data-svelte-h":!0}),Z(e)!=="svelte-172ibe4"&&(e.textContent=l),d=O(pe),i=v(pe,"INPUT",{name:!0,type:!0,class:!0}),pe.forEach(y),p=O(D),_=v(D,"DIV",{class:!0});var he=E(_);h=v(he,"DIV",{"data-svelte-h":!0}),Z(h)!=="svelte-1iotazt"&&(h.textContent=a),u=O(he),r=v(he,"INPUT",{name:!0,type:!0,class:!0}),he.forEach(y),T=O(D),S=v(D,"DIV",{class:!0});var ge=E(S);N=v(ge,"DIV",{"data-svelte-h":!0}),Z(N)!=="svelte-16dil7f"&&(N.textContent=z),R=O(ge),k=v(ge,"INPUT",{name:!0,type:!0,class:!0}),ge.forEach(y),w=O(D),M=v(D,"DIV",{class:!0});var Q=E(M);j=v(Q,"SMALL",{class:!0});var Ee=E(j);A=ve(Ee,H),Ee.forEach(y),re=O(Q),K=v(Q,"SPAN",{});var Ce=E(K);fe(J.$$.fragment,Ce),Ce.forEach(y),oe=O(Q),L&&L.l(Q),ee=O(Q),V=v(Q,"BUTTON",{class:!0});var ye=E(V);F.l(ye),te=O(ye),o&&o.l(ye),ye.forEach(y),Q.forEach(y),D.forEach(y),this.h()},h(){m(i,"name",g=n[1]+"-start-date"),m(i,"type","date"),m(i,"class","form-control"),i.disabled=n[10],i.required=!0,W(i,"is-invalid",n[8]),m(s,"class","d-flex flex-column gap-2"),m(r,"name",I=n[1]+"-end-date"),m(r,"type","date"),m(r,"class","form-control"),r.disabled=n[10],r.required=!0,W(r,"is-invalid",n[7]),m(_,"class","d-flex flex-column gap-2"),m(k,"name",C=n[1]+"-max-limit"),m(k,"type","text"),m(k,"class","form-control text-end"),k.disabled=n[10],k.required=!0,W(k,"is-invalid",n[9]),m(S,"class","d-flex flex-column gap-2"),m(j,"class",G="fw-lighter fst-italic text-"+n[14].type),W(K,"d-none",!n[10]),m(V,"class","btn btn-primary position-relative"),m(M,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),m(t,"class","d-flex flex-column gap-4")},m(c,D){q(c,t,D),f(t,s),f(s,e),f(s,d),f(s,i),n[21](i),ne(i,n[2]),f(t,p),f(t,_),f(_,h),f(_,u),f(_,r),n[25](r),ne(r,n[3]),f(t,T),f(t,S),f(S,N),f(S,R),f(S,k),n[29](k),ne(k,n[4]),f(t,w),f(t,M),f(M,j),f(j,A),f(M,re),f(M,K),de(J,K,null),f(M,oe),L&&L.m(M,null),f(M,ee),f(M,V),F.m(V,null),f(V,te),o&&o.m(V,null),B=!0,ie||(me=[U(i,"focus",n[22]),U(i,"keyup",n[23]),U(i,"input",n[24]),U(r,"focus",n[26]),U(r,"keyup",n[27]),U(r,"input",n[28]),U(k,"focus",n[30]),U(k,"keyup",n[31]),U(k,"input",n[32]),U(V,"click",n[17])],ie=!0)},p(c,D){(!B||D[0]&2&&g!==(g=c[1]+"-start-date"))&&m(i,"name",g),(!B||D[0]&1024)&&(i.disabled=c[10]),D[0]&4&&ne(i,c[2]),(!B||D[0]&256)&&W(i,"is-invalid",c[8]),(!B||D[0]&2&&I!==(I=c[1]+"-end-date"))&&m(r,"name",I),(!B||D[0]&1024)&&(r.disabled=c[10]),D[0]&8&&ne(r,c[3]),(!B||D[0]&128)&&W(r,"is-invalid",c[7]),(!B||D[0]&2&&C!==(C=c[1]+"-max-limit"))&&m(k,"name",C),(!B||D[0]&1024)&&(k.disabled=c[10]),D[0]&16&&k.value!==c[4]&&ne(k,c[4]),(!B||D[0]&512)&&W(k,"is-invalid",c[9]),(!B||D[0]&16384)&&H!==(H=c[14].message+"")&&De(A,H),(!B||D[0]&16384&&G!==(G="fw-lighter fst-italic text-"+c[14].type))&&m(j,"class",G),(!B||D[0]&1024)&&W(K,"d-none",!c[10]),c[6]?L?L.p(c,D):(L=Oe(c),L.c(),L.m(M,ee)):L&&(L.d(1),L=null),se!==(se=_e(c))&&(F.d(1),F=se(c),F&&(F.c(),F.m(V,te))),c[15]?o||(o=Ae(),o.c(),o.m(V,null)):o&&(o.d(1),o=null)},i(c){B||(X(J.$$.fragment,c),B=!0)},o(c){$(J.$$.fragment,c),B=!1},d(c){c&&y(t),n[21](null),n[25](null),n[29](null),ce(J),L&&L.d(),F.d(),o&&o.d(),ie=!1,qe(me)}}}function Oe(n){let t,s="<span>Delete</span>",e,l;return{c(){t=b("button"),t.innerHTML=s,this.h()},l(d){t=v(d,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-4hjfsp"&&(t.innerHTML=s),this.h()},h(){m(t,"class","btn btn-danger position-relative")},m(d,i){q(d,t,i),e||(l=U(t,"click",n[16]),e=!0)},p:ze,d(d){d&&y(t),e=!1,l()}}}function nt(n){let t,s="Create";return{c(){t=b("span"),t.textContent=s},l(e){t=v(e,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1wf0js6"&&(t.textContent=s)},m(e,l){q(e,t,l)},d(e){e&&y(t)}}}function at(n){let t,s="Save";return{c(){t=b("span"),t.textContent=s},l(e){t=v(e,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-l126tb"&&(t.textContent=s)},m(e,l){q(e,t,l)},d(e){e&&y(t)}}}function Ae(n){let t,s='<span class="visually-hidden">Item not saved</span>';return{c(){t=b("span"),t.innerHTML=s,this.h()},l(e){t=v(e,"SPAN",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1sxrz4i"&&(t.innerHTML=s),this.h()},h(){m(t,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(e,l){q(e,t,l)},d(e){e&&y(t)}}}function lt(n){let t,s,e=n[0]&&Pe(n);return{c(){e&&e.c(),t=Me()},l(l){e&&e.l(l),t=Me()},m(l,d){e&&e.m(l,d),q(l,t,d),s=!0},p(l,d){l[0]?e?(e.p(l,d),d[0]&1&&X(e,1)):(e=Pe(l),e.c(),X(e,1),e.m(t.parentNode,t)):e&&(Ye(),$(e,1,1,()=>{e=null}),Ge())},i(l){s||(X(e),s=!0)},o(l){$(e),s=!1},d(l){l&&y(t),e&&e.d(l)}}}function rt(n,t,s){let e,l,d,i,g,p,{name:_=""}=t,{drawerId:h=""}=t,{budget:a}=t;const{actions:{reload:u}}=He();let r=!1,I,T,S,N=0,z,R,k,C={message:"",type:"info"},w,M={startDate:!1,endDate:!1,amount:!1};const j=()=>{const o=`[data-bs-target="#${h}"]`,c=document.querySelector(o);c&&c.click()},H=()=>{s(5,M={amount:!1,startDate:!1,endDate:!1}),s(0,a={...ke}),s(10,r=!1)},A=(o,c=0,D="info")=>{s(14,C.message=o,C),s(14,C.type=D,C),c&&setTimeout(()=>{s(14,C.message="",C)},c)},G=async()=>{if(!e){A("ID is not defined",0,"danger");return}try{await xe(e),await u(!0),setTimeout(()=>{s(10,r=!1),s(20,w={...a,id:e,start_at:Y(I,"yyyy-MM-dd",new Date).toISOString(),end_at:Y(T,"yyyy-MM-dd",new Date).toISOString()}),A("Transaction Deleted",3e3,"success"),j()},800)}catch(o){setTimeout(()=>{s(10,r=!1),console.error("Save failed:",o),A("Failed to save event. Please try again.",7e3,"danger")},800)}},re=()=>{s(10,r=!0),We({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async o=>{o&&await G(),await u(!0),H()}})},K=async()=>{if(!l){A("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!p){let o=[];g&&o.push("Amount is invalid"),d&&o.push("Start date is invalid"),i&&o.push("End date is invalid"),A(o.join(". ")+".  Please address accordingly.",0,"danger");return}if(!r){A("Saving ..."),s(10,r=!0);try{const o={...a,start_at:Y(I,"yyyy-MM-dd",new Date).toISOString(),end_at:Y(T,"yyyy-MM-dd",new Date).toISOString(),settings:{...a.settings,max_spend_limit:S}};e?await Xe(e,o):await Ze(o),await u(!0),setTimeout(()=>{s(10,r=!1),s(20,w={...a,id:e}),A("Saved",3e3,"success"),e||H(),j()},800)}catch(o){setTimeout(()=>{s(10,r=!1),console.error("Save failed:",o),A("Failed to save event. Please try again.",7e3,"danger"),e||H()},800)}}};function J(o){we[o?"unshift":"push"](()=>{z=o,s(11,z)})}const oe=()=>z.select(),ee=()=>s(5,M.startDate=!0,M);function V(){I=this.value,s(2,I),s(6,e),s(0,a),s(19,N)}function te(o){we[o?"unshift":"push"](()=>{R=o,s(12,R)})}const B=()=>R.select(),ie=()=>s(5,M.endDate=!0,M);function me(){T=this.value,s(3,T),s(6,e),s(0,a),s(19,N)}function L(o){we[o?"unshift":"push"](()=>{k=o,s(13,k)})}const _e=()=>k.select(),se=()=>s(5,M.amount=!0,M);function F(){S=this.value,s(4,S),s(6,e),s(0,a),s(19,N)}return n.$$set=o=>{"name"in o&&s(1,_=o.name),"drawerId"in o&&s(18,h=o.drawerId),"budget"in o&&s(0,a=o.budget)},n.$$.update=()=>{n.$$.dirty[0]&1&&s(6,e=a?.id),n.$$.dirty[0]&524353&&e&&a&&N!==e&&(s(10,r=!0),setTimeout(()=>{s(20,w={...a}),s(19,N=e),s(4,S=a.settings?.max_spend_limit??0),s(2,I=ae(Y(a.start_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(3,T=ae(Y(a.end_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(10,r=!1)},800)),n.$$.dirty[0]&1048604&&s(15,l=w?.start_at!==I||w?.end_at!==T||w?.settings?.max_spend_limit!==S),n.$$.dirty[0]&33&&s(8,d=M.startDate&&a?.start_at===""),n.$$.dirty[0]&33&&s(7,i=M.endDate&&a?.end_at===""),n.$$.dirty[0]&33&&s(9,g=M.amount&&a?.settings?.max_spend_limit===0),n.$$.dirty[0]&896&&(p=!d&&!i&&!g)},[a,_,I,T,S,M,e,i,d,g,r,z,R,k,C,l,re,K,h,N,w,J,oe,ee,V,te,B,ie,me,L,_e,se,F]}class ot extends Te{constructor(t){super(),Se(this,t,rt,lt,Ie,{name:1,drawerId:18,budget:0},null,[-1,-1])}}function je(n,t,s){const e=n.slice();return e[7]=t[s],e}function it(n){let t,s;return t=new ot({props:{name:"budget-form",drawerId:le,budget:n[0]}}),{c(){ue(t.$$.fragment)},l(e){fe(t.$$.fragment,e)},m(e,l){de(t,e,l),s=!0},p(e,l){const d={};l&1&&(d.budget=e[0]),t.$set(d)},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){$(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}function Ve(n){let t,s,e,l='<tr><th scope="col" class="fw-light text-muted">Start</th> <th scope="col" class="fw-light text-muted">End</th> <th scope="col" class="text-end">Max Limit</th> <th scope="col"></th></tr>',d,i,g=Be(n[1]),p=[];for(let _=0;_<g.length;_+=1)p[_]=Ue(je(n,g,_));return{c(){t=b("div"),s=b("table"),e=b("thead"),e.innerHTML=l,d=P(),i=b("tbody");for(let _=0;_<p.length;_+=1)p[_].c();this.h()},l(_){t=v(_,"DIV",{class:!0});var h=E(t);s=v(h,"TABLE",{class:!0});var a=E(s);e=v(a,"THEAD",{"data-svelte-h":!0}),Z(e)!=="svelte-z1hzd2"&&(e.innerHTML=l),d=O(a),i=v(a,"TBODY",{});var u=E(i);for(let r=0;r<p.length;r+=1)p[r].l(u);u.forEach(y),a.forEach(y),h.forEach(y),this.h()},h(){m(s,"class","table"),m(t,"class","table-responsive")},m(_,h){q(_,t,h),f(t,s),f(s,e),f(s,d),f(s,i);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(i,null)},p(_,h){if(h&10){g=Be(_[1]);let a;for(a=0;a<g.length;a+=1){const u=je(_,g,a);p[a]?p[a].p(u,h):(p[a]=Ue(u),p[a].c(),p[a].m(i,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=g.length}},d(_){_&&y(t),Ke(p,_)}}}function Ue(n){let t,s,e=ae(Y(n[7].start_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"",l,d,i,g=ae(Y(n[7].end_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"",p,_,h,a=Ne(n[7]?.settings?.max_spend_limit)+"",u,r,I,T,S,N,z,R;function k(){return n[5](n[7])}return{c(){t=b("tr"),s=b("td"),l=be(e),d=P(),i=b("td"),p=be(g),_=P(),h=b("td"),u=be(a),r=P(),I=b("td"),T=b("button"),S=b("i"),N=P(),this.h()},l(C){t=v(C,"TR",{});var w=E(t);s=v(w,"TD",{class:!0});var M=E(s);l=ve(M,e),M.forEach(y),d=O(w),i=v(w,"TD",{class:!0});var j=E(i);p=ve(j,g),j.forEach(y),_=O(w),h=v(w,"TD",{class:!0});var H=E(h);u=ve(H,a),H.forEach(y),r=O(w),I=v(w,"TD",{class:!0});var A=E(I);T=v(A,"BUTTON",{"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0,class:!0});var G=E(T);S=v(G,"I",{class:!0}),E(S).forEach(y),G.forEach(y),A.forEach(y),N=O(w),w.forEach(y),this.h()},h(){m(s,"class","fw-light text-muted"),m(i,"class","fw-light text-muted"),m(h,"class","text-end"),m(S,"class","bi bi-pencil"),m(T,"data-bs-toggle","offcanvas"),m(T,"data-bs-target","#"+le),m(T,"aria-controls",le),m(T,"class","btn btn-sm btn-primary"),m(I,"class","d-flex justify-content-end")},m(C,w){q(C,t,w),f(t,s),f(s,l),f(t,d),f(t,i),f(i,p),f(t,_),f(t,h),f(h,u),f(t,r),f(t,I),f(I,T),f(T,S),f(t,N),z||(R=U(T,"click",k),z=!0)},p(C,w){n=C,w&2&&e!==(e=ae(Y(n[7].start_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"")&&De(l,e),w&2&&g!==(g=ae(Y(n[7].end_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"")&&De(p,g),w&2&&a!==(a=Ne(n[7]?.settings?.max_spend_limit)+"")&&De(u,a)},d(C){C&&y(t),z=!1,R()}}}function ut(n){let t,s,e,l,d,i,g,p,_,h;t=new $e({props:{title:"Drawer Title",id:le,$$slots:{default:[it]},$$scope:{ctx:n}}});let a=n[1].length&&Ve(n);return{c(){ue(t.$$.fragment),s=P(),e=b("div"),l=b("button"),d=b("i"),i=P(),a&&a.c(),g=Me(),this.h()},l(u){fe(t.$$.fragment,u),s=O(u),e=v(u,"DIV",{class:!0});var r=E(e);l=v(r,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var I=E(l);d=v(I,"I",{class:!0}),E(d).forEach(y),I.forEach(y),r.forEach(y),i=O(u),a&&a.l(u),g=Me(),this.h()},h(){m(d,"class","bi bi-plus"),m(l,"class","btn btn-sm btn-secondary"),m(l,"type","button"),m(l,"data-bs-toggle","offcanvas"),m(l,"data-bs-target","#"+le),m(l,"aria-controls",le),m(e,"class","d-flex justify-content-end")},m(u,r){de(t,u,r),q(u,s,r),q(u,e,r),f(e,l),f(l,d),q(u,i,r),a&&a.m(u,r),q(u,g,r),p=!0,_||(h=U(l,"click",n[4]),_=!0)},p(u,[r]){const I={};r&1025&&(I.$$scope={dirty:r,ctx:u}),t.$set(I),u[1].length?a?a.p(u,r):(a=Ve(u),a.c(),a.m(g.parentNode,g)):a&&(a.d(1),a=null)},i(u){p||(X(t.$$.fragment,u),p=!0)},o(u){$(t.$$.fragment,u),p=!1},d(u){u&&(y(s),y(e),y(i),y(g)),ce(t,u),a&&a.d(u),_=!1,h()}}}const le="budgets-form";function ft(n,t,s){let e;const{stores:{data:l},actions:{reload:d}}=He();Re(n,l,h=>s(1,e=h));let i=ke;const g=h=>{s(0,i=h)};return Fe(()=>d(!0)),[i,e,l,g,()=>g({...ke}),h=>g({...h})]}class dt extends Te{constructor(t){super(),Se(this,t,ft,ut,Ie,{})}}function ct(n){let t,s;return t=new dt({}),{c(){ue(t.$$.fragment)},l(e){fe(t.$$.fragment,e)},m(e,l){de(t,e,l),s=!0},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){$(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}function mt(n){let t,s;return t=new Je({props:{pageTitle:"Budgets",$$slots:{default:[ct]},$$scope:{ctx:n}}}),{c(){ue(t.$$.fragment)},l(e){fe(t.$$.fragment,e)},m(e,l){de(t,e,l),s=!0},p(e,[l]){const d={};l&1&&(d.$$scope={dirty:l,ctx:e}),t.$set(d)},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){$(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}class wt extends Te{constructor(t){super(),Se(this,t,null,mt,Ie,{})}}export{wt as component,Mt as universal};
