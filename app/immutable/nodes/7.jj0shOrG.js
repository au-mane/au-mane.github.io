import{s as ke,r as qe,n as ze,h as we,b as Fe,o as Re}from"../chunks/scheduler.DyivmMiW.js";import{S as Ie,i as Se,v as Me,o as q,t as X,x as Ye,a as $,w as Ge,d as h,e as y,s as P,b as be,c as ue,j as b,k as E,l as Z,f as O,m as ve,g as fe,n as _,y as W,q as d,C as ne,p as de,B as U,r as De,u as ce,D as Ke}from"../chunks/index.BqK79KpI.js";import{P as Je}from"../chunks/PageLayout.DaNfLRTD.js";import{e as Be}from"../chunks/supabase-config.DGP-irWd.js";import{g as Qe,f as ae,p as Y,c as We,u as Xe,a as Ze,d as xe,D as $e}from"../chunks/confirm.service.D8NKo1ly.js";import{S as et}from"../chunks/Spinner.BlcZoQhc.js";import{w as Le}from"../chunks/index.Cdixjbko.js";import{f as Ne}from"../chunks/app.state.DIzCX3o3.js";const tt=!0,Mt=Object.freeze(Object.defineProperty({__proto__:null,prerender:tt},Symbol.toStringTag,{value:"Module"})),Te={start_at:"",end_at:"",settings:{max_spend_limit:0}};let x=null;const st=()=>{const n=Le(!1),t=Le([]);return x={stores:{loading:n,data:t},actions:{reload:async()=>{n.set(!0);const e=await Qe();t.set(e),n.set(!1)}}},x},He=()=>x?.stores&&Object.keys(x.stores).length>0&&x?.actions&&Object.keys(x.actions).length>0?x:st();function Pe(n){let t,s,e,l="Start Date*",f,i,g,p,c,v,a="End Date*",u,r,T,I,S,N,z="Max Limit*",F,k,C,w,M,j,H=n[14].message+"",A,G,re,K,J,oe,ee,V,te,B,ie,me;J=new et({props:{size:"xs"}});let L=n[6]&&Oe(n);function _e(m,D){return m[6]?at:nt}let se=_e(n),R=se(n),o=n[15]&&Ae();return{c(){t=y("div"),s=y("div"),e=y("div"),e.textContent=l,f=P(),i=y("input"),p=P(),c=y("div"),v=y("div"),v.textContent=a,u=P(),r=y("input"),I=P(),S=y("div"),N=y("div"),N.textContent=z,F=P(),k=y("input"),w=P(),M=y("div"),j=y("small"),A=be(H),re=P(),K=y("span"),ue(J.$$.fragment),oe=P(),L&&L.c(),ee=P(),V=y("button"),R.c(),te=P(),o&&o.c(),this.h()},l(m){t=b(m,"DIV",{class:!0});var D=E(t);s=b(D,"DIV",{class:!0});var pe=E(s);e=b(pe,"DIV",{"data-svelte-h":!0}),Z(e)!=="svelte-172ibe4"&&(e.textContent=l),f=O(pe),i=b(pe,"INPUT",{name:!0,type:!0,class:!0}),pe.forEach(h),p=O(D),c=b(D,"DIV",{class:!0});var ge=E(c);v=b(ge,"DIV",{"data-svelte-h":!0}),Z(v)!=="svelte-1iotazt"&&(v.textContent=a),u=O(ge),r=b(ge,"INPUT",{name:!0,type:!0,class:!0}),ge.forEach(h),I=O(D),S=b(D,"DIV",{class:!0});var he=E(S);N=b(he,"DIV",{"data-svelte-h":!0}),Z(N)!=="svelte-16dil7f"&&(N.textContent=z),F=O(he),k=b(he,"INPUT",{name:!0,type:!0,class:!0}),he.forEach(h),w=O(D),M=b(D,"DIV",{class:!0});var Q=E(M);j=b(Q,"SMALL",{class:!0});var Ee=E(j);A=ve(Ee,H),Ee.forEach(h),re=O(Q),K=b(Q,"SPAN",{});var Ce=E(K);fe(J.$$.fragment,Ce),Ce.forEach(h),oe=O(Q),L&&L.l(Q),ee=O(Q),V=b(Q,"BUTTON",{class:!0});var ye=E(V);R.l(ye),te=O(ye),o&&o.l(ye),ye.forEach(h),Q.forEach(h),D.forEach(h),this.h()},h(){_(i,"name",g=n[1]+"-start-date"),_(i,"type","date"),_(i,"class","form-control"),i.disabled=n[10],i.required=!0,W(i,"is-invalid",n[8]),_(s,"class","d-flex flex-column gap-2"),_(r,"name",T=n[1]+"-end-date"),_(r,"type","date"),_(r,"class","form-control"),r.disabled=n[10],r.required=!0,W(r,"is-invalid",n[7]),_(c,"class","d-flex flex-column gap-2"),_(k,"name",C=n[1]+"-max-limit"),_(k,"type","text"),_(k,"class","form-control text-end"),k.disabled=n[10],k.required=!0,W(k,"is-invalid",n[9]),_(S,"class","d-flex flex-column gap-2"),_(j,"class",G="fw-lighter fst-italic text-"+n[14].type),W(K,"d-none",!n[10]),_(V,"class","btn btn-primary position-relative"),_(M,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),_(t,"class","d-flex flex-column gap-4")},m(m,D){q(m,t,D),d(t,s),d(s,e),d(s,f),d(s,i),n[21](i),ne(i,n[2]),d(t,p),d(t,c),d(c,v),d(c,u),d(c,r),n[25](r),ne(r,n[3]),d(t,I),d(t,S),d(S,N),d(S,F),d(S,k),n[29](k),ne(k,n[4]),d(t,w),d(t,M),d(M,j),d(j,A),d(M,re),d(M,K),de(J,K,null),d(M,oe),L&&L.m(M,null),d(M,ee),d(M,V),R.m(V,null),d(V,te),o&&o.m(V,null),B=!0,ie||(me=[U(i,"focus",n[22]),U(i,"keyup",n[23]),U(i,"input",n[24]),U(r,"focus",n[26]),U(r,"keyup",n[27]),U(r,"input",n[28]),U(k,"focus",n[30]),U(k,"keyup",n[31]),U(k,"input",n[32]),U(V,"click",n[17])],ie=!0)},p(m,D){(!B||D[0]&2&&g!==(g=m[1]+"-start-date"))&&_(i,"name",g),(!B||D[0]&1024)&&(i.disabled=m[10]),D[0]&4&&ne(i,m[2]),(!B||D[0]&256)&&W(i,"is-invalid",m[8]),(!B||D[0]&2&&T!==(T=m[1]+"-end-date"))&&_(r,"name",T),(!B||D[0]&1024)&&(r.disabled=m[10]),D[0]&8&&ne(r,m[3]),(!B||D[0]&128)&&W(r,"is-invalid",m[7]),(!B||D[0]&2&&C!==(C=m[1]+"-max-limit"))&&_(k,"name",C),(!B||D[0]&1024)&&(k.disabled=m[10]),D[0]&16&&k.value!==m[4]&&ne(k,m[4]),(!B||D[0]&512)&&W(k,"is-invalid",m[9]),(!B||D[0]&16384)&&H!==(H=m[14].message+"")&&De(A,H),(!B||D[0]&16384&&G!==(G="fw-lighter fst-italic text-"+m[14].type))&&_(j,"class",G),(!B||D[0]&1024)&&W(K,"d-none",!m[10]),m[6]?L?L.p(m,D):(L=Oe(m),L.c(),L.m(M,ee)):L&&(L.d(1),L=null),se!==(se=_e(m))&&(R.d(1),R=se(m),R&&(R.c(),R.m(V,te))),m[15]?o||(o=Ae(),o.c(),o.m(V,null)):o&&(o.d(1),o=null)},i(m){B||(X(J.$$.fragment,m),B=!0)},o(m){$(J.$$.fragment,m),B=!1},d(m){m&&h(t),n[21](null),n[25](null),n[29](null),ce(J),L&&L.d(),R.d(),o&&o.d(),ie=!1,qe(me)}}}function Oe(n){let t,s="<span>Delete</span>",e,l;return{c(){t=y("button"),t.innerHTML=s,this.h()},l(f){t=b(f,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-4hjfsp"&&(t.innerHTML=s),this.h()},h(){_(t,"class","btn btn-danger position-relative")},m(f,i){q(f,t,i),e||(l=U(t,"click",n[16]),e=!0)},p:ze,d(f){f&&h(t),e=!1,l()}}}function nt(n){let t,s="Create";return{c(){t=y("span"),t.textContent=s},l(e){t=b(e,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1wf0js6"&&(t.textContent=s)},m(e,l){q(e,t,l)},d(e){e&&h(t)}}}function at(n){let t,s="Save";return{c(){t=y("span"),t.textContent=s},l(e){t=b(e,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-l126tb"&&(t.textContent=s)},m(e,l){q(e,t,l)},d(e){e&&h(t)}}}function Ae(n){let t,s='<span class="visually-hidden">Item not saved</span>';return{c(){t=y("span"),t.innerHTML=s,this.h()},l(e){t=b(e,"SPAN",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1sxrz4i"&&(t.innerHTML=s),this.h()},h(){_(t,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(e,l){q(e,t,l)},d(e){e&&h(t)}}}function lt(n){let t,s,e=n[0]&&Pe(n);return{c(){e&&e.c(),t=Me()},l(l){e&&e.l(l),t=Me()},m(l,f){e&&e.m(l,f),q(l,t,f),s=!0},p(l,f){l[0]?e?(e.p(l,f),f[0]&1&&X(e,1)):(e=Pe(l),e.c(),X(e,1),e.m(t.parentNode,t)):e&&(Ye(),$(e,1,1,()=>{e=null}),Ge())},i(l){s||(X(e),s=!0)},o(l){$(e),s=!1},d(l){l&&h(t),e&&e.d(l)}}}function rt(n,t,s){let e,l,f,i,g,p,{name:c=""}=t,{drawerId:v=""}=t,{budget:a}=t;const{actions:{reload:u}}=He();let r=!1,T,I,S,N=0,z,F,k,C={message:"",type:"info"},w,M={startDate:!1,endDate:!1,amount:!1};const j=()=>{const o=`[data-bs-target="#${v}"]`,m=document.querySelector(o);m&&m.click()},H=()=>{s(5,M={amount:!1,startDate:!1,endDate:!1}),s(0,a={...Te}),s(10,r=!1)},A=(o,m=0,D="info")=>{s(14,C.message=o,C),s(14,C.type=D,C),m&&setTimeout(()=>{s(14,C.message="",C)},m)},G=async()=>{if(!e){A("ID is not defined",0,"danger");return}try{await xe(e),await u(!0),setTimeout(()=>{s(10,r=!1),s(20,w={...a,id:e,start_at:Y(T,"yyyy-MM-dd",new Date).toISOString(),end_at:Y(I,"yyyy-MM-dd",new Date).toISOString()}),A("Transaction Deleted",3e3,"success"),j()},800)}catch(o){setTimeout(()=>{s(10,r=!1),console.error("Save failed:",o),A("Failed to save event. Please try again.",7e3,"danger")},800)}},re=()=>{s(10,r=!0),We({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async o=>{o&&await G(),await u(!0),H()}})},K=async()=>{if(!l){A("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!p){let o=[];g&&o.push("Amount is invalid"),f&&o.push("Start date is invalid"),i&&o.push("End date is invalid"),A(o.join(". ")+".  Please address accordingly.",0,"danger");return}if(!r){A("Saving ..."),s(10,r=!0);try{const o={...a,start_at:Y(T,"yyyy-MM-dd",new Date).toISOString(),end_at:Y(I,"yyyy-MM-dd",new Date).toISOString(),settings:{...a.settings,max_spend_limit:S}};e?await Xe(e,o):await Ze(o),await u(!0),setTimeout(()=>{s(10,r=!1),s(20,w={...a,id:e}),A("Saved",3e3,"success"),e||H(),j()},800)}catch(o){setTimeout(()=>{s(10,r=!1),console.error("Save failed:",o),A("Failed to save event. Please try again.",7e3,"danger"),e||H()},800)}}};function J(o){we[o?"unshift":"push"](()=>{z=o,s(11,z)})}const oe=()=>z.select(),ee=()=>s(5,M.startDate=!0,M);function V(){T=this.value,s(2,T),s(6,e),s(0,a),s(19,N)}function te(o){we[o?"unshift":"push"](()=>{F=o,s(12,F)})}const B=()=>F.select(),ie=()=>s(5,M.endDate=!0,M);function me(){I=this.value,s(3,I),s(6,e),s(0,a),s(19,N)}function L(o){we[o?"unshift":"push"](()=>{k=o,s(13,k)})}const _e=()=>k.select(),se=()=>s(5,M.amount=!0,M);function R(){S=this.value,s(4,S),s(6,e),s(0,a),s(19,N)}return n.$$set=o=>{"name"in o&&s(1,c=o.name),"drawerId"in o&&s(18,v=o.drawerId),"budget"in o&&s(0,a=o.budget)},n.$$.update=()=>{n.$$.dirty[0]&1&&s(6,e=a?.id),n.$$.dirty[0]&524353&&e&&a&&N!==e&&(s(10,r=!0),setTimeout(()=>{s(20,w={...a}),s(19,N=e),s(4,S=a.settings?.max_spend_limit??0),s(2,T=ae(Y(a.start_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(3,I=ae(Y(a.end_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(10,r=!1)},800)),n.$$.dirty[0]&1048604&&s(15,l=w?.start_at!==T||w?.end_at!==I||w?.settings?.max_spend_limit!==S),n.$$.dirty[0]&33&&s(8,f=M.startDate&&a?.start_at===""),n.$$.dirty[0]&33&&s(7,i=M.endDate&&a?.end_at===""),n.$$.dirty[0]&33&&s(9,g=M.amount&&a?.settings?.max_spend_limit===0),n.$$.dirty[0]&896&&(p=!f&&!i&&!g)},[a,c,T,I,S,M,e,i,f,g,r,z,F,k,C,l,re,K,v,N,w,J,oe,ee,V,te,B,ie,me,L,_e,se,R]}class ot extends Ie{constructor(t){super(),Se(this,t,rt,lt,ke,{name:1,drawerId:18,budget:0},null,[-1,-1])}}function je(n,t,s){const e=n.slice();return e[8]=t[s],e}function it(n){let t,s;return t=new ot({props:{name:"budget-form",drawerId:le,budget:n[0]}}),{c(){ue(t.$$.fragment)},l(e){fe(t.$$.fragment,e)},m(e,l){de(t,e,l),s=!0},p(e,l){const f={};l&1&&(f.budget=e[0]),t.$set(f)},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){$(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}function Ve(n){let t,s,e,l='<tr><th scope="col" class="fw-light text-muted">Start</th> <th scope="col" class="fw-light text-muted">End</th> <th scope="col" class="text-end">Max Limit</th> <th scope="col"></th></tr>',f,i,g=Be(n[2]),p=[];for(let c=0;c<g.length;c+=1)p[c]=Ue(je(n,g,c));return{c(){t=y("div"),s=y("table"),e=y("thead"),e.innerHTML=l,f=P(),i=y("tbody");for(let c=0;c<p.length;c+=1)p[c].c();this.h()},l(c){t=b(c,"DIV",{class:!0});var v=E(t);s=b(v,"TABLE",{class:!0});var a=E(s);e=b(a,"THEAD",{"data-svelte-h":!0}),Z(e)!=="svelte-z1hzd2"&&(e.innerHTML=l),f=O(a),i=b(a,"TBODY",{});var u=E(i);for(let r=0;r<p.length;r+=1)p[r].l(u);u.forEach(h),a.forEach(h),v.forEach(h),this.h()},h(){_(s,"class","table"),_(t,"class","table-responsive")},m(c,v){q(c,t,v),d(t,s),d(s,e),d(s,f),d(s,i);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(i,null)},p(c,v){if(v&20){g=Be(c[2]);let a;for(a=0;a<g.length;a+=1){const u=je(c,g,a);p[a]?p[a].p(u,v):(p[a]=Ue(u),p[a].c(),p[a].m(i,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=g.length}},d(c){c&&h(t),Ke(p,c)}}}function Ue(n){let t,s,e=ae(Y(n[8].start_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"",l,f,i,g=ae(Y(n[8].end_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"",p,c,v,a=Ne(n[8]?.settings?.max_spend_limit)+"",u,r,T,I,S,N,z,F;function k(){return n[6](n[8])}return{c(){t=y("tr"),s=y("td"),l=be(e),f=P(),i=y("td"),p=be(g),c=P(),v=y("td"),u=be(a),r=P(),T=y("td"),I=y("button"),S=y("i"),N=P(),this.h()},l(C){t=b(C,"TR",{});var w=E(t);s=b(w,"TD",{class:!0});var M=E(s);l=ve(M,e),M.forEach(h),f=O(w),i=b(w,"TD",{class:!0});var j=E(i);p=ve(j,g),j.forEach(h),c=O(w),v=b(w,"TD",{class:!0});var H=E(v);u=ve(H,a),H.forEach(h),r=O(w),T=b(w,"TD",{class:!0});var A=E(T);I=b(A,"BUTTON",{"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0,class:!0});var G=E(I);S=b(G,"I",{class:!0}),E(S).forEach(h),G.forEach(h),A.forEach(h),N=O(w),w.forEach(h),this.h()},h(){_(s,"class","fw-light text-muted"),_(i,"class","fw-light text-muted"),_(v,"class","text-end"),_(S,"class","bi bi-pencil"),_(I,"data-bs-toggle","offcanvas"),_(I,"data-bs-target","#"+le),_(I,"aria-controls",le),_(I,"class","btn btn-sm btn-primary"),_(T,"class","d-flex justify-content-end")},m(C,w){q(C,t,w),d(t,s),d(s,l),d(t,f),d(t,i),d(i,p),d(t,c),d(t,v),d(v,u),d(t,r),d(t,T),d(T,I),d(I,S),d(t,N),z||(F=U(I,"click",k),z=!0)},p(C,w){n=C,w&4&&e!==(e=ae(Y(n[8].start_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"")&&De(l,e),w&4&&g!==(g=ae(Y(n[8].end_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"")&&De(p,g),w&4&&a!==(a=Ne(n[8]?.settings?.max_spend_limit)+"")&&De(u,a)},d(C){C&&h(t),z=!1,F()}}}function ut(n){let t,s,e,l,f,i,g,p,c,v;t=new $e({props:{title:n[1],id:le,$$slots:{default:[it]},$$scope:{ctx:n}}});let a=n[2].length&&Ve(n);return{c(){ue(t.$$.fragment),s=P(),e=y("div"),l=y("button"),f=y("i"),i=P(),a&&a.c(),g=Me(),this.h()},l(u){fe(t.$$.fragment,u),s=O(u),e=b(u,"DIV",{class:!0});var r=E(e);l=b(r,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var T=E(l);f=b(T,"I",{class:!0}),E(f).forEach(h),T.forEach(h),r.forEach(h),i=O(u),a&&a.l(u),g=Me(),this.h()},h(){_(f,"class","bi bi-plus"),_(l,"class","btn btn-sm btn-secondary"),_(l,"type","button"),_(l,"data-bs-toggle","offcanvas"),_(l,"data-bs-target","#"+le),_(l,"aria-controls",le),_(e,"class","d-flex justify-content-end")},m(u,r){de(t,u,r),q(u,s,r),q(u,e,r),d(e,l),d(l,f),q(u,i,r),a&&a.m(u,r),q(u,g,r),p=!0,c||(v=U(l,"click",n[5]),c=!0)},p(u,[r]){const T={};r&2&&(T.title=u[1]),r&2049&&(T.$$scope={dirty:r,ctx:u}),t.$set(T),u[2].length?a?a.p(u,r):(a=Ve(u),a.c(),a.m(g.parentNode,g)):a&&(a.d(1),a=null)},i(u){p||(X(t.$$.fragment,u),p=!0)},o(u){$(t.$$.fragment,u),p=!1},d(u){u&&(h(s),h(e),h(i),h(g)),ce(t,u),a&&a.d(u),c=!1,v()}}}const le="budgets-form";function ft(n,t,s){let e,l;const{stores:{data:f},actions:{reload:i}}=He();Fe(n,f,a=>s(2,l=a));let g=Te;const p=a=>{s(0,g=a)};Re(()=>i(!0));const c=()=>p({...Te}),v=a=>p({...a});return n.$$.update=()=>{n.$$.dirty&1&&s(1,e=g?.id?"Edit Transaction":"Create Transaction")},[g,e,l,f,p,c,v]}class dt extends Ie{constructor(t){super(),Se(this,t,ft,ut,ke,{})}}function ct(n){let t,s;return t=new dt({}),{c(){ue(t.$$.fragment)},l(e){fe(t.$$.fragment,e)},m(e,l){de(t,e,l),s=!0},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){$(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}function mt(n){let t,s;return t=new Je({props:{pageTitle:"Budgets",$$slots:{default:[ct]},$$scope:{ctx:n}}}),{c(){ue(t.$$.fragment)},l(e){fe(t.$$.fragment,e)},m(e,l){de(t,e,l),s=!0},p(e,[l]){const f={};l&1&&(f.$$scope={dirty:l,ctx:e}),t.$set(f)},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){$(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}class wt extends Ie{constructor(t){super(),Se(this,t,null,mt,ke,{})}}export{wt as component,Mt as universal};
