import{s as Ie,r as He,n as qe,h as ke,b as ze,o as Re}from"../chunks/scheduler.DyivmMiW.js";import{S as Te,i as Se,v as De,o as q,t as W,x as Fe,a as x,w as Ye,d as b,e as y,s as P,b as be,c as ie,j as v,k as M,l as X,f as O,m as ye,g as ue,n as _,y as Q,q as f,C as se,p as fe,B as U,r as ve,u as de,D as Ge}from"../chunks/index.BqK79KpI.js";import{P as Ke}from"../chunks/PageLayout.CkrZNwOL.js";import{e as Ce}from"../chunks/Header.CZ_Bj7fP.js";import{g as Je,f as Be,p as ne,c as Qe,u as We,a as Xe,d as Ze,D as xe}from"../chunks/budget.api._7bV1x_p.js";import{S as $e}from"../chunks/Spinner.BlcZoQhc.js";import{w as Le}from"../chunks/index.Cdixjbko.js";const et=!0,vt=Object.freeze(Object.defineProperty({__proto__:null,prerender:et},Symbol.toStringTag,{value:"Module"})),we={start_at:"",end_at:"",settings:{max_spend_limit:0}};let Z=null;const tt=()=>{const n=Le(!1),t=Le([]);return Z={stores:{loading:n,data:t},actions:{reload:async()=>{n.set(!0);const e=await Je();t.set(e),n.set(!1)}}},Z},Ue=()=>Z?.stores&&Object.keys(Z.stores).length>0&&Z?.actions&&Object.keys(Z.actions).length>0?Z:tt();function Ne(n){let t,s,e,l="Start Date*",d,i,g,p,m,h,a="End Date*",u,r,T,S,E,N,z="Max Limit*",R,I,C,w,k,j,H=n[14].message+"",A,Y,le,G,K,re,$,V,ee,B,oe,ce;K=new $e({props:{size:"xs"}});let L=n[6]&&Pe(n);function me(c,D){return c[6]?nt:st}let te=me(n),F=te(n),o=n[15]&&Oe();return{c(){t=y("div"),s=y("div"),e=y("div"),e.textContent=l,d=P(),i=y("input"),p=P(),m=y("div"),h=y("div"),h.textContent=a,u=P(),r=y("input"),S=P(),E=y("div"),N=y("div"),N.textContent=z,R=P(),I=y("input"),w=P(),k=y("div"),j=y("small"),A=be(H),le=P(),G=y("span"),ie(K.$$.fragment),re=P(),L&&L.c(),$=P(),V=y("button"),F.c(),ee=P(),o&&o.c(),this.h()},l(c){t=v(c,"DIV",{class:!0});var D=M(t);s=v(D,"DIV",{class:!0});var _e=M(s);e=v(_e,"DIV",{"data-svelte-h":!0}),X(e)!=="svelte-172ibe4"&&(e.textContent=l),d=O(_e),i=v(_e,"INPUT",{name:!0,type:!0,class:!0}),_e.forEach(b),p=O(D),m=v(D,"DIV",{class:!0});var pe=M(m);h=v(pe,"DIV",{"data-svelte-h":!0}),X(h)!=="svelte-1iotazt"&&(h.textContent=a),u=O(pe),r=v(pe,"INPUT",{name:!0,type:!0,class:!0}),pe.forEach(b),S=O(D),E=v(D,"DIV",{class:!0});var ge=M(E);N=v(ge,"DIV",{"data-svelte-h":!0}),X(N)!=="svelte-16dil7f"&&(N.textContent=z),R=O(ge),I=v(ge,"INPUT",{name:!0,type:!0,class:!0}),ge.forEach(b),w=O(D),k=v(D,"DIV",{class:!0});var J=M(k);j=v(J,"SMALL",{class:!0});var Ee=M(j);A=ye(Ee,H),Ee.forEach(b),le=O(J),G=v(J,"SPAN",{});var Me=M(G);ue(K.$$.fragment,Me),Me.forEach(b),re=O(J),L&&L.l(J),$=O(J),V=v(J,"BUTTON",{class:!0});var he=M(V);F.l(he),ee=O(he),o&&o.l(he),he.forEach(b),J.forEach(b),D.forEach(b),this.h()},h(){_(i,"name",g=n[1]+"-start-date"),_(i,"type","date"),_(i,"class","form-control"),i.disabled=n[10],i.required=!0,Q(i,"is-invalid",n[8]),_(s,"class","d-flex flex-column gap-2"),_(r,"name",T=n[1]+"-end-date"),_(r,"type","date"),_(r,"class","form-control"),r.disabled=n[10],r.required=!0,Q(r,"is-invalid",n[7]),_(m,"class","d-flex flex-column gap-2"),_(I,"name",C=n[1]+"-max-limit"),_(I,"type","text"),_(I,"class","form-control text-end"),I.disabled=n[10],I.required=!0,Q(I,"is-invalid",n[9]),_(E,"class","d-flex flex-column gap-2"),_(j,"class",Y="fw-lighter fst-italic text-"+n[14].type),Q(G,"d-none",!n[10]),_(V,"class","btn btn-primary position-relative"),_(k,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),_(t,"class","d-flex flex-column gap-4")},m(c,D){q(c,t,D),f(t,s),f(s,e),f(s,d),f(s,i),n[21](i),se(i,n[2]),f(t,p),f(t,m),f(m,h),f(m,u),f(m,r),n[25](r),se(r,n[3]),f(t,S),f(t,E),f(E,N),f(E,R),f(E,I),n[29](I),se(I,n[4]),f(t,w),f(t,k),f(k,j),f(j,A),f(k,le),f(k,G),fe(K,G,null),f(k,re),L&&L.m(k,null),f(k,$),f(k,V),F.m(V,null),f(V,ee),o&&o.m(V,null),B=!0,oe||(ce=[U(i,"focus",n[22]),U(i,"keyup",n[23]),U(i,"input",n[24]),U(r,"focus",n[26]),U(r,"keyup",n[27]),U(r,"input",n[28]),U(I,"focus",n[30]),U(I,"keyup",n[31]),U(I,"input",n[32]),U(V,"click",n[17])],oe=!0)},p(c,D){(!B||D[0]&2&&g!==(g=c[1]+"-start-date"))&&_(i,"name",g),(!B||D[0]&1024)&&(i.disabled=c[10]),D[0]&4&&se(i,c[2]),(!B||D[0]&256)&&Q(i,"is-invalid",c[8]),(!B||D[0]&2&&T!==(T=c[1]+"-end-date"))&&_(r,"name",T),(!B||D[0]&1024)&&(r.disabled=c[10]),D[0]&8&&se(r,c[3]),(!B||D[0]&128)&&Q(r,"is-invalid",c[7]),(!B||D[0]&2&&C!==(C=c[1]+"-max-limit"))&&_(I,"name",C),(!B||D[0]&1024)&&(I.disabled=c[10]),D[0]&16&&I.value!==c[4]&&se(I,c[4]),(!B||D[0]&512)&&Q(I,"is-invalid",c[9]),(!B||D[0]&16384)&&H!==(H=c[14].message+"")&&ve(A,H),(!B||D[0]&16384&&Y!==(Y="fw-lighter fst-italic text-"+c[14].type))&&_(j,"class",Y),(!B||D[0]&1024)&&Q(G,"d-none",!c[10]),c[6]?L?L.p(c,D):(L=Pe(c),L.c(),L.m(k,$)):L&&(L.d(1),L=null),te!==(te=me(c))&&(F.d(1),F=te(c),F&&(F.c(),F.m(V,ee))),c[15]?o||(o=Oe(),o.c(),o.m(V,null)):o&&(o.d(1),o=null)},i(c){B||(W(K.$$.fragment,c),B=!0)},o(c){x(K.$$.fragment,c),B=!1},d(c){c&&b(t),n[21](null),n[25](null),n[29](null),de(K),L&&L.d(),F.d(),o&&o.d(),oe=!1,He(ce)}}}function Pe(n){let t,s="<span>Delete</span>",e,l;return{c(){t=y("button"),t.innerHTML=s,this.h()},l(d){t=v(d,"BUTTON",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-4hjfsp"&&(t.innerHTML=s),this.h()},h(){_(t,"class","btn btn-danger position-relative")},m(d,i){q(d,t,i),e||(l=U(t,"click",n[16]),e=!0)},p:qe,d(d){d&&b(t),e=!1,l()}}}function st(n){let t,s="Create";return{c(){t=y("span"),t.textContent=s},l(e){t=v(e,"SPAN",{"data-svelte-h":!0}),X(t)!=="svelte-1wf0js6"&&(t.textContent=s)},m(e,l){q(e,t,l)},d(e){e&&b(t)}}}function nt(n){let t,s="Save";return{c(){t=y("span"),t.textContent=s},l(e){t=v(e,"SPAN",{"data-svelte-h":!0}),X(t)!=="svelte-l126tb"&&(t.textContent=s)},m(e,l){q(e,t,l)},d(e){e&&b(t)}}}function Oe(n){let t,s='<span class="visually-hidden">Item not saved</span>';return{c(){t=y("span"),t.innerHTML=s,this.h()},l(e){t=v(e,"SPAN",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-1sxrz4i"&&(t.innerHTML=s),this.h()},h(){_(t,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(e,l){q(e,t,l)},d(e){e&&b(t)}}}function at(n){let t,s,e=n[0]&&Ne(n);return{c(){e&&e.c(),t=De()},l(l){e&&e.l(l),t=De()},m(l,d){e&&e.m(l,d),q(l,t,d),s=!0},p(l,d){l[0]?e?(e.p(l,d),d[0]&1&&W(e,1)):(e=Ne(l),e.c(),W(e,1),e.m(t.parentNode,t)):e&&(Fe(),x(e,1,1,()=>{e=null}),Ye())},i(l){s||(W(e),s=!0)},o(l){x(e),s=!1},d(l){l&&b(t),e&&e.d(l)}}}function lt(n,t,s){let e,l,d,i,g,p,{name:m=""}=t,{drawerId:h=""}=t,{budget:a}=t;const{actions:{reload:u}}=Ue();let r=!1,T,S,E,N=0,z,R,I,C={message:"",type:"info"},w,k={startDate:!1,endDate:!1,amount:!1};const j=()=>{const o=`[data-bs-target="#${h}"]`,c=document.querySelector(o);c&&c.click()},H=()=>{s(5,k={amount:!1,startDate:!1,endDate:!1}),s(0,a={...we}),s(10,r=!1)},A=(o,c=0,D="info")=>{s(14,C.message=o,C),s(14,C.type=D,C),c&&setTimeout(()=>{s(14,C.message="",C)},c)},Y=async()=>{if(!e){A("ID is not defined",0,"danger");return}try{await Ze(e),await u(!0),setTimeout(()=>{s(10,r=!1),s(20,w={...a,id:e,start_at:ne(T,"yyyy-MM-dd",new Date).toISOString(),end_at:ne(S,"yyyy-MM-dd",new Date).toISOString()}),A("Transaction Deleted",3e3,"success"),j()},800)}catch(o){setTimeout(()=>{s(10,r=!1),console.error("Save failed:",o),A("Failed to save event. Please try again.",7e3,"danger")},800)}},le=()=>{s(10,r=!0),Qe({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async o=>{o&&await Y(),await u(!0),H()}})},G=async()=>{if(!l){A("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!p){let o=[];g&&o.push("Amount is invalid"),d&&o.push("Start date is invalid"),i&&o.push("End date is invalid"),A(o.join(". ")+".  Please address accordingly.",0,"danger");return}if(!r){A("Saving ..."),s(10,r=!0);try{const o={...a,start_at:ne(T,"yyyy-MM-dd",new Date).toISOString(),end_at:ne(S,"yyyy-MM-dd",new Date).toISOString(),settings:{...a.settings,max_spend_limit:E}};e?await We(e,o):await Xe(o),await u(!0),setTimeout(()=>{s(10,r=!1),s(20,w={...a,id:e}),A("Saved",3e3,"success"),e||H(),j()},800)}catch(o){setTimeout(()=>{s(10,r=!1),console.error("Save failed:",o),A("Failed to save event. Please try again.",7e3,"danger"),e||H()},800)}}};function K(o){ke[o?"unshift":"push"](()=>{z=o,s(11,z)})}const re=()=>z.select(),$=()=>s(5,k.startDate=!0,k);function V(){T=this.value,s(2,T),s(6,e),s(0,a),s(19,N)}function ee(o){ke[o?"unshift":"push"](()=>{R=o,s(12,R)})}const B=()=>R.select(),oe=()=>s(5,k.endDate=!0,k);function ce(){S=this.value,s(3,S),s(6,e),s(0,a),s(19,N)}function L(o){ke[o?"unshift":"push"](()=>{I=o,s(13,I)})}const me=()=>I.select(),te=()=>s(5,k.amount=!0,k);function F(){E=this.value,s(4,E),s(6,e),s(0,a),s(19,N)}return n.$$set=o=>{"name"in o&&s(1,m=o.name),"drawerId"in o&&s(18,h=o.drawerId),"budget"in o&&s(0,a=o.budget)},n.$$.update=()=>{n.$$.dirty[0]&1&&s(6,e=a?.id),n.$$.dirty[0]&524353&&e&&a&&N!==e&&(s(10,r=!0),setTimeout(()=>{s(20,w={...a}),s(19,N=e),s(4,E=a.settings?.max_spend_limit??0),s(2,T=Be(ne(a.start_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(3,S=Be(ne(a.end_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(10,r=!1)},800)),n.$$.dirty[0]&1048604&&s(15,l=w?.start_at!==T||w?.end_at!==S||w?.settings?.max_spend_limit!==E),n.$$.dirty[0]&33&&s(8,d=k.startDate&&a?.start_at===""),n.$$.dirty[0]&33&&s(7,i=k.endDate&&a?.end_at===""),n.$$.dirty[0]&33&&s(9,g=k.amount&&a?.settings?.max_spend_limit===0),n.$$.dirty[0]&896&&(p=!d&&!i&&!g)},[a,m,T,S,E,k,e,i,d,g,r,z,R,I,C,l,le,G,h,N,w,K,re,$,V,ee,B,oe,ce,L,me,te,F]}class rt extends Te{constructor(t){super(),Se(this,t,lt,at,Ie,{name:1,drawerId:18,budget:0},null,[-1,-1])}}function Ae(n,t,s){const e=n.slice();return e[7]=t[s],e}function ot(n){let t,s;return t=new rt({props:{name:"budget-form",drawerId:ae,budget:n[0]}}),{c(){ie(t.$$.fragment)},l(e){ue(t.$$.fragment,e)},m(e,l){fe(t,e,l),s=!0},p(e,l){const d={};l&1&&(d.budget=e[0]),t.$set(d)},i(e){s||(W(t.$$.fragment,e),s=!0)},o(e){x(t.$$.fragment,e),s=!1},d(e){de(t,e)}}}function je(n){let t,s,e,l='<tr><th scope="col">Start</th> <th scope="col">End</th> <th scope="col">Max Limit</th> <th scope="col"></th></tr>',d,i,g=Ce(n[1]),p=[];for(let m=0;m<g.length;m+=1)p[m]=Ve(Ae(n,g,m));return{c(){t=y("div"),s=y("table"),e=y("thead"),e.innerHTML=l,d=P(),i=y("tbody");for(let m=0;m<p.length;m+=1)p[m].c();this.h()},l(m){t=v(m,"DIV",{class:!0});var h=M(t);s=v(h,"TABLE",{class:!0});var a=M(s);e=v(a,"THEAD",{"data-svelte-h":!0}),X(e)!=="svelte-12ylp16"&&(e.innerHTML=l),d=O(a),i=v(a,"TBODY",{});var u=M(i);for(let r=0;r<p.length;r+=1)p[r].l(u);u.forEach(b),a.forEach(b),h.forEach(b),this.h()},h(){_(s,"class","table"),_(t,"class","table-responsive")},m(m,h){q(m,t,h),f(t,s),f(s,e),f(s,d),f(s,i);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(i,null)},p(m,h){if(h&10){g=Ce(m[1]);let a;for(a=0;a<g.length;a+=1){const u=Ae(m,g,a);p[a]?p[a].p(u,h):(p[a]=Ve(u),p[a].c(),p[a].m(i,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=g.length}},d(m){m&&b(t),Ge(p,m)}}}function Ve(n){let t,s,e=n[7].start_at+"",l,d,i,g=n[7].end_at+"",p,m,h,a=n[7]?.settings?.max_spend_limit+"",u,r,T,S,E,N,z,R;function I(){return n[5](n[7])}return{c(){t=y("tr"),s=y("td"),l=be(e),d=P(),i=y("td"),p=be(g),m=P(),h=y("td"),u=be(a),r=P(),T=y("td"),S=y("button"),E=y("i"),N=P(),this.h()},l(C){t=v(C,"TR",{});var w=M(t);s=v(w,"TD",{});var k=M(s);l=ye(k,e),k.forEach(b),d=O(w),i=v(w,"TD",{});var j=M(i);p=ye(j,g),j.forEach(b),m=O(w),h=v(w,"TD",{});var H=M(h);u=ye(H,a),H.forEach(b),r=O(w),T=v(w,"TD",{class:!0});var A=M(T);S=v(A,"BUTTON",{"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0,class:!0});var Y=M(S);E=v(Y,"I",{class:!0}),M(E).forEach(b),Y.forEach(b),A.forEach(b),N=O(w),w.forEach(b),this.h()},h(){_(E,"class","bi bi-pencil"),_(S,"data-bs-toggle","offcanvas"),_(S,"data-bs-target","#"+ae),_(S,"aria-controls",ae),_(S,"class","btn btn-sm btn-primary"),_(T,"class","d-flex justify-content-end")},m(C,w){q(C,t,w),f(t,s),f(s,l),f(t,d),f(t,i),f(i,p),f(t,m),f(t,h),f(h,u),f(t,r),f(t,T),f(T,S),f(S,E),f(t,N),z||(R=U(S,"click",I),z=!0)},p(C,w){n=C,w&2&&e!==(e=n[7].start_at+"")&&ve(l,e),w&2&&g!==(g=n[7].end_at+"")&&ve(p,g),w&2&&a!==(a=n[7]?.settings?.max_spend_limit+"")&&ve(u,a)},d(C){C&&b(t),z=!1,R()}}}function it(n){let t,s,e,l,d,i,g,p,m,h;t=new xe({props:{title:"Drawer Title",id:ae,$$slots:{default:[ot]},$$scope:{ctx:n}}});let a=n[1].length&&je(n);return{c(){ie(t.$$.fragment),s=P(),e=y("div"),l=y("button"),d=y("i"),i=P(),a&&a.c(),g=De(),this.h()},l(u){ue(t.$$.fragment,u),s=O(u),e=v(u,"DIV",{class:!0});var r=M(e);l=v(r,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var T=M(l);d=v(T,"I",{class:!0}),M(d).forEach(b),T.forEach(b),r.forEach(b),i=O(u),a&&a.l(u),g=De(),this.h()},h(){_(d,"class","bi bi-plus"),_(l,"class","btn btn-sm btn-secondary"),_(l,"type","button"),_(l,"data-bs-toggle","offcanvas"),_(l,"data-bs-target","#"+ae),_(l,"aria-controls",ae),_(e,"class","d-flex justify-content-end")},m(u,r){fe(t,u,r),q(u,s,r),q(u,e,r),f(e,l),f(l,d),q(u,i,r),a&&a.m(u,r),q(u,g,r),p=!0,m||(h=U(l,"click",n[4]),m=!0)},p(u,[r]){const T={};r&1025&&(T.$$scope={dirty:r,ctx:u}),t.$set(T),u[1].length?a?a.p(u,r):(a=je(u),a.c(),a.m(g.parentNode,g)):a&&(a.d(1),a=null)},i(u){p||(W(t.$$.fragment,u),p=!0)},o(u){x(t.$$.fragment,u),p=!1},d(u){u&&(b(s),b(e),b(i),b(g)),de(t,u),a&&a.d(u),m=!1,h()}}}const ae="budgets-form";function ut(n,t,s){let e;const{stores:{data:l},actions:{reload:d}}=Ue();ze(n,l,h=>s(1,e=h));let i=we;const g=h=>{s(0,i=h)};return Re(()=>d(!0)),[i,e,l,g,()=>g({...we}),h=>g({...h})]}class ft extends Te{constructor(t){super(),Se(this,t,ut,it,Ie,{})}}function dt(n){let t,s;return t=new ft({}),{c(){ie(t.$$.fragment)},l(e){ue(t.$$.fragment,e)},m(e,l){fe(t,e,l),s=!0},i(e){s||(W(t.$$.fragment,e),s=!0)},o(e){x(t.$$.fragment,e),s=!1},d(e){de(t,e)}}}function ct(n){let t,s;return t=new Ke({props:{pageTitle:"Budgets",$$slots:{default:[dt]},$$scope:{ctx:n}}}),{c(){ie(t.$$.fragment)},l(e){ue(t.$$.fragment,e)},m(e,l){fe(t,e,l),s=!0},p(e,[l]){const d={};l&1&&(d.$$scope={dirty:l,ctx:e}),t.$set(d)},i(e){s||(W(t.$$.fragment,e),s=!0)},o(e){x(t.$$.fragment,e),s=!1},d(e){de(t,e)}}}class Dt extends Te{constructor(t){super(),Se(this,t,null,ct,Ie,{})}}export{Dt as component,vt as universal};
