import{a8 as mt,a9 as pt,M as Be,O as ht,s as se,F as ge,a6 as be,Y as Ne,A as ne,o as O,w as x,f as v,e as I,t as z,d as M,j as D,k as T,m as U,i as L,n as E,p as _,q as de,K as ut,l as Te,H as Ke,y as vt,r as Pe,v as $t,a7 as bt}from"../chunks/scheduler.CWuNsFr_.js";import{g as ee,a as k,e as te,t as h,S as ie,i as oe,f as ke,c as F,b as A,m as P,d as V}from"../chunks/index.DFpbdPjZ.js";import{P as kt}from"../chunks/PageLayout.C4pf9jZy.js";import{B as Se,c as ct,D as wt,F as It}from"../chunks/FormSkeleton.DDRunjFW.js";import{c as Ge,D as ft,f as Me}from"../chunks/DateField.Cm5Or5_J.js";import{B as Dt,R as Ct,g as Je,A as Et,D as yt,S as Bt,a as Tt,b as $e,c as St,d as Mt}from"../chunks/BillTypeBadge.Bl-Alhhm.js";import{S as dt,g as Lt}from"../chunks/SelectField.DxokfJDN.js";import{e as Le}from"../chunks/Header.CGaYzOkn.js";import{t as Nt,f as Qe}from"../chunks/app.state.ChF-XQ0B.js";function We(a,e){const n=e.token={};function t(l,o,r,u){if(e.token!==n)return;e.resolved=u;let s=e.ctx;r!==void 0&&(s=s.slice(),s[r]=u);const f=l&&(e.current=l)(s);let g=!1;e.block&&(e.blocks?e.blocks.forEach((i,c)=>{c!==o&&i&&(ee(),k(i,1,1,()=>{e.blocks[c]===i&&(e.blocks[c]=null)}),te())}):e.block.d(1),f.c(),h(f,1),f.m(e.mount(),e.anchor),g=!0),e.block=f,e.blocks&&(e.blocks[o]=f),g&&ht()}if(mt(a)){const l=pt();if(a.then(o=>{Be(l),t(e.then,1,e.value,o),Be(null)},o=>{if(Be(l),t(e.catch,2,e.error,o),Be(null),!e.hasCatch)throw o}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,a),!0;e.resolved=a}}function Ft(a,e,n){const t=e.slice(),{resolved:l}=a;a.current===a.then&&(t[a.value]=l),a.current===a.catch&&(t[a.error]=l),a.block.p(t,n)}function At(a,e){const n=Nt(a);if(isNaN(e))return Ge(a,NaN);const t=n.getDate(),l=Ge(a,n.getTime());l.setMonth(n.getMonth()+e+1,0);const o=l.getDate();return t>=o?l:(n.setFullYear(l.getFullYear(),l.getMonth(),t),n)}const Pt=!0,Tn=Object.freeze(Object.defineProperty({__proto__:null,prerender:Pt},Symbol.toStringTag,{value:"Module"}));function Vt(a){let e,n,t;function l(r){a[4](r)}let o={label:"Type",name:"repeat-type",helperText:"",loading:a[1],required:!0,isInvalid:!1,disabled:!1,options:a[3]};return a[0]!==void 0&&(o.value=a[0]),e=new dt({props:o}),ge.push(()=>ke(e,"value",l)),e.$on("change",a[2]),{c(){F(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,u){P(e,r,u),t=!0},p(r,[u]){const s={};u&2&&(s.loading=r[1]),!n&&u&1&&(n=!0,s.value=r[0],be(()=>n=!1)),e.$set(s)},i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function Ot(a,e,n){let{value:t}=e,{loading:l}=e;const o=Ne(),r=()=>{o("valueChanged",{value:t})},u=Dt;function s(f){t=f,n(0,t)}return a.$$set=f=>{"value"in f&&n(0,t=f.value),"loading"in f&&n(1,l=f.loading)},[t,l,r,u,s]}class Rt extends ie{constructor(e){super(),oe(this,e,Ot,Vt,se,{value:0,loading:1})}}function Yt(a){let e,n,t;function l(r){a[4](r)}let o={label:"Repeat type",name:"repeat-type",helperText:"",loading:a[1],required:!0,isInvalid:!1,disabled:!1,options:a[3]};return a[0]!==void 0&&(o.value=a[0]),e=new dt({props:o}),ge.push(()=>ke(e,"value",l)),e.$on("change",a[2]),{c(){F(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,u){P(e,r,u),t=!0},p(r,[u]){const s={};u&2&&(s.loading=r[1]),!n&&u&1&&(n=!0,s.value=r[0],be(()=>n=!1)),e.$set(s)},i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function jt(a,e,n){let{value:t}=e,{loading:l}=e;const o=Ne(),r=()=>{o("valueChanged",{value:t})},u=Ct;function s(f){t=f,n(0,t)}return a.$$set=f=>{"value"in f&&n(0,t=f.value),"loading"in f&&n(1,l=f.loading)},[t,l,r,u,s]}class Ht extends ie{constructor(e){super(),oe(this,e,jt,Yt,se,{value:0,loading:1})}}function qt(a){let e,n,t;function l(r){a[3](r)}let o={label:"Date",name:"repeat-start-date",placeholder:"",helperText:"",loading:a[1],required:!0,isInvalid:!1};return a[0]!==void 0&&(o.value=a[0]),e=new ft({props:o}),ge.push(()=>ke(e,"value",l)),e.$on("valueChanged",a[2]),{c(){F(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,u){P(e,r,u),t=!0},p(r,[u]){const s={};u&2&&(s.loading=r[1]),!n&&u&1&&(n=!0,s.value=r[0],be(()=>n=!1)),e.$set(s)},i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function zt(a,e,n){let{value:t}=e,{loading:l}=e;const o=Ne(),r=()=>{o("valueChanged",{value:t})};function u(s){t=s,n(0,t)}return a.$$set=s=>{"value"in s&&n(0,t=s.value),"loading"in s&&n(1,l=s.loading)},[t,l,r,u]}class Ut extends ie{constructor(e){super(),oe(this,e,zt,qt,se,{value:0,loading:1})}}function Kt(a){let e,n,t;function l(r){a[3](r)}let o={label:"End date",name:"repeat-end-date",placeholder:"",helperText:"",loading:a[1],required:!0,isInvalid:!1};return a[0]!==void 0&&(o.value=a[0]),e=new ft({props:o}),ge.push(()=>ke(e,"value",l)),e.$on("valueChanged",a[2]),{c(){F(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,u){P(e,r,u),t=!0},p(r,[u]){const s={};u&2&&(s.loading=r[1]),!n&&u&1&&(n=!0,s.value=r[0],be(()=>n=!1)),e.$set(s)},i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function Gt(a,e,n){let{value:t}=e,{loading:l}=e;const o=Ne(),r=()=>{o("valueChanged",{value:t})};function u(s){t=s,n(0,t)}return a.$$set=s=>{"value"in s&&n(0,t=s.value),"loading"in s&&n(1,l=s.loading)},[t,l,r,u]}class Jt extends ie{constructor(e){super(),oe(this,e,Gt,Kt,se,{value:0,loading:1})}}function Xe(a,e,n){const t=a.slice();return t[1]=e[n],t[3]=n,t}function Ze(a){let e,n,t,l=a[0].length+"",o,r,u,s,f,g=Le(a[0]),i=[];for(let c=0;c<g.length;c+=1)i[c]=xe(Xe(a,g,c));return{c(){e=I("div"),n=I("div"),t=z("Dates Preview ("),o=z(l),r=z(" entries)"),u=M(),s=I("div"),f=I("ul");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=D(c,"DIV",{class:!0});var d=T(e);n=D(d,"DIV",{});var m=T(n);t=U(m,"Dates Preview ("),o=U(m,l),r=U(m," entries)"),m.forEach(v),u=L(d),s=D(d,"DIV",{class:!0});var w=T(s);f=D(w,"UL",{class:!0});var N=T(f);for(let H=0;H<i.length;H+=1)i[H].l(N);N.forEach(v),w.forEach(v),d.forEach(v),this.h()},h(){E(f,"class","list-group list-group-flush"),E(s,"class","preview border border-light-subtle svelte-1qbwz3y"),E(e,"class","d-flex flex-column gap-1")},m(c,d){O(c,e,d),_(e,n),_(n,t),_(n,o),_(n,r),_(e,u),_(e,s),_(s,f);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(f,null)},p(c,d){if(d&1&&l!==(l=c[0].length+"")&&de(o,l),d&1){g=Le(c[0]);let m;for(m=0;m<g.length;m+=1){const w=Xe(c,g,m);i[m]?i[m].p(w,d):(i[m]=xe(w),i[m].c(),i[m].m(f,null))}for(;m<i.length;m+=1)i[m].d(1);i.length=g.length}},d(c){c&&v(e),ut(i,c)}}}function xe(a){let e,n=a[3]+1+"",t,l,o=Me(a[1],"EEE - dd MMM yyyy")+"",r,u;return{c(){e=I("li"),t=z(n),l=z(". "),r=z(o),u=M(),this.h()},l(s){e=D(s,"LI",{class:!0});var f=T(e);t=U(f,n),l=U(f,". "),r=U(f,o),u=L(f),f.forEach(v),this.h()},h(){E(e,"class","list-group-item")},m(s,f){O(s,e,f),_(e,t),_(e,l),_(e,r),_(e,u)},p(s,f){f&1&&o!==(o=Me(s[1],"EEE - dd MMM yyyy")+"")&&de(r,o)},d(s){s&&v(e)}}}function Qt(a){let e,n=a[0].length>0&&Ze(a);return{c(){n&&n.c(),e=ne()},l(t){n&&n.l(t),e=ne()},m(t,l){n&&n.m(t,l),O(t,e,l)},p(t,[l]){t[0].length>0?n?n.p(t,l):(n=Ze(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:x,o:x,d(t){t&&v(e),n&&n.d(t)}}}function Wt(a,e,n){let{dates:t}=e;return a.$$set=l=>{"dates"in l&&n(0,t=l.dates)},[t]}class Xt extends ie{constructor(e){super(),oe(this,e,Wt,Qt,se,{dates:0})}}function et(a){let e,n,t,l,o,r,u,s,f,g,i,c,d,m,w,N,H,K,X,ue={loading:a[0],value:a[1].amount};n=new Et({props:ue}),a[14](n),n.$on("valueChanged",a[15]);let ce={loading:a[0],value:a[1].description};l=new yt({props:ce}),a[16](l),l.$on("valueChanged",a[17]);let _e={loading:a[0],value:a[1].source};r=new Bt({props:_e}),a[18](r),r.$on("valueChanged",a[19]),s=new Tt({props:{loading:a[0],value:a[3].account_id}}),s.$on("valueChanged",a[20]);let C=a[1]?.meta_data?.transaction?.type&&tt(a),y=a[1].recurrence&&nt(a),B=a[1].id&&lt(a);return N=new Se({props:{loading:a[0],variant:"secondary",$$slots:{default:[xt]},$$scope:{ctx:a}}}),N.$on("click",a[8]),K=new Se({props:{loading:a[0],variant:"primary",$$slots:{default:[en]},$$scope:{ctx:a}}}),K.$on("click",a[9]),{c(){e=I("div"),F(n.$$.fragment),t=M(),F(l.$$.fragment),o=M(),F(r.$$.fragment),u=M(),F(s.$$.fragment),f=M(),C&&C.c(),g=M(),y&&y.c(),i=M(),c=I("div"),d=I("div"),B&&B.c(),m=M(),w=I("div"),F(N.$$.fragment),H=M(),F(K.$$.fragment),this.h()},l($){e=D($,"DIV",{class:!0});var b=T(e);A(n.$$.fragment,b),t=L(b),A(l.$$.fragment,b),o=L(b),A(r.$$.fragment,b),u=L(b),A(s.$$.fragment,b),f=L(b),C&&C.l(b),g=L(b),y&&y.l(b),i=L(b),c=D(b,"DIV",{class:!0});var Y=T(c);d=D(Y,"DIV",{});var q=T(d);B&&B.l(q),q.forEach(v),m=L(Y),w=D(Y,"DIV",{});var p=T(w);A(N.$$.fragment,p),H=L(p),A(K.$$.fragment,p),p.forEach(v),Y.forEach(v),b.forEach(v),this.h()},h(){E(c,"class","d-flex justify-content-between"),E(e,"class","d-flex flex-column gap-3")},m($,b){O($,e,b),P(n,e,null),_(e,t),P(l,e,null),_(e,o),P(r,e,null),_(e,u),P(s,e,null),_(e,f),C&&C.m(e,null),_(e,g),y&&y.m(e,null),_(e,i),_(e,c),_(c,d),B&&B.m(d,null),_(c,m),_(c,w),P(N,w,null),_(w,H),P(K,w,null),X=!0},p($,b){const Y={};b&1&&(Y.loading=$[0]),b&2&&(Y.value=$[1].amount),n.$set(Y);const q={};b&1&&(q.loading=$[0]),b&2&&(q.value=$[1].description),l.$set(q);const p={};b&1&&(p.loading=$[0]),b&2&&(p.value=$[1].source),r.$set(p);const G={};b&1&&(G.loading=$[0]),b&8&&(G.value=$[3].account_id),s.$set(G),$[1]?.meta_data?.transaction?.type?C?(C.p($,b),b&2&&h(C,1)):(C=tt($),C.c(),h(C,1),C.m(e,g)):C&&(ee(),k(C,1,1,()=>{C=null}),te()),$[1].recurrence?y?(y.p($,b),b&2&&h(y,1)):(y=nt($),y.c(),h(y,1),y.m(e,i)):y&&(ee(),k(y,1,1,()=>{y=null}),te()),$[1].id?B?(B.p($,b),b&2&&h(B,1)):(B=lt($),B.c(),h(B,1),B.m(d,null)):B&&(ee(),k(B,1,1,()=>{B=null}),te());const S={};b&1&&(S.loading=$[0]),b&134217728&&(S.$$scope={dirty:b,ctx:$}),N.$set(S);const Z={};b&1&&(Z.loading=$[0]),b&134217728&&(Z.$$scope={dirty:b,ctx:$}),K.$set(Z)},i($){X||(h(n.$$.fragment,$),h(l.$$.fragment,$),h(r.$$.fragment,$),h(s.$$.fragment,$),h(C),h(y),h(B),h(N.$$.fragment,$),h(K.$$.fragment,$),X=!0)},o($){k(n.$$.fragment,$),k(l.$$.fragment,$),k(r.$$.fragment,$),k(s.$$.fragment,$),k(C),k(y),k(B),k(N.$$.fragment,$),k(K.$$.fragment,$),X=!1},d($){$&&v(e),a[14](null),V(n),a[16](null),V(l),a[18](null),V(r),V(s),C&&C.d(),y&&y.d(),B&&B.d(),V(N),V(K)}}}function tt(a){let e,n;return e=new Rt({props:{loading:a[0],value:a[1].meta_data.transaction.type}}),e.$on("valueChanged",a[21]),{c(){F(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){P(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.loading=t[0]),l&2&&(o.value=t[1].meta_data.transaction.type),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function nt(a){let e,n="Repeats",t,l,o,r,u,s,f,g;l=new Ht({props:{loading:a[0],value:a[1].recurrence.type}}),l.$on("valueChanged",a[22]),r=new Ut({props:{loading:a[0],value:a[1].recurrence.start_date}}),r.$on("valueChanged",a[23]);let i=a[1].recurrence.until&&at(a);return f=new Xt({props:{dates:a[2]}}),{c(){e=I("h5"),e.textContent=n,t=M(),F(l.$$.fragment),o=M(),F(r.$$.fragment),u=M(),i&&i.c(),s=M(),F(f.$$.fragment)},l(c){e=D(c,"H5",{"data-svelte-h":!0}),Te(e)!=="svelte-13f0n3i"&&(e.textContent=n),t=L(c),A(l.$$.fragment,c),o=L(c),A(r.$$.fragment,c),u=L(c),i&&i.l(c),s=L(c),A(f.$$.fragment,c)},m(c,d){O(c,e,d),O(c,t,d),P(l,c,d),O(c,o,d),P(r,c,d),O(c,u,d),i&&i.m(c,d),O(c,s,d),P(f,c,d),g=!0},p(c,d){const m={};d&1&&(m.loading=c[0]),d&2&&(m.value=c[1].recurrence.type),l.$set(m);const w={};d&1&&(w.loading=c[0]),d&2&&(w.value=c[1].recurrence.start_date),r.$set(w),c[1].recurrence.until?i?(i.p(c,d),d&2&&h(i,1)):(i=at(c),i.c(),h(i,1),i.m(s.parentNode,s)):i&&(ee(),k(i,1,1,()=>{i=null}),te());const N={};d&4&&(N.dates=c[2]),f.$set(N)},i(c){g||(h(l.$$.fragment,c),h(r.$$.fragment,c),h(i),h(f.$$.fragment,c),g=!0)},o(c){k(l.$$.fragment,c),k(r.$$.fragment,c),k(i),k(f.$$.fragment,c),g=!1},d(c){c&&(v(e),v(t),v(o),v(u),v(s)),V(l,c),V(r,c),i&&i.d(c),V(f,c)}}}function at(a){let e,n;return e=new Jt({props:{loading:a[0],value:a[1].recurrence.until}}),e.$on("valueChanged",a[24]),{c(){F(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){P(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.loading=t[0]),l&2&&(o.value=t[1].recurrence.until),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function lt(a){let e,n;return e=new Se({props:{loading:a[0],variant:"danger",$$slots:{default:[Zt]},$$scope:{ctx:a}}}),e.$on("click",a[10]),{c(){F(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){P(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.loading=t[0]),l&134217728&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Zt(a){let e;return{c(){e=z("Delete")},l(n){e=U(n,"Delete")},m(n,t){O(n,e,t)},d(n){n&&v(e)}}}function xt(a){let e;return{c(){e=z("Cancel")},l(n){e=U(n,"Cancel")},m(n,t){O(n,e,t)},d(n){n&&v(e)}}}function en(a){let e;return{c(){e=z("Save")},l(n){e=U(n,"Save")},m(n,t){O(n,e,t)},d(n){n&&v(e)}}}function tn(a){let e,n,t=a[1]&&et(a);return{c(){t&&t.c(),e=ne()},l(l){t&&t.l(l),e=ne()},m(l,o){t&&t.m(l,o),O(l,e,o),n=!0},p(l,[o]){l[1]?t?(t.p(l,o),o&2&&h(t,1)):(t=et(l),t.c(),h(t,1),t.m(e.parentNode,e)):t&&(ee(),k(t,1,1,()=>{t=null}),te())},i(l){n||(h(t),n=!0)},o(l){k(t),n=!1},d(l){l&&v(e),t&&t.d(l)}}}function nn(a,e,n){let{loading:t=!1}=e,{bill:l}=e,{drawerId:o}=e,r=[],u=0,s={type:"monthly",start_date:Me(new Date,"yyyy-MM-dd"),until:Me(At(new Date,12),"yyyy-MM-dd")},f={paid:"scheduled",type:"unknown",from_bill:!0,account_id:0},g={transaction:f},i={source:"",amount:10,description:"",recurrence:s,meta_data:g},c,d,m;const w=(p,G)=>{const{value:S}=p.detail;if(i&&i.recurrence){switch(G){case"description":n(1,i.description=S,i);break;case"source":n(1,i.source=S,i);break;case"amount":n(1,i.amount=S,i);break;case"repeat-type":n(1,i.recurrence.type=S,i);break;case"repeat-start-date":n(1,i.recurrence.start_date=S,i);break;case"repeat-until-date":n(1,i.recurrence.until=S,i);break;case"meta-data-transaction-type":i?.meta_data?.transaction?.type&&n(1,i.meta_data.transaction.type=S,i);break;case"meta-data-transaction-account-id":n(3,f.account_id=S,f);break}n(2,r=Je(i.recurrence))}},N=()=>{const p=`[data-bs-target="#${o}"]`,G=document.querySelector(p);G&&(G.click(),n(11,l=void 0),n(13,u=void 0),n(1,i={source:"",amount:10,description:"",recurrence:s}))},H=async()=>{const p=await c.validateFieldIsInvalid(),G=await d.validateFieldIsInvalid(),S=await m.validateFieldIsInvalid();if(p||G||S)return;const{actions:{reload:J,createBill:ae,updateBill:we}}=$e();if(f?.account_id){const{meta_data:me}=i,{transaction:pe}=me;pe.account_id=f.account_id}i.id?await we(i.id,i):await ae(i),await J(),N()},K=async()=>{if(!i?.id)return;const{actions:{reload:p,deleteBill:G}}=$e();ct({title:"Delete Confirmation",message:"Are you sure you want to do this? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async S=>{i?.id&&(S&&await G(i.id),await p(),N())}})};function X(p){ge[p?"unshift":"push"](()=>{m=p,n(6,m)})}const ue=p=>w(p,"amount");function ce(p){ge[p?"unshift":"push"](()=>{c=p,n(4,c)})}const _e=p=>w(p,"description");function C(p){ge[p?"unshift":"push"](()=>{d=p,n(5,d)})}const y=p=>w(p,"source"),B=p=>w(p,"meta-data-transaction-account-id"),$=p=>w(p,"meta-data-transaction-type"),b=p=>w(p,"repeat-type"),Y=p=>w(p,"repeat-start-date"),q=p=>w(p,"repeat-until-date");return a.$$set=p=>{"loading"in p&&n(0,t=p.loading),"bill"in p&&n(11,l=p.bill),"drawerId"in p&&n(12,o=p.drawerId)},a.$$.update=()=>{if(a.$$.dirty&10242&&(!l||u!==l?.id)){n(1,i=l?{...i,...l,recurrence:{...s,...l.recurrence},meta_data:{...g,...l.meta_data}}:i);const{recurrence:p}=i;n(2,r=p?Je(p):[]),n(3,f.account_id=l?.meta_data?.transaction?.account_id,f),n(13,u=l?.id)}},[t,i,r,f,c,d,m,w,N,H,K,l,o,u,X,ue,ce,_e,C,y,B,$,b,Y,q]}class an extends ie{constructor(e){super(),oe(this,e,nn,tn,se,{loading:0,bill:11,drawerId:12})}}function rt(a,e,n){const t=a.slice();return t[8]=e[n],t}function st(a){let e,n,t=Le(a[1]),l=[];for(let r=0;r<t.length;r+=1)l[r]=ot(rt(a,t,r));const o=r=>k(l[r],1,1,()=>{l[r]=null});return{c(){for(let r=0;r<l.length;r+=1)l[r].c();e=ne()},l(r){for(let u=0;u<l.length;u+=1)l[u].l(r);e=ne()},m(r,u){for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(r,u);O(r,e,u),n=!0},p(r,u){if(u&31){t=Le(r[1]);let s;for(s=0;s<t.length;s+=1){const f=rt(r,t,s);l[s]?(l[s].p(f,u),h(l[s],1)):(l[s]=ot(f),l[s].c(),h(l[s],1),l[s].m(e.parentNode,e))}for(ee(),s=t.length;s<l.length;s+=1)o(s);te()}},i(r){if(!n){for(let u=0;u<t.length;u+=1)h(l[u]);n=!0}},o(r){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)k(l[u]);n=!1},d(r){r&&v(e),ut(l,r)}}}function ln(a){return{c:x,l:x,m:x,p:x,d:x}}function rn(a){let e,n=a[1]+"",t;return{c(){e=I("span"),t=z(n),this.h()},l(l){e=D(l,"SPAN",{class:!0});var o=T(e);t=U(o,n),o.forEach(v),this.h()},h(){E(e,"class","d-block text-warning")},m(l,o){O(l,e,o),_(e,t)},p(l,o){o&2&&n!==(n=l[1]+"")&&de(t,n)},d(l){l&&v(e)}}}function sn(a){let e;return{c(){e=z("loading ...")},l(n){e=U(n,"loading ...")},m(n,t){O(n,e,t)},p:x,d(n){n&&v(e)}}}function it(a){let e,n;return e=new St({props:{type:a[8].meta_data.transaction.type}}),{c(){F(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){P(e,t,l),n=!0},p(t,l){const o={};l&2&&(o.type=t[8].meta_data.transaction.type),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function ot(a){let e,n,t=a[8].description+"",l,o,r,u,s,f=a[8].source+"",g,i,c,d,m=a[8]?.recurrence?.type+"",w,N,H=a[8]?.recurrence?.start_date+"",K,X,ue,ce,_e,C,y,B=Qe(a[8].amount)+"",$,b,Y,q,p='<i class="bi bi-three-dots-vertical"></i>',G,S,Z,J,ae,we='<span>Edit</span> <i class="bi bi-pencil-fill"></i>',me,pe,he,le,Ve='<span class="d-flex justify-content-between"><span>Delete</span> <i class="bi bi-trash-fill"></i></span>',Fe,W,Ae,Oe,Q={ctx:a,current:null,token:null,hasCatch:!1,pending:sn,then:rn,catch:ln,value:1};We(ue=a[4](a[8]?.meta_data?.transaction?.account_id),Q);let R=a[8]?.meta_data?.transaction&&it(a);function gt(){return a[5](a[8])}function _t(){return a[6](a[8])}return{c(){e=I("div"),n=I("div"),l=z(t),o=M(),r=I("div"),u=I("div"),s=I("div"),g=z(f),i=M(),c=I("div"),d=I("span"),w=z(m),N=z(`
						Bill starting `),K=z(H),X=M(),Q.block.c(),ce=M(),R&&R.c(),_e=M(),C=I("div"),y=I("span"),$=z(B),b=M(),Y=I("div"),q=I("span"),q.innerHTML=p,G=M(),S=I("ul"),Z=I("li"),J=I("button"),ae=I("span"),ae.innerHTML=we,pe=M(),he=I("li"),le=I("button"),le.innerHTML=Ve,Fe=M(),this.h()},l(re){e=D(re,"DIV",{});var j=T(e);n=D(j,"DIV",{class:!0});var Re=T(n);l=U(Re,t),Re.forEach(v),o=L(j),r=D(j,"DIV",{class:!0});var Ie=T(r);u=D(Ie,"DIV",{class:!0});var fe=T(u);s=D(fe,"DIV",{class:!0});var Ye=T(s);g=U(Ye,f),Ye.forEach(v),i=L(fe),c=D(fe,"DIV",{class:!0});var De=T(c);d=D(De,"SPAN",{class:!0});var je=T(d);w=U(je,m),je.forEach(v),N=U(De,`
						Bill starting `),K=U(De,H),De.forEach(v),X=L(fe),Q.block.l(fe),ce=L(fe),R&&R.l(fe),fe.forEach(v),_e=L(Ie),C=D(Ie,"DIV",{class:!0});var Ce=T(C);y=D(Ce,"SPAN",{});var He=T(y);$=U(He,B),He.forEach(v),b=L(Ce),Y=D(Ce,"DIV",{class:!0});var Ee=T(Y);q=D(Ee,"SPAN",{"data-bs-toggle":!0,"aria-expanded":!0,"data-svelte-h":!0}),Te(q)!=="svelte-8w8uzy"&&(q.innerHTML=p),G=L(Ee),S=D(Ee,"UL",{class:!0});var ye=T(S);Z=D(ye,"LI",{});var qe=T(Z);J=D(qe,"BUTTON",{type:!0,class:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var ze=T(J);ae=D(ze,"SPAN",{class:!0,"data-svelte-h":!0}),Te(ae)!=="svelte-1rb2cm0"&&(ae.innerHTML=we),ze.forEach(v),qe.forEach(v),pe=L(ye),he=D(ye,"LI",{});var Ue=T(he);le=D(Ue,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Te(le)!=="svelte-1bk09ub"&&(le.innerHTML=Ve),Ue.forEach(v),ye.forEach(v),Ee.forEach(v),Ce.forEach(v),Ie.forEach(v),Fe=L(j),j.forEach(v),this.h()},h(){E(n,"class","fw-bold"),E(s,"class","fw-light"),E(d,"class","text-capitalize"),E(c,"class","fw-lighter text-muted small"),E(u,"class","small"),E(q,"data-bs-toggle","dropdown"),E(q,"aria-expanded","false"),E(ae,"class","d-flex justify-content-between"),E(J,"type","button"),E(J,"class","dropdown-item"),E(J,"data-bs-toggle","offcanvas"),E(J,"data-bs-target",me="#"+a[0]),E(J,"aria-controls",a[0]),E(le,"type","button"),E(le,"class","dropdown-item"),E(S,"class","dropdown-menu dropdown-menu-dark"),E(Y,"class","dropdown"),E(C,"class","d-flex align-items-end gap-2"),E(r,"class","d-flex justify-content-between")},m(re,j){O(re,e,j),_(e,n),_(n,l),_(e,o),_(e,r),_(r,u),_(u,s),_(s,g),_(u,i),_(u,c),_(c,d),_(d,w),_(c,N),_(c,K),_(u,X),Q.block.m(u,Q.anchor=null),Q.mount=()=>u,Q.anchor=ce,_(u,ce),R&&R.m(u,null),_(r,_e),_(r,C),_(C,y),_(y,$),_(C,b),_(C,Y),_(Y,q),_(Y,G),_(Y,S),_(S,Z),_(Z,J),_(J,ae),_(S,pe),_(S,he),_(he,le),_(e,Fe),W=!0,Ae||(Oe=[Ke(J,"click",gt),Ke(le,"click",_t)],Ae=!0)},p(re,j){a=re,(!W||j&2)&&t!==(t=a[8].description+"")&&de(l,t),(!W||j&2)&&f!==(f=a[8].source+"")&&de(g,f),(!W||j&2)&&m!==(m=a[8]?.recurrence?.type+"")&&de(w,m),(!W||j&2)&&H!==(H=a[8]?.recurrence?.start_date+"")&&de(K,H),Q.ctx=a,j&2&&ue!==(ue=a[4](a[8]?.meta_data?.transaction?.account_id))&&We(ue,Q)||Ft(Q,a,j),a[8]?.meta_data?.transaction?R?(R.p(a,j),j&2&&h(R,1)):(R=it(a),R.c(),h(R,1),R.m(u,null)):R&&(ee(),k(R,1,1,()=>{R=null}),te()),(!W||j&2)&&B!==(B=Qe(a[8].amount)+"")&&de($,B),(!W||j&1&&me!==(me="#"+a[0]))&&E(J,"data-bs-target",me),(!W||j&1)&&E(J,"aria-controls",a[0])},i(re){W||(h(R),W=!0)},o(re){k(R),W=!1},d(re){re&&v(e),Q.block.d(),Q.token=null,Q=null,R&&R.d(),Ae=!1,vt(Oe)}}}function on(a){let e,n,t=a[1].length&&st(a);return{c(){t&&t.c(),e=ne()},l(l){t&&t.l(l),e=ne()},m(l,o){t&&t.m(l,o),O(l,e,o),n=!0},p(l,[o]){l[1].length?t?(t.p(l,o),o&2&&h(t,1)):(t=st(l),t.c(),h(t,1),t.m(e.parentNode,e)):t&&(ee(),k(t,1,1,()=>{t=null}),te())},i(l){n||(h(t),n=!0)},o(l){k(t),n=!1},d(l){l&&v(e),t&&t.d(l)}}}function un(a,e,n){let{data:t=[]}=e,{drawerId:l=""}=e;const{actions:{getAccount:o}}=Lt(),r=async i=>{if(!i)return;const{actions:{canDeleteBill:c,deleteBill:d,reload:m}}=$e(),w=await c(i);ct({title:"Delete Confirmation",message:w?"Are you sure you want to do this? You won't be able to undo this.":"There are uses of this bill in transactions. You cannot delete it",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",confirmButtonHide:!w,rejectButtonLabel:w?"No":"Close",callback:async H=>{i&&H&&w&&(await d(i),await m())}})},u=i=>{const{stores:{targetBill:c,loading:d}}=$e();d.set(!0),setTimeout(()=>{c.set(i),d.set(!1)},800)},s=async i=>i?(await o(i))?.name??"":"",f=i=>u(i),g=i=>r(i.id);return a.$$set=i=>{"data"in i&&n(1,t=i.data),"drawerId"in i&&n(0,l=i.drawerId)},[l,t,r,u,s,f,g]}class cn extends ie{constructor(e){super(),oe(this,e,un,on,se,{data:1,drawerId:0})}}function fn(a){let e,n;return e=new It({}),{c(){F(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){P(e,t,l),n=!0},p:x,i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function dn(a){let e,n,t;function l(r){a[8](r)}let o={bill:a[0],drawerId:ve};return a[2]!==void 0&&(o.loading=a[2]),e=new an({props:o}),ge.push(()=>ke(e,"loading",l)),{c(){F(e.$$.fragment)},l(r){A(e.$$.fragment,r)},m(r,u){P(e,r,u),t=!0},p(r,u){const s={};u&1&&(s.bill=r[0]),!n&&u&4&&(n=!0,s.loading=r[2],be(()=>n=!1)),e.$set(s)},i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){V(e,r)}}}function gn(a){let e,n,t,l;const o=[dn,fn],r=[];function u(s,f){return s[2]?1:0}return e=u(a),n=r[e]=o[e](a),{c(){n.c(),t=ne()},l(s){n.l(s),t=ne()},m(s,f){r[e].m(s,f),O(s,t,f),l=!0},p(s,f){let g=e;e=u(s),e===g?r[e].p(s,f):(ee(),k(r[g],1,1,()=>{r[g]=null}),te(),n=r[e],n?n.p(s,f):(n=r[e]=o[e](s),n.c()),h(n,1),n.m(t.parentNode,t))},i(s){l||(h(n),l=!0)},o(s){k(n),l=!1},d(s){s&&v(t),r[e].d(s)}}}function _n(a){let e;return{c(){e=I("i"),this.h()},l(n){e=D(n,"I",{class:!0}),T(e).forEach(v),this.h()},h(){E(e,"class","bi bi-plus")},m(n,t){O(n,e,t)},p:x,d(n){n&&v(e)}}}function mn(a){let e,n,t,l,o,r,u,s,f;return e=new wt({props:{title:a[1],id:ve,$$slots:{default:[gn]},$$scope:{ctx:a}}}),r=new Se({props:{variant:"primary",size:"sm","data-bs-toggle":"offcanvas","data-bs-target":"#"+ve,"aria-controls":ve,$$slots:{default:[_n]},$$scope:{ctx:a}}}),r.$on("click",a[7]),s=new cn({props:{drawerId:ve,data:a[3]}}),{c(){F(e.$$.fragment),n=M(),t=I("div"),l=I("div"),o=I("div"),F(r.$$.fragment),u=M(),F(s.$$.fragment),this.h()},l(g){A(e.$$.fragment,g),n=L(g),t=D(g,"DIV",{class:!0});var i=T(t);l=D(i,"DIV",{class:!0});var c=T(l);o=D(c,"DIV",{});var d=T(o);A(r.$$.fragment,d),d.forEach(v),c.forEach(v),u=L(i),A(s.$$.fragment,i),i.forEach(v),this.h()},h(){E(l,"class","d-flex justify-content-end align-items-center"),E(t,"class","d-flex flex-column gap-3")},m(g,i){P(e,g,i),O(g,n,i),O(g,t,i),_(t,l),_(l,o),P(r,o,null),_(t,u),P(s,t,null),f=!0},p(g,[i]){const c={};i&2&&(c.title=g[1]),i&2053&&(c.$$scope={dirty:i,ctx:g}),e.$set(c);const d={};i&2048&&(d.$$scope={dirty:i,ctx:g}),r.$set(d);const m={};i&8&&(m.data=g[3]),s.$set(m)},i(g){f||(h(e.$$.fragment,g),h(r.$$.fragment,g),h(s.$$.fragment,g),f=!0)},o(g){k(e.$$.fragment,g),k(r.$$.fragment,g),k(s.$$.fragment,g),f=!1},d(g){g&&(v(n),v(t)),V(e,g),V(r),V(s)}}}const ve="bill-form";function pn(a,e,n){let t,l,o,r;const{stores:{data:u,targetBill:s,loading:f},actions:{reload:g}}=$e();Pe(a,u,m=>n(3,r=m)),Pe(a,s,m=>n(0,l=m)),Pe(a,f,m=>n(2,o=m));const i={description:"",source:"",amount:0},c=()=>{f.set(!0),setTimeout(()=>{s.set(i),f.set(!1)},1500)};$t(g),bt(Mt);function d(m){o=m,f.set(o)}return a.$$.update=()=>{a.$$.dirty&1&&n(1,t=l?.id?"Edit Bill":"Create Bill")},[l,t,o,r,u,s,f,c,d]}class hn extends ie{constructor(e){super(),oe(this,e,pn,mn,se,{})}}function vn(a){let e,n;return e=new hn({}),{c(){F(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){P(e,t,l),n=!0},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function $n(a){let e,n;return e=new kt({props:{pageTitle:"Bills",$$slots:{default:[vn]},$$scope:{ctx:a}}}),{c(){F(e.$$.fragment)},l(t){A(e.$$.fragment,t)},m(t,l){P(e,t,l),n=!0},p(t,[l]){const o={};l&1&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){n||(h(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}class Sn extends ie{constructor(e){super(),oe(this,e,null,$n,se,{})}}export{Sn as component,Tn as universal};
