import{s as Ie,A as Ce,o as Y,f as v,e as y,d as N,t as be,j as b,k as C,l as Q,i as A,m as ve,n as _,B as X,p as o,J as ae,I as U,q as De,y as qe,w as ze,G as Me,r as Fe,v as Re,L as Ye}from"../chunks/scheduler.BYuDQn6a.js";import{S as ke,i as Te,t as x,g as Ge,a as ee,e as Je,c as ue,b as de,m as fe,d as ce}from"../chunks/index.DqhcTbDs.js";import{P as Ke}from"../chunks/PageLayout.C9BRc7Y8.js";import{e as Be}from"../chunks/Header.B3iuWz3u.js";import{f as Z,p as R,c as Qe,D as We}from"../chunks/confirm.service.FT-4zV1u.js";import{S as Xe}from"../chunks/Spinner.qZAGg6o7.js";import{g as Ze,u as xe,c as $e,d as et}from"../chunks/budget.api.Dojmk0O6.js";import{w as Le}from"../chunks/index.s7t9l1rZ.js";import{f as Pe}from"../chunks/app.state.D4d-W_z-.js";const tt=!0,wt=Object.freeze(Object.defineProperty({__proto__:null,prerender:tt},Symbol.toStringTag,{value:"Module"})),we={start_at:Z(new Date,"yyyy-MM-dd"),end_at:Z(new Date,"yyyy-MM-dd"),settings:{max_spend_limit:0}};let $=null;const st=()=>{const n=Le(!1),t=Le([]);return $={stores:{loading:n,data:t},actions:{reload:async()=>{n.set(!0);const e=await Ze();t.set(e),n.set(!1)}}},$},Ue=()=>$?.stores&&Object.keys($.stores).length>0&&$?.actions&&Object.keys($.actions).length>0?$:st();function Ne(n){let t,s,e,l="Start Date*",u,d,M,i,c,D,a="End Date*",E,m,g,f,h,T,j="Max Limit*",z,S,B,k,I,V,q=n[14].message+"",O,G,re,J,K,oe,te,H,se,L,ie,me;K=new Xe({props:{size:"xs"}});let P=n[6]&&Ae(n);function _e(p,w){return p[6]?at:nt}let ne=_e(n),F=ne(n),r=n[15]&&Oe();return{c(){t=y("div"),s=y("div"),e=y("div"),e.textContent=l,u=N(),d=y("input"),i=N(),c=y("div"),D=y("div"),D.textContent=a,E=N(),m=y("input"),f=N(),h=y("div"),T=y("div"),T.textContent=j,z=N(),S=y("input"),k=N(),I=y("div"),V=y("small"),O=be(q),re=N(),J=y("span"),ue(K.$$.fragment),oe=N(),P&&P.c(),te=N(),H=y("button"),F.c(),se=N(),r&&r.c(),this.h()},l(p){t=b(p,"DIV",{class:!0});var w=C(t);s=b(w,"DIV",{class:!0});var pe=C(s);e=b(pe,"DIV",{"data-svelte-h":!0}),Q(e)!=="svelte-172ibe4"&&(e.textContent=l),u=A(pe),d=b(pe,"INPUT",{name:!0,type:!0,class:!0}),pe.forEach(v),i=A(w),c=b(w,"DIV",{class:!0});var ge=C(c);D=b(ge,"DIV",{"data-svelte-h":!0}),Q(D)!=="svelte-1iotazt"&&(D.textContent=a),E=A(ge),m=b(ge,"INPUT",{name:!0,type:!0,class:!0}),ge.forEach(v),f=A(w),h=b(w,"DIV",{class:!0});var he=C(h);T=b(he,"DIV",{"data-svelte-h":!0}),Q(T)!=="svelte-16dil7f"&&(T.textContent=j),z=A(he),S=b(he,"INPUT",{name:!0,type:!0,class:!0}),he.forEach(v),k=A(w),I=b(w,"DIV",{class:!0});var W=C(I);V=b(W,"SMALL",{class:!0});var Se=C(V);O=ve(Se,q),Se.forEach(v),re=A(W),J=b(W,"SPAN",{});var Ee=C(J);de(K.$$.fragment,Ee),Ee.forEach(v),oe=A(W),P&&P.l(W),te=A(W),H=b(W,"BUTTON",{class:!0});var ye=C(H);F.l(ye),se=A(ye),r&&r.l(ye),ye.forEach(v),W.forEach(v),w.forEach(v),this.h()},h(){_(d,"name",M=n[1]+"-start-date"),_(d,"type","date"),_(d,"class","form-control"),d.disabled=n[10],d.required=!0,X(d,"is-invalid",n[8]),_(s,"class","d-flex flex-column gap-2"),_(m,"name",g=n[1]+"-end-date"),_(m,"type","date"),_(m,"class","form-control"),m.disabled=n[10],m.required=!0,X(m,"is-invalid",n[7]),_(c,"class","d-flex flex-column gap-2"),_(S,"name",B=n[1]+"-max-limit"),_(S,"type","text"),_(S,"class","form-control text-end"),S.disabled=n[10],S.required=!0,X(S,"is-invalid",n[9]),_(h,"class","d-flex flex-column gap-2"),_(V,"class",G="fw-lighter fst-italic text-"+n[14].type),X(J,"d-none",!n[10]),_(H,"class","btn btn-primary position-relative"),_(I,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),_(t,"class","d-flex flex-column gap-4")},m(p,w){Y(p,t,w),o(t,s),o(s,e),o(s,u),o(s,d),n[21](d),ae(d,n[2]),o(t,i),o(t,c),o(c,D),o(c,E),o(c,m),n[25](m),ae(m,n[3]),o(t,f),o(t,h),o(h,T),o(h,z),o(h,S),n[29](S),ae(S,n[4]),o(t,k),o(t,I),o(I,V),o(V,O),o(I,re),o(I,J),fe(K,J,null),o(I,oe),P&&P.m(I,null),o(I,te),o(I,H),F.m(H,null),o(H,se),r&&r.m(H,null),L=!0,ie||(me=[U(d,"focus",n[22]),U(d,"keyup",n[23]),U(d,"input",n[24]),U(m,"focus",n[26]),U(m,"keyup",n[27]),U(m,"input",n[28]),U(S,"focus",n[30]),U(S,"keyup",n[31]),U(S,"input",n[32]),U(H,"click",n[17])],ie=!0)},p(p,w){(!L||w[0]&2&&M!==(M=p[1]+"-start-date"))&&_(d,"name",M),(!L||w[0]&1024)&&(d.disabled=p[10]),w[0]&4&&ae(d,p[2]),(!L||w[0]&256)&&X(d,"is-invalid",p[8]),(!L||w[0]&2&&g!==(g=p[1]+"-end-date"))&&_(m,"name",g),(!L||w[0]&1024)&&(m.disabled=p[10]),w[0]&8&&ae(m,p[3]),(!L||w[0]&128)&&X(m,"is-invalid",p[7]),(!L||w[0]&2&&B!==(B=p[1]+"-max-limit"))&&_(S,"name",B),(!L||w[0]&1024)&&(S.disabled=p[10]),w[0]&16&&S.value!==p[4]&&ae(S,p[4]),(!L||w[0]&512)&&X(S,"is-invalid",p[9]),(!L||w[0]&16384)&&q!==(q=p[14].message+"")&&De(O,q),(!L||w[0]&16384&&G!==(G="fw-lighter fst-italic text-"+p[14].type))&&_(V,"class",G),(!L||w[0]&1024)&&X(J,"d-none",!p[10]),p[6]?P?P.p(p,w):(P=Ae(p),P.c(),P.m(I,te)):P&&(P.d(1),P=null),ne!==(ne=_e(p))&&(F.d(1),F=ne(p),F&&(F.c(),F.m(H,se))),p[15]?r||(r=Oe(),r.c(),r.m(H,null)):r&&(r.d(1),r=null)},i(p){L||(x(K.$$.fragment,p),L=!0)},o(p){ee(K.$$.fragment,p),L=!1},d(p){p&&v(t),n[21](null),n[25](null),n[29](null),ce(K),P&&P.d(),F.d(),r&&r.d(),ie=!1,qe(me)}}}function Ae(n){let t,s="<span>Delete</span>",e,l;return{c(){t=y("button"),t.innerHTML=s,this.h()},l(u){t=b(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(t)!=="svelte-4hjfsp"&&(t.innerHTML=s),this.h()},h(){_(t,"class","btn btn-danger position-relative")},m(u,d){Y(u,t,d),e||(l=U(t,"click",n[16]),e=!0)},p:ze,d(u){u&&v(t),e=!1,l()}}}function nt(n){let t,s="Create";return{c(){t=y("span"),t.textContent=s},l(e){t=b(e,"SPAN",{"data-svelte-h":!0}),Q(t)!=="svelte-1wf0js6"&&(t.textContent=s)},m(e,l){Y(e,t,l)},d(e){e&&v(t)}}}function at(n){let t,s="Save";return{c(){t=y("span"),t.textContent=s},l(e){t=b(e,"SPAN",{"data-svelte-h":!0}),Q(t)!=="svelte-l126tb"&&(t.textContent=s)},m(e,l){Y(e,t,l)},d(e){e&&v(t)}}}function Oe(n){let t,s='<span class="visually-hidden">Item not saved</span>';return{c(){t=y("span"),t.innerHTML=s,this.h()},l(e){t=b(e,"SPAN",{class:!0,"data-svelte-h":!0}),Q(t)!=="svelte-1sxrz4i"&&(t.innerHTML=s),this.h()},h(){_(t,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(e,l){Y(e,t,l)},d(e){e&&v(t)}}}function lt(n){let t,s,e=n[0]&&Ne(n);return{c(){e&&e.c(),t=Ce()},l(l){e&&e.l(l),t=Ce()},m(l,u){e&&e.m(l,u),Y(l,t,u),s=!0},p(l,u){l[0]?e?(e.p(l,u),u[0]&1&&x(e,1)):(e=Ne(l),e.c(),x(e,1),e.m(t.parentNode,t)):e&&(Ge(),ee(e,1,1,()=>{e=null}),Je())},i(l){s||(x(e),s=!0)},o(l){ee(e),s=!1},d(l){l&&v(t),e&&e.d(l)}}}function rt(n,t,s){let e,l,u,d,M,i,{name:c=""}=t,{drawerId:D=""}=t,{budget:a}=t;const{actions:{reload:E}}=Ue();let m=!1,g,f,h,T=0,j,z,S,B={message:"",type:"info"},k,I={startDate:!1,endDate:!1,amount:!1};const V=()=>{const r=`[data-bs-target="#${D}"]`,p=document.querySelector(r);p&&p.click()},q=()=>{s(5,I={amount:!1,startDate:!1,endDate:!1}),s(0,a={...we}),s(10,m=!1)},O=(r,p=0,w="info")=>{s(14,B.message=r,B),s(14,B.type=w,B),p&&setTimeout(()=>{s(14,B.message="",B)},p)},G=async()=>{if(!e){O("ID is not defined",0,"danger");return}try{await et(e),await E(!0),setTimeout(()=>{s(10,m=!1),s(20,k={...a,id:e,start_at:R(g,"yyyy-MM-dd",new Date).toISOString(),end_at:R(f,"yyyy-MM-dd",new Date).toISOString()}),O("Transaction Deleted",3e3,"success"),V()},800)}catch(r){setTimeout(()=>{s(10,m=!1),console.error("Save failed:",r),O("Failed to save event. Please try again.",7e3,"danger")},800)}},re=()=>{s(10,m=!0),Qe({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async r=>{r&&await G(),await E(!0),q()}})},J=async()=>{if(!l){O("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!i){let r=[];M&&r.push("Amount is invalid"),u&&r.push("Start date is invalid"),d&&r.push("End date is invalid"),O(r.join(". ")+".  Please address accordingly.",0,"danger");return}if(!m){O("Saving ..."),s(10,m=!0);try{const r={...a,start_at:R(g,"yyyy-MM-dd",new Date).toISOString(),end_at:R(f,"yyyy-MM-dd",new Date).toISOString(),settings:{...a.settings,max_spend_limit:h}};e?await xe(e,r):await $e(r),await E(!0),setTimeout(()=>{s(10,m=!1),s(20,k={...a,id:e}),O("Saved",3e3,"success"),e||q(),V()},800)}catch(r){setTimeout(()=>{s(10,m=!1),console.error("Save failed:",r),O("Failed to save event. Please try again.",7e3,"danger"),e||q()},800)}}};function K(r){Me[r?"unshift":"push"](()=>{j=r,s(11,j)})}const oe=()=>j.select(),te=()=>s(5,I.startDate=!0,I);function H(){g=this.value,s(2,g),s(0,a),s(19,T),s(6,e)}function se(r){Me[r?"unshift":"push"](()=>{z=r,s(12,z)})}const L=()=>z.select(),ie=()=>s(5,I.endDate=!0,I);function me(){f=this.value,s(3,f),s(0,a),s(19,T),s(6,e)}function P(r){Me[r?"unshift":"push"](()=>{S=r,s(13,S)})}const _e=()=>S.select(),ne=()=>s(5,I.amount=!0,I);function F(){h=this.value,s(4,h),s(0,a),s(19,T),s(6,e)}return n.$$set=r=>{"name"in r&&s(1,c=r.name),"drawerId"in r&&s(18,D=r.drawerId),"budget"in r&&s(0,a=r.budget)},n.$$.update=()=>{n.$$.dirty[0]&1&&s(6,e=a?.id),n.$$.dirty[0]&524353&&a&&T!==e&&(s(10,m=!0),setTimeout(()=>{s(20,k={...a}),s(19,T=e),s(4,h=a.settings?.max_spend_limit??0),s(2,g=Z(R(a.start_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(3,f=Z(R(a.end_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(10,m=!1)},800)),n.$$.dirty[0]&1048604&&s(15,l=k?.start_at!==g||k?.end_at!==f||k?.settings?.max_spend_limit!==h),n.$$.dirty[0]&33&&s(8,u=I.startDate&&a?.start_at===""),n.$$.dirty[0]&33&&s(7,d=I.endDate&&a?.end_at===""),n.$$.dirty[0]&33&&s(9,M=I.amount&&a?.settings?.max_spend_limit===0),n.$$.dirty[0]&896&&(i=!u&&!d&&!M)},[a,c,g,f,h,I,e,d,u,M,m,j,z,S,B,l,re,J,D,T,k,K,oe,te,H,se,L,ie,me,P,_e,ne,F]}class ot extends ke{constructor(t){super(),Te(this,t,rt,lt,Ie,{name:1,drawerId:18,budget:0},null,[-1,-1])}}function je(n,t,s){const e=n.slice();return e[8]=t[s],e}function it(n){let t,s;return t=new ot({props:{name:"budget-form",drawerId:le,budget:n[0]}}),{c(){ue(t.$$.fragment)},l(e){de(t.$$.fragment,e)},m(e,l){fe(t,e,l),s=!0},p(e,l){const u={};l&1&&(u.budget=e[0]),t.$set(u)},i(e){s||(x(t.$$.fragment,e),s=!0)},o(e){ee(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}function Ve(n){let t,s,e,l='<tr><th scope="col" class="fw-light text-muted">Start</th> <th scope="col" class="fw-light text-muted">End</th> <th scope="col" class="text-end">Max Limit</th> <th scope="col"></th></tr>',u,d,M=Be(n[2]),i=[];for(let c=0;c<M.length;c+=1)i[c]=He(je(n,M,c));return{c(){t=y("div"),s=y("table"),e=y("thead"),e.innerHTML=l,u=N(),d=y("tbody");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){t=b(c,"DIV",{class:!0});var D=C(t);s=b(D,"TABLE",{class:!0});var a=C(s);e=b(a,"THEAD",{"data-svelte-h":!0}),Q(e)!=="svelte-22a6sv"&&(e.innerHTML=l),u=A(a),d=b(a,"TBODY",{});var E=C(d);for(let m=0;m<i.length;m+=1)i[m].l(E);E.forEach(v),a.forEach(v),D.forEach(v),this.h()},h(){_(s,"class","table"),_(t,"class","table-responsive")},m(c,D){Y(c,t,D),o(t,s),o(s,e),o(s,u),o(s,d);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(d,null)},p(c,D){if(D&20){M=Be(c[2]);let a;for(a=0;a<M.length;a+=1){const E=je(c,M,a);i[a]?i[a].p(E,D):(i[a]=He(E),i[a].c(),i[a].m(d,null))}for(;a<i.length;a+=1)i[a].d(1);i.length=M.length}},d(c){c&&v(t),Ye(i,c)}}}function He(n){let t,s,e=Z(R(n[8].start_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"",l,u,d,M=Z(R(n[8].end_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"",i,c,D,a=Pe(n[8]?.settings?.max_spend_limit)+"",E,m,g,f,h,T,j,z;function S(){return n[6](n[8])}return{c(){t=y("tr"),s=y("td"),l=be(e),u=N(),d=y("td"),i=be(M),c=N(),D=y("td"),E=be(a),m=N(),g=y("td"),f=y("button"),h=y("i"),T=N(),this.h()},l(B){t=b(B,"TR",{});var k=C(t);s=b(k,"TD",{class:!0});var I=C(s);l=ve(I,e),I.forEach(v),u=A(k),d=b(k,"TD",{class:!0});var V=C(d);i=ve(V,M),V.forEach(v),c=A(k),D=b(k,"TD",{class:!0});var q=C(D);E=ve(q,a),q.forEach(v),m=A(k),g=b(k,"TD",{class:!0});var O=C(g);f=b(O,"BUTTON",{"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0,class:!0});var G=C(f);h=b(G,"I",{class:!0}),C(h).forEach(v),G.forEach(v),O.forEach(v),T=A(k),k.forEach(v),this.h()},h(){_(s,"class","fw-light text-muted"),_(d,"class","fw-light text-muted"),_(D,"class","text-end"),_(h,"class","bi bi-pencil"),_(f,"data-bs-toggle","offcanvas"),_(f,"data-bs-target","#"+le),_(f,"aria-controls",le),_(f,"class","btn btn-sm btn-primary"),_(g,"class","d-flex justify-content-end")},m(B,k){Y(B,t,k),o(t,s),o(s,l),o(t,u),o(t,d),o(d,i),o(t,c),o(t,D),o(D,E),o(t,m),o(t,g),o(g,f),o(f,h),o(t,T),j||(z=U(f,"click",S),j=!0)},p(B,k){n=B,k&4&&e!==(e=Z(R(n[8].start_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"")&&De(l,e),k&4&&M!==(M=Z(R(n[8].end_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"")&&De(i,M),k&4&&a!==(a=Pe(n[8]?.settings?.max_spend_limit)+"")&&De(E,a)},d(B){B&&v(t),j=!1,z()}}}function ut(n){let t,s,e,l,u,d="Budgets",M,i,c,D,a,E,m;t=new We({props:{title:n[1],id:le,$$slots:{default:[it]},$$scope:{ctx:n}}});let g=n[2].length&&Ve(n);return{c(){ue(t.$$.fragment),s=N(),e=y("div"),l=y("div"),u=y("h2"),u.textContent=d,M=N(),i=y("button"),c=y("i"),D=N(),g&&g.c(),this.h()},l(f){de(t.$$.fragment,f),s=A(f),e=b(f,"DIV",{class:!0});var h=C(e);l=b(h,"DIV",{class:!0});var T=C(l);u=b(T,"H2",{"data-svelte-h":!0}),Q(u)!=="svelte-b0epp8"&&(u.textContent=d),M=A(T),i=b(T,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var j=C(i);c=b(j,"I",{class:!0}),C(c).forEach(v),j.forEach(v),T.forEach(v),D=A(h),g&&g.l(h),h.forEach(v),this.h()},h(){_(c,"class","bi bi-plus"),_(i,"class","btn btn-sm btn-secondary"),_(i,"type","button"),_(i,"data-bs-toggle","offcanvas"),_(i,"data-bs-target","#"+le),_(i,"aria-controls",le),_(l,"class","d-flex justify-content-between align-items-center"),_(e,"class","d-flex flex-column gap-3")},m(f,h){fe(t,f,h),Y(f,s,h),Y(f,e,h),o(e,l),o(l,u),o(l,M),o(l,i),o(i,c),o(e,D),g&&g.m(e,null),a=!0,E||(m=U(i,"click",n[5]),E=!0)},p(f,[h]){const T={};h&2&&(T.title=f[1]),h&2049&&(T.$$scope={dirty:h,ctx:f}),t.$set(T),f[2].length?g?g.p(f,h):(g=Ve(f),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},i(f){a||(x(t.$$.fragment,f),a=!0)},o(f){ee(t.$$.fragment,f),a=!1},d(f){f&&(v(s),v(e)),ce(t,f),g&&g.d(),E=!1,m()}}}const le="budgets-form";function dt(n,t,s){let e,l;const{stores:{data:u},actions:{reload:d}}=Ue();Fe(n,u,a=>s(2,l=a));let M=we;const i=a=>{s(0,M=a)};Re(()=>d(!0));const c=()=>i({...we}),D=a=>i({...a});return n.$$.update=()=>{n.$$.dirty&1&&s(1,e=M?.id?"Edit Budget":"Create Budget")},[M,e,l,u,i,c,D]}class ft extends ke{constructor(t){super(),Te(this,t,dt,ut,Ie,{})}}function ct(n){let t,s;return t=new ft({}),{c(){ue(t.$$.fragment)},l(e){de(t.$$.fragment,e)},m(e,l){fe(t,e,l),s=!0},i(e){s||(x(t.$$.fragment,e),s=!0)},o(e){ee(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}function mt(n){let t,s;return t=new Ke({props:{pageTitle:"Budgets",$$slots:{default:[ct]},$$scope:{ctx:n}}}),{c(){ue(t.$$.fragment)},l(e){de(t.$$.fragment,e)},m(e,l){fe(t,e,l),s=!0},p(e,[l]){const u={};l&1&&(u.$$scope={dirty:l,ctx:e}),t.$set(u)},i(e){s||(x(t.$$.fragment,e),s=!0)},o(e){ee(t.$$.fragment,e),s=!1},d(e){ce(t,e)}}}class It extends ke{constructor(t){super(),Te(this,t,null,mt,Ie,{})}}export{It as component,wt as universal};
