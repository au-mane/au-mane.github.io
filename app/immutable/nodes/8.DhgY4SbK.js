import{a8 as mt,a9 as pt,X as ye,Z as ht,s as oe,F as _e,a6 as be,E as Le,A as ae,o as O,w as ee,f as b,e as I,t as z,d as M,j as C,k as y,m as U,i as L,n as D,p as m,q as ge,M as ut,l as Be,D as Ke,y as vt,r as Pe,v as $t,a7 as bt}from"../chunks/scheduler.CBku5hu2.js";import{g as te,a as k,e as ne,t as $,S as ue,i as ce,f as ke,c as F,b as N,m as A,d as P}from"../chunks/index.EWtk3-rK.js";import{P as kt}from"../chunks/PageLayout.Dcj36uxz.js";import{B as Te,c as ct,D as wt,F as It}from"../chunks/FormSkeleton.DWivrZgw.js";import{c as Xe,D as ft,f as Se}from"../chunks/DateField.Co8gF1Mz.js";import{B as Ct,R as Dt,g as Ze,D as Et,A as yt,S as Bt,C as Tt,a as St,b as $e,c as Mt,d as Lt}from"../chunks/BillTypeBadge.GrEyswZd.js";import{S as dt,g as Ft}from"../chunks/SelectField.B1RaVDX1.js";import{e as Me}from"../chunks/Header.CXyzlo_a.js";import{t as Nt,f as Ge}from"../chunks/app.state.DHupu0TR.js";function Je(a,e){const n=e.token={};function t(l,o,r,u){if(e.token!==n)return;e.resolved=u;let s=e.ctx;r!==void 0&&(s=s.slice(),s[r]=u);const f=l&&(e.current=l)(s);let d=!1;e.block&&(e.blocks?e.blocks.forEach((i,c)=>{c!==o&&i&&(te(),k(i,1,1,()=>{e.blocks[c]===i&&(e.blocks[c]=null)}),ne())}):e.block.d(1),f.c(),$(f,1),f.m(e.mount(),e.anchor),d=!0),e.block=f,e.blocks&&(e.blocks[o]=f),d&&ht()}if(mt(a)){const l=pt();if(a.then(o=>{ye(l),t(e.then,1,e.value,o),ye(null)},o=>{if(ye(l),t(e.catch,2,e.error,o),ye(null),!e.hasCatch)throw o}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,a),!0;e.resolved=a}}function At(a,e,n){const t=e.slice(),{resolved:l}=a;a.current===a.then&&(t[a.value]=l),a.current===a.catch&&(t[a.error]=l),a.block.p(t,n)}function Pt(a,e){const n=Nt(a);if(isNaN(e))return Xe(a,NaN);const t=n.getDate(),l=Xe(a,n.getTime());l.setMonth(n.getMonth()+e+1,0);const o=l.getDate();return t>=o?l:(n.setFullYear(l.getFullYear(),l.getMonth(),t),n)}const Vt=!0,Sn=Object.freeze(Object.defineProperty({__proto__:null,prerender:Vt},Symbol.toStringTag,{value:"Module"}));function Ot(a){let e,n,t;function l(r){a[4](r)}let o={label:"Type",name:"repeat-type",helperText:"",loading:a[1],required:!0,isInvalid:!1,disabled:!1,options:a[3]};return a[0]!==void 0&&(o.value=a[0]),e=new dt({props:o}),_e.push(()=>ke(e,"value",l)),e.$on("change",a[2]),{c(){F(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,u){A(e,r,u),t=!0},p(r,[u]){const s={};u&2&&(s.loading=r[1]),!n&&u&1&&(n=!0,s.value=r[0],be(()=>n=!1)),e.$set(s)},i(r){t||($(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function Rt(a,e,n){let{value:t}=e,{loading:l}=e;const o=Le(),r=()=>{o("valueChanged",{value:t})},u=Ct;function s(f){t=f,n(0,t)}return a.$$set=f=>{"value"in f&&n(0,t=f.value),"loading"in f&&n(1,l=f.loading)},[t,l,r,u,s]}class jt extends ue{constructor(e){super(),ce(this,e,Rt,Ot,oe,{value:0,loading:1})}}function Yt(a){let e,n,t;function l(r){a[4](r)}let o={label:"Repeat type",name:"repeat-type",helperText:"",loading:a[1],required:!0,isInvalid:!1,disabled:!1,options:a[3]};return a[0]!==void 0&&(o.value=a[0]),e=new dt({props:o}),_e.push(()=>ke(e,"value",l)),e.$on("change",a[2]),{c(){F(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,u){A(e,r,u),t=!0},p(r,[u]){const s={};u&2&&(s.loading=r[1]),!n&&u&1&&(n=!0,s.value=r[0],be(()=>n=!1)),e.$set(s)},i(r){t||($(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function qt(a,e,n){let{value:t}=e,{loading:l}=e;const o=Le(),r=()=>{o("valueChanged",{value:t})},u=Dt;function s(f){t=f,n(0,t)}return a.$$set=f=>{"value"in f&&n(0,t=f.value),"loading"in f&&n(1,l=f.loading)},[t,l,r,u,s]}class Ht extends ue{constructor(e){super(),ce(this,e,qt,Yt,oe,{value:0,loading:1})}}function zt(a){let e,n,t;function l(r){a[3](r)}let o={label:"Date",name:"repeat-start-date",placeholder:"",helperText:"",loading:a[1],required:!0,isInvalid:!1};return a[0]!==void 0&&(o.value=a[0]),e=new ft({props:o}),_e.push(()=>ke(e,"value",l)),e.$on("valueChanged",a[2]),{c(){F(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,u){A(e,r,u),t=!0},p(r,[u]){const s={};u&2&&(s.loading=r[1]),!n&&u&1&&(n=!0,s.value=r[0],be(()=>n=!1)),e.$set(s)},i(r){t||($(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function Ut(a,e,n){let{value:t}=e,{loading:l}=e;const o=Le(),r=()=>{o("valueChanged",{value:t})};function u(s){t=s,n(0,t)}return a.$$set=s=>{"value"in s&&n(0,t=s.value),"loading"in s&&n(1,l=s.loading)},[t,l,r,u]}class Kt extends ue{constructor(e){super(),ce(this,e,Ut,zt,oe,{value:0,loading:1})}}function Xt(a){let e,n,t;function l(r){a[3](r)}let o={label:"End date",name:"repeat-end-date",placeholder:"",helperText:"",loading:a[1],required:!0,isInvalid:!1};return a[0]!==void 0&&(o.value=a[0]),e=new ft({props:o}),_e.push(()=>ke(e,"value",l)),e.$on("valueChanged",a[2]),{c(){F(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,u){A(e,r,u),t=!0},p(r,[u]){const s={};u&2&&(s.loading=r[1]),!n&&u&1&&(n=!0,s.value=r[0],be(()=>n=!1)),e.$set(s)},i(r){t||($(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function Zt(a,e,n){let{value:t}=e,{loading:l}=e;const o=Le(),r=()=>{o("valueChanged",{value:t})};function u(s){t=s,n(0,t)}return a.$$set=s=>{"value"in s&&n(0,t=s.value),"loading"in s&&n(1,l=s.loading)},[t,l,r,u]}class Gt extends ue{constructor(e){super(),ce(this,e,Zt,Xt,oe,{value:0,loading:1})}}function Qe(a,e,n){const t=a.slice();return t[1]=e[n],t[3]=n,t}function We(a){let e,n,t,l=a[0].length+"",o,r,u,s,f,d=Me(a[0]),i=[];for(let c=0;c<d.length;c+=1)i[c]=xe(Qe(a,d,c));return{c(){e=I("div"),n=I("div"),t=z("Dates Preview ("),o=z(l),r=z(" entries)"),u=M(),s=I("div"),f=I("ul");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=C(c,"DIV",{class:!0});var _=y(e);n=C(_,"DIV",{});var g=y(n);t=U(g,"Dates Preview ("),o=U(g,l),r=U(g," entries)"),g.forEach(b),u=L(_),s=C(_,"DIV",{class:!0});var w=y(s);f=C(w,"UL",{class:!0});var q=y(f);for(let R=0;R<i.length;R+=1)i[R].l(q);q.forEach(b),w.forEach(b),_.forEach(b),this.h()},h(){D(f,"class","list-group list-group-flush"),D(s,"class","preview border border-light-subtle svelte-1qbwz3y"),D(e,"class","d-flex flex-column gap-1")},m(c,_){O(c,e,_),m(e,n),m(n,t),m(n,o),m(n,r),m(e,u),m(e,s),m(s,f);for(let g=0;g<i.length;g+=1)i[g]&&i[g].m(f,null)},p(c,_){if(_&1&&l!==(l=c[0].length+"")&&ge(o,l),_&1){d=Me(c[0]);let g;for(g=0;g<d.length;g+=1){const w=Qe(c,d,g);i[g]?i[g].p(w,_):(i[g]=xe(w),i[g].c(),i[g].m(f,null))}for(;g<i.length;g+=1)i[g].d(1);i.length=d.length}},d(c){c&&b(e),ut(i,c)}}}function xe(a){let e,n=a[3]+1+"",t,l,o=Se(a[1],"EEE - dd MMM yyyy")+"",r,u;return{c(){e=I("li"),t=z(n),l=z(". "),r=z(o),u=M(),this.h()},l(s){e=C(s,"LI",{class:!0});var f=y(e);t=U(f,n),l=U(f,". "),r=U(f,o),u=L(f),f.forEach(b),this.h()},h(){D(e,"class","list-group-item")},m(s,f){O(s,e,f),m(e,t),m(e,l),m(e,r),m(e,u)},p(s,f){f&1&&o!==(o=Se(s[1],"EEE - dd MMM yyyy")+"")&&ge(r,o)},d(s){s&&b(e)}}}function Jt(a){let e,n=a[0].length>0&&We(a);return{c(){n&&n.c(),e=ae()},l(t){n&&n.l(t),e=ae()},m(t,l){n&&n.m(t,l),O(t,e,l)},p(t,[l]){t[0].length>0?n?n.p(t,l):(n=We(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ee,o:ee,d(t){t&&b(e),n&&n.d(t)}}}function Qt(a,e,n){let{dates:t}=e;return a.$$set=l=>{"dates"in l&&n(0,t=l.dates)},[t]}class Wt extends ue{constructor(e){super(),ce(this,e,Qt,Jt,oe,{dates:0})}}function et(a){let e,n,t,l,o,r,u,s,f,d,i,c,_,g,w,q,R,K,le,X,W,me={loading:a[0],value:a[1].description};n=new Et({props:me}),a[13](n),n.$on("valueChanged",a[14]);let Q={loading:a[0],value:a[1].amount};l=new yt({props:Q}),a[15](l),l.$on("valueChanged",a[16]);let re={loading:a[0],value:a[1].source};r=new Bt({props:re}),a[17](r),r.$on("valueChanged",a[18]),s=new Tt({props:{loading:a[0],value:a[1].category_id}}),s.$on("valueChanged",a[19]),d=new St({props:{loading:a[0],value:a[1].account_id}}),d.$on("valueChanged",a[20]);let E=a[1]?.meta_data?.transaction?.type&&tt(a),B=a[1].recurrence&&nt(a),T=a[1].id&&lt(a);return K=new Te({props:{loading:a[0],variant:"secondary",$$slots:{default:[en]},$$scope:{ctx:a}}}),K.$on("click",a[7]),X=new Te({props:{loading:a[0],variant:"primary",$$slots:{default:[tn]},$$scope:{ctx:a}}}),X.$on("click",a[8]),{c(){e=I("div"),F(n.$$.fragment),t=M(),F(l.$$.fragment),o=M(),F(r.$$.fragment),u=M(),F(s.$$.fragment),f=M(),F(d.$$.fragment),i=M(),E&&E.c(),c=M(),B&&B.c(),_=M(),g=I("div"),w=I("div"),T&&T.c(),q=M(),R=I("div"),F(K.$$.fragment),le=M(),F(X.$$.fragment),this.h()},l(p){e=C(p,"DIV",{class:!0});var v=y(e);N(n.$$.fragment,v),t=L(v),N(l.$$.fragment,v),o=L(v),N(r.$$.fragment,v),u=L(v),N(s.$$.fragment,v),f=L(v),N(d.$$.fragment,v),i=L(v),E&&E.l(v),c=L(v),B&&B.l(v),_=L(v),g=C(v,"DIV",{class:!0});var Z=y(g);w=C(Z,"DIV",{});var h=y(w);T&&T.l(h),h.forEach(b),q=L(Z),R=C(Z,"DIV",{});var S=y(R);N(K.$$.fragment,S),le=L(S),N(X.$$.fragment,S),S.forEach(b),Z.forEach(b),v.forEach(b),this.h()},h(){D(g,"class","d-flex justify-content-between"),D(e,"class","d-flex flex-column gap-3")},m(p,v){O(p,e,v),A(n,e,null),m(e,t),A(l,e,null),m(e,o),A(r,e,null),m(e,u),A(s,e,null),m(e,f),A(d,e,null),m(e,i),E&&E.m(e,null),m(e,c),B&&B.m(e,null),m(e,_),m(e,g),m(g,w),T&&T.m(w,null),m(g,q),m(g,R),A(K,R,null),m(R,le),A(X,R,null),W=!0},p(p,v){const Z={};v&1&&(Z.loading=p[0]),v&2&&(Z.value=p[1].description),n.$set(Z);const h={};v&1&&(h.loading=p[0]),v&2&&(h.value=p[1].amount),l.$set(h);const S={};v&1&&(S.loading=p[0]),v&2&&(S.value=p[1].source),r.$set(S);const V={};v&1&&(V.loading=p[0]),v&2&&(V.value=p[1].category_id),s.$set(V);const H={};v&1&&(H.loading=p[0]),v&2&&(H.value=p[1].account_id),d.$set(H),p[1]?.meta_data?.transaction?.type?E?(E.p(p,v),v&2&&$(E,1)):(E=tt(p),E.c(),$(E,1),E.m(e,c)):E&&(te(),k(E,1,1,()=>{E=null}),ne()),p[1].recurrence?B?(B.p(p,v),v&2&&$(B,1)):(B=nt(p),B.c(),$(B,1),B.m(e,_)):B&&(te(),k(B,1,1,()=>{B=null}),ne()),p[1].id?T?(T.p(p,v),v&2&&$(T,1)):(T=lt(p),T.c(),$(T,1),T.m(w,null)):T&&(te(),k(T,1,1,()=>{T=null}),ne());const G={};v&1&&(G.loading=p[0]),v&268435456&&(G.$$scope={dirty:v,ctx:p}),K.$set(G);const fe={};v&1&&(fe.loading=p[0]),v&268435456&&(fe.$$scope={dirty:v,ctx:p}),X.$set(fe)},i(p){W||($(n.$$.fragment,p),$(l.$$.fragment,p),$(r.$$.fragment,p),$(s.$$.fragment,p),$(d.$$.fragment,p),$(E),$(B),$(T),$(K.$$.fragment,p),$(X.$$.fragment,p),W=!0)},o(p){k(n.$$.fragment,p),k(l.$$.fragment,p),k(r.$$.fragment,p),k(s.$$.fragment,p),k(d.$$.fragment,p),k(E),k(B),k(T),k(K.$$.fragment,p),k(X.$$.fragment,p),W=!1},d(p){p&&b(e),a[13](null),P(n),a[15](null),P(l),a[17](null),P(r),P(s),P(d),E&&E.d(),B&&B.d(),T&&T.d(),P(K),P(X)}}}function tt(a){let e,n;return e=new jt({props:{loading:a[0],value:a[1].meta_data.transaction.type}}),e.$on("valueChanged",a[21]),{c(){F(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.loading=t[0]),l&2&&(o.value=t[1].meta_data.transaction.type),e.$set(o)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function nt(a){let e,n="Repeats",t,l,o,r,u,s,f,d;l=new Ht({props:{loading:a[0],value:a[1].recurrence.type}}),l.$on("valueChanged",a[22]),r=new Kt({props:{loading:a[0],value:a[1].recurrence.start_date}}),r.$on("valueChanged",a[23]);let i=a[1].recurrence.until&&at(a);return f=new Wt({props:{dates:a[2]}}),{c(){e=I("h5"),e.textContent=n,t=M(),F(l.$$.fragment),o=M(),F(r.$$.fragment),u=M(),i&&i.c(),s=M(),F(f.$$.fragment)},l(c){e=C(c,"H5",{"data-svelte-h":!0}),Be(e)!=="svelte-13f0n3i"&&(e.textContent=n),t=L(c),N(l.$$.fragment,c),o=L(c),N(r.$$.fragment,c),u=L(c),i&&i.l(c),s=L(c),N(f.$$.fragment,c)},m(c,_){O(c,e,_),O(c,t,_),A(l,c,_),O(c,o,_),A(r,c,_),O(c,u,_),i&&i.m(c,_),O(c,s,_),A(f,c,_),d=!0},p(c,_){const g={};_&1&&(g.loading=c[0]),_&2&&(g.value=c[1].recurrence.type),l.$set(g);const w={};_&1&&(w.loading=c[0]),_&2&&(w.value=c[1].recurrence.start_date),r.$set(w),c[1].recurrence.until?i?(i.p(c,_),_&2&&$(i,1)):(i=at(c),i.c(),$(i,1),i.m(s.parentNode,s)):i&&(te(),k(i,1,1,()=>{i=null}),ne());const q={};_&4&&(q.dates=c[2]),f.$set(q)},i(c){d||($(l.$$.fragment,c),$(r.$$.fragment,c),$(i),$(f.$$.fragment,c),d=!0)},o(c){k(l.$$.fragment,c),k(r.$$.fragment,c),k(i),k(f.$$.fragment,c),d=!1},d(c){c&&(b(e),b(t),b(o),b(u),b(s)),P(l,c),P(r,c),i&&i.d(c),P(f,c)}}}function at(a){let e,n;return e=new Gt({props:{loading:a[0],value:a[1].recurrence.until}}),e.$on("valueChanged",a[24]),{c(){F(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.loading=t[0]),l&2&&(o.value=t[1].recurrence.until),e.$set(o)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function lt(a){let e,n;return e=new Te({props:{loading:a[0],variant:"danger",$$slots:{default:[xt]},$$scope:{ctx:a}}}),e.$on("click",a[9]),{c(){F(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p(t,l){const o={};l&1&&(o.loading=t[0]),l&268435456&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function xt(a){let e;return{c(){e=z("Delete")},l(n){e=U(n,"Delete")},m(n,t){O(n,e,t)},d(n){n&&b(e)}}}function en(a){let e;return{c(){e=z("Cancel")},l(n){e=U(n,"Cancel")},m(n,t){O(n,e,t)},d(n){n&&b(e)}}}function tn(a){let e;return{c(){e=z("Save")},l(n){e=U(n,"Save")},m(n,t){O(n,e,t)},d(n){n&&b(e)}}}function nn(a){let e,n,t=a[1]&&et(a);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,o){t&&t.m(l,o),O(l,e,o),n=!0},p(l,[o]){l[1]?t?(t.p(l,o),o&2&&$(t,1)):(t=et(l),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(te(),k(t,1,1,()=>{t=null}),ne())},i(l){n||($(t),n=!0)},o(l){k(t),n=!1},d(l){l&&b(e),t&&t.d(l)}}}function an(a,e,n){let{loading:t=!1}=e,{bill:l}=e,{drawerId:o}=e,r=[],u=0,s={type:"monthly",start_date:Se(new Date,"yyyy-MM-dd"),until:Se(Pt(new Date,12),"yyyy-MM-dd")},d={transaction:{paid:"scheduled",type:"unknown",from_bill:!0}},i={source:"",amount:10,description:"",recurrence:s,meta_data:d},c,_,g;const w=(h,S)=>{const{value:V}=h.detail;if(i&&i.recurrence){switch(S){case"description":n(1,i.description=V,i);break;case"source":n(1,i.source=V,i);break;case"amount":n(1,i.amount=V,i);break;case"category-id":n(1,i.category_id=V,i);break;case"account-id":n(1,i.account_id=V,i);break;case"repeat-type":n(1,i.recurrence.type=V,i);break;case"repeat-start-date":n(1,i.recurrence.start_date=V,i);break;case"repeat-until-date":n(1,i.recurrence.until=V,i);break;case"meta-data-transaction-type":i?.meta_data?.transaction?.type&&n(1,i.meta_data.transaction.type=V,i);break}n(2,r=Ze(i.recurrence))}},q=()=>{const h=`[data-bs-target="#${o}"]`,S=document.querySelector(h);S&&(S.click(),n(10,l=void 0),n(12,u=void 0),n(1,i={source:"",amount:10,description:"",recurrence:s}))},R=async()=>{const h=await c.validateFieldIsInvalid(),S=await _.validateFieldIsInvalid(),V=await g.validateFieldIsInvalid();if(h||S||V)return;const{actions:{reload:G,createBill:fe,updateBill:pe}}=$e();i.id?await pe(i.id,i):await fe(i),await G(),q()},K=async()=>{if(!i?.id)return;const{actions:{reload:h,deleteBill:S}}=$e();ct({title:"Delete Confirmation",message:"Are you sure you want to do this? You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async V=>{i?.id&&(V&&await S(i.id),await h(),q())}})};function le(h){_e[h?"unshift":"push"](()=>{c=h,n(3,c)})}const X=h=>w(h,"description");function W(h){_e[h?"unshift":"push"](()=>{g=h,n(5,g)})}const me=h=>w(h,"amount");function Q(h){_e[h?"unshift":"push"](()=>{_=h,n(4,_)})}const re=h=>w(h,"source"),E=h=>w(h,"category-id"),B=h=>w(h,"account-id"),T=h=>w(h,"meta-data-transaction-type"),p=h=>w(h,"repeat-type"),v=h=>w(h,"repeat-start-date"),Z=h=>w(h,"repeat-until-date");return a.$$set=h=>{"loading"in h&&n(0,t=h.loading),"bill"in h&&n(10,l=h.bill),"drawerId"in h&&n(11,o=h.drawerId)},a.$$.update=()=>{if(a.$$.dirty&5122&&(!l||u!==l?.id)){n(1,i=l?{...i,...l,recurrence:{...s,...l.recurrence},meta_data:{...d,...l.meta_data}}:i);const{recurrence:h}=i;n(2,r=h?Ze(h):[]),n(12,u=l?.id)}},[t,i,r,c,_,g,w,q,R,K,l,o,u,le,X,W,me,Q,re,E,B,T,p,v,Z]}class ln extends ue{constructor(e){super(),ce(this,e,an,nn,oe,{loading:0,bill:10,drawerId:11})}}function rt(a,e,n){const t=a.slice();return t[8]=e[n],t}function st(a){let e,n,t=Me(a[1]),l=[];for(let r=0;r<t.length;r+=1)l[r]=ot(rt(a,t,r));const o=r=>k(l[r],1,1,()=>{l[r]=null});return{c(){for(let r=0;r<l.length;r+=1)l[r].c();e=ae()},l(r){for(let u=0;u<l.length;u+=1)l[u].l(r);e=ae()},m(r,u){for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(r,u);O(r,e,u),n=!0},p(r,u){if(u&31){t=Me(r[1]);let s;for(s=0;s<t.length;s+=1){const f=rt(r,t,s);l[s]?(l[s].p(f,u),$(l[s],1)):(l[s]=ot(f),l[s].c(),$(l[s],1),l[s].m(e.parentNode,e))}for(te(),s=t.length;s<l.length;s+=1)o(s);ne()}},i(r){if(!n){for(let u=0;u<t.length;u+=1)$(l[u]);n=!0}},o(r){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)k(l[u]);n=!1},d(r){r&&b(e),ut(l,r)}}}function rn(a){return{c:ee,l:ee,m:ee,p:ee,d:ee}}function sn(a){let e,n=a[1]+"",t;return{c(){e=I("span"),t=z(n),this.h()},l(l){e=C(l,"SPAN",{class:!0});var o=y(e);t=U(o,n),o.forEach(b),this.h()},h(){D(e,"class","d-block text-warning")},m(l,o){O(l,e,o),m(e,t)},p(l,o){o&2&&n!==(n=l[1]+"")&&ge(t,n)},d(l){l&&b(e)}}}function on(a){let e;return{c(){e=z("loading ...")},l(n){e=U(n,"loading ...")},m(n,t){O(n,e,t)},p:ee,d(n){n&&b(e)}}}function it(a){let e,n;return e=new Mt({props:{type:a[8].meta_data.transaction.type}}),{c(){F(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p(t,l){const o={};l&2&&(o.type=t[8].meta_data.transaction.type),e.$set(o)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function ot(a){let e,n,t=a[8].description+"",l,o,r,u,s,f=a[8].source+"",d,i,c,_,g=a[8]?.recurrence?.type+"",w,q,R=a[8]?.recurrence?.start_date+"",K,le,X,W,me,Q,re,E=Ge(a[8].amount)+"",B,T,p,v,Z='<i class="bi bi-three-dots-vertical"></i>',h,S,V,H,G,fe='<span>Edit</span> <i class="bi bi-pencil-fill"></i>',pe,Fe,he,se,Ve='<span class="d-flex justify-content-between"><span>Delete</span> <i class="bi bi-trash-fill"></i></span>',Ne,x,Ae,Oe,J={ctx:a,current:null,token:null,hasCatch:!1,pending:on,then:sn,catch:rn,value:1};Je(X=a[4](a[8]?.account_id),J);let j=a[8]?.meta_data?.transaction&&it(a);function gt(){return a[5](a[8])}function _t(){return a[6](a[8])}return{c(){e=I("div"),n=I("div"),l=z(t),o=M(),r=I("div"),u=I("div"),s=I("div"),d=z(f),i=M(),c=I("div"),_=I("span"),w=z(g),q=z(`
						Bill starting `),K=z(R),le=M(),J.block.c(),W=M(),j&&j.c(),me=M(),Q=I("div"),re=I("span"),B=z(E),T=M(),p=I("div"),v=I("span"),v.innerHTML=Z,h=M(),S=I("ul"),V=I("li"),H=I("button"),G=I("span"),G.innerHTML=fe,Fe=M(),he=I("li"),se=I("button"),se.innerHTML=Ve,Ne=M(),this.h()},l(ie){e=C(ie,"DIV",{});var Y=y(e);n=C(Y,"DIV",{class:!0});var Re=y(n);l=U(Re,t),Re.forEach(b),o=L(Y),r=C(Y,"DIV",{class:!0});var we=y(r);u=C(we,"DIV",{class:!0});var de=y(u);s=C(de,"DIV",{class:!0});var je=y(s);d=U(je,f),je.forEach(b),i=L(de),c=C(de,"DIV",{class:!0});var Ie=y(c);_=C(Ie,"SPAN",{class:!0});var Ye=y(_);w=U(Ye,g),Ye.forEach(b),q=U(Ie,`
						Bill starting `),K=U(Ie,R),Ie.forEach(b),le=L(de),J.block.l(de),W=L(de),j&&j.l(de),de.forEach(b),me=L(we),Q=C(we,"DIV",{class:!0});var Ce=y(Q);re=C(Ce,"SPAN",{});var qe=y(re);B=U(qe,E),qe.forEach(b),T=L(Ce),p=C(Ce,"DIV",{class:!0});var De=y(p);v=C(De,"SPAN",{"data-bs-toggle":!0,"aria-expanded":!0,"data-svelte-h":!0}),Be(v)!=="svelte-8w8uzy"&&(v.innerHTML=Z),h=L(De),S=C(De,"UL",{class:!0});var Ee=y(S);V=C(Ee,"LI",{});var He=y(V);H=C(He,"BUTTON",{type:!0,class:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var ze=y(H);G=C(ze,"SPAN",{class:!0,"data-svelte-h":!0}),Be(G)!=="svelte-1rb2cm0"&&(G.innerHTML=fe),ze.forEach(b),He.forEach(b),Fe=L(Ee),he=C(Ee,"LI",{});var Ue=y(he);se=C(Ue,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Be(se)!=="svelte-1bk09ub"&&(se.innerHTML=Ve),Ue.forEach(b),Ee.forEach(b),De.forEach(b),Ce.forEach(b),we.forEach(b),Ne=L(Y),Y.forEach(b),this.h()},h(){D(n,"class","fw-bold"),D(s,"class","fw-light"),D(_,"class","text-capitalize"),D(c,"class","fw-lighter text-muted small"),D(u,"class","small"),D(v,"data-bs-toggle","dropdown"),D(v,"aria-expanded","false"),D(G,"class","d-flex justify-content-between"),D(H,"type","button"),D(H,"class","dropdown-item"),D(H,"data-bs-toggle","offcanvas"),D(H,"data-bs-target",pe="#"+a[0]),D(H,"aria-controls",a[0]),D(se,"type","button"),D(se,"class","dropdown-item"),D(S,"class","dropdown-menu dropdown-menu-dark"),D(p,"class","dropdown"),D(Q,"class","d-flex align-items-end gap-2"),D(r,"class","d-flex justify-content-between")},m(ie,Y){O(ie,e,Y),m(e,n),m(n,l),m(e,o),m(e,r),m(r,u),m(u,s),m(s,d),m(u,i),m(u,c),m(c,_),m(_,w),m(c,q),m(c,K),m(u,le),J.block.m(u,J.anchor=null),J.mount=()=>u,J.anchor=W,m(u,W),j&&j.m(u,null),m(r,me),m(r,Q),m(Q,re),m(re,B),m(Q,T),m(Q,p),m(p,v),m(p,h),m(p,S),m(S,V),m(V,H),m(H,G),m(S,Fe),m(S,he),m(he,se),m(e,Ne),x=!0,Ae||(Oe=[Ke(H,"click",gt),Ke(se,"click",_t)],Ae=!0)},p(ie,Y){a=ie,(!x||Y&2)&&t!==(t=a[8].description+"")&&ge(l,t),(!x||Y&2)&&f!==(f=a[8].source+"")&&ge(d,f),(!x||Y&2)&&g!==(g=a[8]?.recurrence?.type+"")&&ge(w,g),(!x||Y&2)&&R!==(R=a[8]?.recurrence?.start_date+"")&&ge(K,R),J.ctx=a,Y&2&&X!==(X=a[4](a[8]?.account_id))&&Je(X,J)||At(J,a,Y),a[8]?.meta_data?.transaction?j?(j.p(a,Y),Y&2&&$(j,1)):(j=it(a),j.c(),$(j,1),j.m(u,null)):j&&(te(),k(j,1,1,()=>{j=null}),ne()),(!x||Y&2)&&E!==(E=Ge(a[8].amount)+"")&&ge(B,E),(!x||Y&1&&pe!==(pe="#"+a[0]))&&D(H,"data-bs-target",pe),(!x||Y&1)&&D(H,"aria-controls",a[0])},i(ie){x||($(j),x=!0)},o(ie){k(j),x=!1},d(ie){ie&&b(e),J.block.d(),J.token=null,J=null,j&&j.d(),Ae=!1,vt(Oe)}}}function un(a){let e,n,t=a[1].length&&st(a);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,o){t&&t.m(l,o),O(l,e,o),n=!0},p(l,[o]){l[1].length?t?(t.p(l,o),o&2&&$(t,1)):(t=st(l),t.c(),$(t,1),t.m(e.parentNode,e)):t&&(te(),k(t,1,1,()=>{t=null}),ne())},i(l){n||($(t),n=!0)},o(l){k(t),n=!1},d(l){l&&b(e),t&&t.d(l)}}}function cn(a,e,n){let{data:t=[]}=e,{drawerId:l=""}=e;const{actions:{getAccount:o}}=Ft(),r=async i=>{if(!i)return;const{actions:{canDeleteBill:c,deleteBill:_,reload:g}}=$e(),w=await c(i);ct({title:"Delete Confirmation",message:w?"Are you sure you want to do this? You won't be able to undo this.":"There are uses of this bill in transactions. You cannot delete it",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",confirmButtonHide:!w,rejectButtonLabel:w?"No":"Close",callback:async R=>{i&&R&&w&&(await _(i),await g())}})},u=i=>{const{stores:{targetBill:c,loading:_}}=$e();_.set(!0),setTimeout(()=>{c.set(i),_.set(!1)},800)},s=async i=>i?(await o(i))?.name??"":"",f=i=>u(i),d=i=>r(i.id);return a.$$set=i=>{"data"in i&&n(1,t=i.data),"drawerId"in i&&n(0,l=i.drawerId)},[l,t,r,u,s,f,d]}class fn extends ue{constructor(e){super(),ce(this,e,cn,un,oe,{data:1,drawerId:0})}}function dn(a){let e,n;return e=new It({}),{c(){F(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p:ee,i(t){n||($(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function gn(a){let e,n,t;function l(r){a[8](r)}let o={bill:a[0],drawerId:ve};return a[2]!==void 0&&(o.loading=a[2]),e=new ln({props:o}),_e.push(()=>ke(e,"loading",l)),{c(){F(e.$$.fragment)},l(r){N(e.$$.fragment,r)},m(r,u){A(e,r,u),t=!0},p(r,u){const s={};u&1&&(s.bill=r[0]),!n&&u&4&&(n=!0,s.loading=r[2],be(()=>n=!1)),e.$set(s)},i(r){t||($(e.$$.fragment,r),t=!0)},o(r){k(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function _n(a){let e,n,t,l;const o=[gn,dn],r=[];function u(s,f){return s[2]?1:0}return e=u(a),n=r[e]=o[e](a),{c(){n.c(),t=ae()},l(s){n.l(s),t=ae()},m(s,f){r[e].m(s,f),O(s,t,f),l=!0},p(s,f){let d=e;e=u(s),e===d?r[e].p(s,f):(te(),k(r[d],1,1,()=>{r[d]=null}),ne(),n=r[e],n?n.p(s,f):(n=r[e]=o[e](s),n.c()),$(n,1),n.m(t.parentNode,t))},i(s){l||($(n),l=!0)},o(s){k(n),l=!1},d(s){s&&b(t),r[e].d(s)}}}function mn(a){let e;return{c(){e=I("i"),this.h()},l(n){e=C(n,"I",{class:!0}),y(e).forEach(b),this.h()},h(){D(e,"class","bi bi-plus")},m(n,t){O(n,e,t)},p:ee,d(n){n&&b(e)}}}function pn(a){let e,n,t,l,o,r,u,s,f;return e=new wt({props:{title:a[1],id:ve,$$slots:{default:[_n]},$$scope:{ctx:a}}}),r=new Te({props:{variant:"primary",size:"sm","data-bs-toggle":"offcanvas","data-bs-target":"#"+ve,"aria-controls":ve,$$slots:{default:[mn]},$$scope:{ctx:a}}}),r.$on("click",a[7]),s=new fn({props:{drawerId:ve,data:a[3]}}),{c(){F(e.$$.fragment),n=M(),t=I("div"),l=I("div"),o=I("div"),F(r.$$.fragment),u=M(),F(s.$$.fragment),this.h()},l(d){N(e.$$.fragment,d),n=L(d),t=C(d,"DIV",{class:!0});var i=y(t);l=C(i,"DIV",{class:!0});var c=y(l);o=C(c,"DIV",{});var _=y(o);N(r.$$.fragment,_),_.forEach(b),c.forEach(b),u=L(i),N(s.$$.fragment,i),i.forEach(b),this.h()},h(){D(l,"class","d-flex justify-content-end align-items-center"),D(t,"class","d-flex flex-column gap-3")},m(d,i){A(e,d,i),O(d,n,i),O(d,t,i),m(t,l),m(l,o),A(r,o,null),m(t,u),A(s,t,null),f=!0},p(d,[i]){const c={};i&2&&(c.title=d[1]),i&2053&&(c.$$scope={dirty:i,ctx:d}),e.$set(c);const _={};i&2048&&(_.$$scope={dirty:i,ctx:d}),r.$set(_);const g={};i&8&&(g.data=d[3]),s.$set(g)},i(d){f||($(e.$$.fragment,d),$(r.$$.fragment,d),$(s.$$.fragment,d),f=!0)},o(d){k(e.$$.fragment,d),k(r.$$.fragment,d),k(s.$$.fragment,d),f=!1},d(d){d&&(b(n),b(t)),P(e,d),P(r),P(s)}}}const ve="bill-form";function hn(a,e,n){let t,l,o,r;const{stores:{data:u,targetBill:s,loading:f},actions:{reload:d}}=$e();Pe(a,u,g=>n(3,r=g)),Pe(a,s,g=>n(0,l=g)),Pe(a,f,g=>n(2,o=g));const i={description:"",source:"",amount:0},c=()=>{f.set(!0),setTimeout(()=>{s.set(i),f.set(!1)},1500)};$t(d),bt(Lt);function _(g){o=g,f.set(o)}return a.$$.update=()=>{a.$$.dirty&1&&n(1,t=l?.id?"Edit Bill":"Create Bill")},[l,t,o,r,u,s,f,c,_]}class vn extends ue{constructor(e){super(),ce(this,e,hn,pn,oe,{})}}function $n(a){let e,n;return e=new vn({}),{c(){F(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function bn(a){let e,n;return e=new kt({props:{pageTitle:"Bills",$$slots:{default:[$n]},$$scope:{ctx:a}}}),{c(){F(e.$$.fragment)},l(t){N(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p(t,[l]){const o={};l&1&&(o.$$scope={dirty:l,ctx:t}),e.$set(o)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){k(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}class Mn extends ue{constructor(e){super(),ce(this,e,null,bn,oe,{})}}export{Mn as component,Sn as universal};
