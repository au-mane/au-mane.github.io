import{s as Ie,A as Me,o as Y,f as M,e as b,d as P,t as be,j as v,k as C,l as X,i as A,m as ve,n as _,B as x,p as d,J as ae,I as U,q as De,y as Re,w as Ue,G as we,r as Ye,v as Ge,L as Je}from"../chunks/scheduler.BYuDQn6a.js";import{S as Te,i as Se,t as R,g as qe,a as J,e as Fe,c as re,b as oe,m as ie,d as ue}from"../chunks/index.DqhcTbDs.js";import{P as Ke}from"../chunks/PageLayout.C9BRc7Y8.js";import{e as Be}from"../chunks/Header.B3iuWz3u.js";import{f as $,p as G,c as Qe,D as We,F as Xe}from"../chunks/FormSkel.MUUuXhv7.js";import{S as Ze}from"../chunks/Spinner.qZAGg6o7.js";import{g as xe,u as $e,c as et,d as tt}from"../chunks/budget.api.Dojmk0O6.js";import{w as Le}from"../chunks/index.s7t9l1rZ.js";import{f as Ne}from"../chunks/app.state.D4d-W_z-.js";const st=!0,Tt=Object.freeze(Object.defineProperty({__proto__:null,prerender:st},Symbol.toStringTag,{value:"Module"})),ke={start_at:$(new Date,"yyyy-MM-dd"),end_at:$(new Date,"yyyy-MM-dd"),settings:{max_spend_limit:0}};let ee=null;const nt=()=>{const n=Le(!1),e=Le([]);return ee={stores:{loading:n,data:e},actions:{reload:async()=>{n.set(!0);const t=await xe();e.set(t),n.set(!1)}}},ee},ze=()=>ee?.stores&&Object.keys(ee.stores).length>0&&ee?.actions&&Object.keys(ee.actions).length>0?ee:nt();function Pe(n){let e,s,t,a="Start Date*",f,o,D,l,i,h,r="End Date*",k,m,g,c,y,S,j="Max Limit*",F,E,B,T,I,V,q=n[14].message+"",O,K,fe,Q,W,de,te,H,se,L,ce,me;W=new Ze({props:{size:"xs"}});let N=n[6]&&Ae(n);function _e(p,w){return p[6]?lt:at}let ne=_e(n),z=ne(n),u=n[15]&&Oe();return{c(){e=b("div"),s=b("div"),t=b("div"),t.textContent=a,f=P(),o=b("input"),l=P(),i=b("div"),h=b("div"),h.textContent=r,k=P(),m=b("input"),c=P(),y=b("div"),S=b("div"),S.textContent=j,F=P(),E=b("input"),T=P(),I=b("div"),V=b("small"),O=be(q),fe=P(),Q=b("span"),re(W.$$.fragment),de=P(),N&&N.c(),te=P(),H=b("button"),z.c(),se=P(),u&&u.c(),this.h()},l(p){e=v(p,"DIV",{class:!0});var w=C(e);s=v(w,"DIV",{class:!0});var pe=C(s);t=v(pe,"DIV",{"data-svelte-h":!0}),X(t)!=="svelte-172ibe4"&&(t.textContent=a),f=A(pe),o=v(pe,"INPUT",{name:!0,type:!0,class:!0}),pe.forEach(M),l=A(w),i=v(w,"DIV",{class:!0});var ge=C(i);h=v(ge,"DIV",{"data-svelte-h":!0}),X(h)!=="svelte-1iotazt"&&(h.textContent=r),k=A(ge),m=v(ge,"INPUT",{name:!0,type:!0,class:!0}),ge.forEach(M),c=A(w),y=v(w,"DIV",{class:!0});var he=C(y);S=v(he,"DIV",{"data-svelte-h":!0}),X(S)!=="svelte-16dil7f"&&(S.textContent=j),F=A(he),E=v(he,"INPUT",{name:!0,type:!0,class:!0}),he.forEach(M),T=A(w),I=v(w,"DIV",{class:!0});var Z=C(I);V=v(Z,"SMALL",{class:!0});var Ee=C(V);O=ve(Ee,q),Ee.forEach(M),fe=A(Z),Q=v(Z,"SPAN",{});var Ce=C(Q);oe(W.$$.fragment,Ce),Ce.forEach(M),de=A(Z),N&&N.l(Z),te=A(Z),H=v(Z,"BUTTON",{class:!0});var ye=C(H);z.l(ye),se=A(ye),u&&u.l(ye),ye.forEach(M),Z.forEach(M),w.forEach(M),this.h()},h(){_(o,"name",D=n[1]+"-start-date"),_(o,"type","date"),_(o,"class","form-control"),o.disabled=n[10],o.required=!0,x(o,"is-invalid",n[8]),_(s,"class","d-flex flex-column gap-2"),_(m,"name",g=n[1]+"-end-date"),_(m,"type","date"),_(m,"class","form-control"),m.disabled=n[10],m.required=!0,x(m,"is-invalid",n[7]),_(i,"class","d-flex flex-column gap-2"),_(E,"name",B=n[1]+"-max-limit"),_(E,"type","text"),_(E,"class","form-control text-end"),E.disabled=n[10],E.required=!0,x(E,"is-invalid",n[9]),_(y,"class","d-flex flex-column gap-2"),_(V,"class",K="fw-lighter fst-italic text-"+n[14].type),x(Q,"d-none",!n[10]),_(H,"class","btn btn-primary position-relative"),_(I,"class","d-flex justify-content-end align-items-center gap-2 flex-row"),_(e,"class","d-flex flex-column gap-4")},m(p,w){Y(p,e,w),d(e,s),d(s,t),d(s,f),d(s,o),n[21](o),ae(o,n[2]),d(e,l),d(e,i),d(i,h),d(i,k),d(i,m),n[25](m),ae(m,n[3]),d(e,c),d(e,y),d(y,S),d(y,F),d(y,E),n[29](E),ae(E,n[4]),d(e,T),d(e,I),d(I,V),d(V,O),d(I,fe),d(I,Q),ie(W,Q,null),d(I,de),N&&N.m(I,null),d(I,te),d(I,H),z.m(H,null),d(H,se),u&&u.m(H,null),L=!0,ce||(me=[U(o,"focus",n[22]),U(o,"keyup",n[23]),U(o,"input",n[24]),U(m,"focus",n[26]),U(m,"keyup",n[27]),U(m,"input",n[28]),U(E,"focus",n[30]),U(E,"keyup",n[31]),U(E,"input",n[32]),U(H,"click",n[17])],ce=!0)},p(p,w){(!L||w[0]&2&&D!==(D=p[1]+"-start-date"))&&_(o,"name",D),(!L||w[0]&1024)&&(o.disabled=p[10]),w[0]&4&&ae(o,p[2]),(!L||w[0]&256)&&x(o,"is-invalid",p[8]),(!L||w[0]&2&&g!==(g=p[1]+"-end-date"))&&_(m,"name",g),(!L||w[0]&1024)&&(m.disabled=p[10]),w[0]&8&&ae(m,p[3]),(!L||w[0]&128)&&x(m,"is-invalid",p[7]),(!L||w[0]&2&&B!==(B=p[1]+"-max-limit"))&&_(E,"name",B),(!L||w[0]&1024)&&(E.disabled=p[10]),w[0]&16&&E.value!==p[4]&&ae(E,p[4]),(!L||w[0]&512)&&x(E,"is-invalid",p[9]),(!L||w[0]&16384)&&q!==(q=p[14].message+"")&&De(O,q),(!L||w[0]&16384&&K!==(K="fw-lighter fst-italic text-"+p[14].type))&&_(V,"class",K),(!L||w[0]&1024)&&x(Q,"d-none",!p[10]),p[6]?N?N.p(p,w):(N=Ae(p),N.c(),N.m(I,te)):N&&(N.d(1),N=null),ne!==(ne=_e(p))&&(z.d(1),z=ne(p),z&&(z.c(),z.m(H,se))),p[15]?u||(u=Oe(),u.c(),u.m(H,null)):u&&(u.d(1),u=null)},i(p){L||(R(W.$$.fragment,p),L=!0)},o(p){J(W.$$.fragment,p),L=!1},d(p){p&&M(e),n[21](null),n[25](null),n[29](null),ue(W),N&&N.d(),z.d(),u&&u.d(),ce=!1,Re(me)}}}function Ae(n){let e,s="<span>Delete</span>",t,a;return{c(){e=b("button"),e.innerHTML=s,this.h()},l(f){e=v(f,"BUTTON",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-4hjfsp"&&(e.innerHTML=s),this.h()},h(){_(e,"class","btn btn-danger position-relative")},m(f,o){Y(f,e,o),t||(a=U(e,"click",n[16]),t=!0)},p:Ue,d(f){f&&M(e),t=!1,a()}}}function at(n){let e,s="Create";return{c(){e=b("span"),e.textContent=s},l(t){e=v(t,"SPAN",{"data-svelte-h":!0}),X(e)!=="svelte-1wf0js6"&&(e.textContent=s)},m(t,a){Y(t,e,a)},d(t){t&&M(e)}}}function lt(n){let e,s="Save";return{c(){e=b("span"),e.textContent=s},l(t){e=v(t,"SPAN",{"data-svelte-h":!0}),X(e)!=="svelte-l126tb"&&(e.textContent=s)},m(t,a){Y(t,e,a)},d(t){t&&M(e)}}}function Oe(n){let e,s='<span class="visually-hidden">Item not saved</span>';return{c(){e=b("span"),e.innerHTML=s,this.h()},l(t){e=v(t,"SPAN",{class:!0,"data-svelte-h":!0}),X(e)!=="svelte-1sxrz4i"&&(e.innerHTML=s),this.h()},h(){_(e,"class","position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle")},m(t,a){Y(t,e,a)},d(t){t&&M(e)}}}function rt(n){let e,s,t=n[0]&&Pe(n);return{c(){t&&t.c(),e=Me()},l(a){t&&t.l(a),e=Me()},m(a,f){t&&t.m(a,f),Y(a,e,f),s=!0},p(a,f){a[0]?t?(t.p(a,f),f[0]&1&&R(t,1)):(t=Pe(a),t.c(),R(t,1),t.m(e.parentNode,e)):t&&(qe(),J(t,1,1,()=>{t=null}),Fe())},i(a){s||(R(t),s=!0)},o(a){J(t),s=!1},d(a){a&&M(e),t&&t.d(a)}}}function ot(n,e,s){let t,a,f,o,D,l,{name:i=""}=e,{drawerId:h=""}=e,{budget:r}=e;const{actions:{reload:k}}=ze();let m=!1,g,c,y,S=0,j,F,E,B={message:"",type:"info"},T,I={startDate:!1,endDate:!1,amount:!1};const V=()=>{const u=`[data-bs-target="#${h}"]`,p=document.querySelector(u);p&&p.click()},q=()=>{s(5,I={amount:!1,startDate:!1,endDate:!1}),s(0,r={...ke}),s(10,m=!1)},O=(u,p=0,w="info")=>{s(14,B.message=u,B),s(14,B.type=w,B),p&&setTimeout(()=>{s(14,B.message="",B)},p)},K=async()=>{if(!t){O("ID is not defined",0,"danger");return}try{await tt(t),await k(!0),setTimeout(()=>{s(10,m=!1),s(20,T={...r,id:t,start_at:G(g,"yyyy-MM-dd",new Date).toISOString(),end_at:G(c,"yyyy-MM-dd",new Date).toISOString()}),O("Transaction Deleted",3e3,"success"),V()},800)}catch(u){setTimeout(()=>{s(10,m=!1),console.error("Save failed:",u),O("Failed to save event. Please try again.",7e3,"danger")},800)}},fe=()=>{s(10,m=!0),Qe({title:"Delete Confirmation",message:"Are you sure you want to do this?  You won't be able to undo this.",confirmButtonLabel:"Yes",confirmButtonCSS:"btn-danger",callback:async u=>{u&&await K(),await k(!0),q()}})},Q=async()=>{if(!a){O("Sorry nothing has changed, therefore, there is nothing to save.",7e3);return}if(!l){let u=[];D&&u.push("Amount is invalid"),f&&u.push("Start date is invalid"),o&&u.push("End date is invalid"),O(u.join(". ")+".  Please address accordingly.",0,"danger");return}if(!m){O("Saving ..."),s(10,m=!0);try{const u={...r,start_at:G(g,"yyyy-MM-dd",new Date).toISOString(),end_at:G(c,"yyyy-MM-dd",new Date).toISOString(),settings:{...r.settings,max_spend_limit:y}};t?await $e(t,u):await et(u),await k(!0),setTimeout(()=>{s(10,m=!1),s(20,T={...r,id:t}),O("Saved",3e3,"success"),t||q(),V()},800)}catch(u){setTimeout(()=>{s(10,m=!1),console.error("Save failed:",u),O("Failed to save event. Please try again.",7e3,"danger"),t||q()},800)}}};function W(u){we[u?"unshift":"push"](()=>{j=u,s(11,j)})}const de=()=>j.select(),te=()=>s(5,I.startDate=!0,I);function H(){g=this.value,s(2,g),s(0,r),s(19,S),s(6,t)}function se(u){we[u?"unshift":"push"](()=>{F=u,s(12,F)})}const L=()=>F.select(),ce=()=>s(5,I.endDate=!0,I);function me(){c=this.value,s(3,c),s(0,r),s(19,S),s(6,t)}function N(u){we[u?"unshift":"push"](()=>{E=u,s(13,E)})}const _e=()=>E.select(),ne=()=>s(5,I.amount=!0,I);function z(){y=this.value,s(4,y),s(0,r),s(19,S),s(6,t)}return n.$$set=u=>{"name"in u&&s(1,i=u.name),"drawerId"in u&&s(18,h=u.drawerId),"budget"in u&&s(0,r=u.budget)},n.$$.update=()=>{n.$$.dirty[0]&1&&s(6,t=r?.id),n.$$.dirty[0]&524353&&r&&S!==t&&(s(10,m=!0),setTimeout(()=>{s(20,T={...r}),s(19,S=t),s(4,y=r.settings?.max_spend_limit??0),s(2,g=$(G(r.start_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(3,c=$(G(r.end_at,"yyyy-MM-dd",new Date),"yyyy-MM-dd")),s(10,m=!1)},800)),n.$$.dirty[0]&1048604&&s(15,a=T?.start_at!==g||T?.end_at!==c||T?.settings?.max_spend_limit!==y),n.$$.dirty[0]&33&&s(8,f=I.startDate&&r?.start_at===""),n.$$.dirty[0]&33&&s(7,o=I.endDate&&r?.end_at===""),n.$$.dirty[0]&33&&s(9,D=I.amount&&r?.settings?.max_spend_limit===0),n.$$.dirty[0]&896&&(l=!f&&!o&&!D)},[r,i,g,c,y,I,t,o,f,D,m,j,F,E,B,a,fe,Q,h,S,T,W,de,te,H,se,L,ce,me,N,_e,ne,z]}class it extends Te{constructor(e){super(),Se(this,e,ot,rt,Ie,{name:1,drawerId:18,budget:0},null,[-1,-1])}}function je(n,e,s){const t=n.slice();return t[9]=e[s],t}function ut(n){let e,s;return e=new Xe({}),{c(){re(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,a){ie(e,t,a),s=!0},p:Ue,i(t){s||(R(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){ue(e,t)}}}function ft(n){let e,s;return e=new it({props:{name:"budget-form",drawerId:le,budget:n[0]}}),{c(){re(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,a){ie(e,t,a),s=!0},p(t,a){const f={};a&1&&(f.budget=t[0]),e.$set(f)},i(t){s||(R(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){ue(e,t)}}}function dt(n){let e,s,t,a;const f=[ft,ut],o=[];function D(l,i){return l[1]?1:0}return e=D(n),s=o[e]=f[e](n),{c(){s.c(),t=Me()},l(l){s.l(l),t=Me()},m(l,i){o[e].m(l,i),Y(l,t,i),a=!0},p(l,i){let h=e;e=D(l),e===h?o[e].p(l,i):(qe(),J(o[h],1,1,()=>{o[h]=null}),Fe(),s=o[e],s?s.p(l,i):(s=o[e]=f[e](l),s.c()),R(s,1),s.m(t.parentNode,t))},i(l){a||(R(s),a=!0)},o(l){J(s),a=!1},d(l){l&&M(t),o[e].d(l)}}}function Ve(n){let e,s,t,a='<tr><th scope="col" class="fw-light text-muted">Start</th> <th scope="col" class="fw-light text-muted">End</th> <th scope="col" class="text-end">Max Limit</th> <th scope="col"></th></tr>',f,o,D=Be(n[3]),l=[];for(let i=0;i<D.length;i+=1)l[i]=He(je(n,D,i));return{c(){e=b("div"),s=b("table"),t=b("thead"),t.innerHTML=a,f=P(),o=b("tbody");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=v(i,"DIV",{class:!0});var h=C(e);s=v(h,"TABLE",{class:!0});var r=C(s);t=v(r,"THEAD",{"data-svelte-h":!0}),X(t)!=="svelte-22a6sv"&&(t.innerHTML=a),f=A(r),o=v(r,"TBODY",{});var k=C(o);for(let m=0;m<l.length;m+=1)l[m].l(k);k.forEach(M),r.forEach(M),h.forEach(M),this.h()},h(){_(s,"class","table"),_(e,"class","table-responsive")},m(i,h){Y(i,e,h),d(e,s),d(s,t),d(s,f),d(s,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(o,null)},p(i,h){if(h&40){D=Be(i[3]);let r;for(r=0;r<D.length;r+=1){const k=je(i,D,r);l[r]?l[r].p(k,h):(l[r]=He(k),l[r].c(),l[r].m(o,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=D.length}},d(i){i&&M(e),Je(l,i)}}}function He(n){let e,s,t=$(G(n[9].start_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"",a,f,o,D=$(G(n[9].end_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"",l,i,h,r=Ne(n[9]?.settings?.max_spend_limit)+"",k,m,g,c,y,S,j,F;function E(){return n[7](n[9])}return{c(){e=b("tr"),s=b("td"),a=be(t),f=P(),o=b("td"),l=be(D),i=P(),h=b("td"),k=be(r),m=P(),g=b("td"),c=b("button"),y=b("i"),S=P(),this.h()},l(B){e=v(B,"TR",{});var T=C(e);s=v(T,"TD",{class:!0});var I=C(s);a=ve(I,t),I.forEach(M),f=A(T),o=v(T,"TD",{class:!0});var V=C(o);l=ve(V,D),V.forEach(M),i=A(T),h=v(T,"TD",{class:!0});var q=C(h);k=ve(q,r),q.forEach(M),m=A(T),g=v(T,"TD",{class:!0});var O=C(g);c=v(O,"BUTTON",{"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0,class:!0});var K=C(c);y=v(K,"I",{class:!0}),C(y).forEach(M),K.forEach(M),O.forEach(M),S=A(T),T.forEach(M),this.h()},h(){_(s,"class","fw-light text-muted"),_(o,"class","fw-light text-muted"),_(h,"class","text-end"),_(y,"class","bi bi-pencil"),_(c,"data-bs-toggle","offcanvas"),_(c,"data-bs-target","#"+le),_(c,"aria-controls",le),_(c,"class","btn btn-sm btn-primary"),_(g,"class","d-flex justify-content-end")},m(B,T){Y(B,e,T),d(e,s),d(s,a),d(e,f),d(e,o),d(o,l),d(e,i),d(e,h),d(h,k),d(e,m),d(e,g),d(g,c),d(c,y),d(e,S),j||(F=U(c,"click",E),j=!0)},p(B,T){n=B,T&8&&t!==(t=$(G(n[9].start_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"")&&De(a,t),T&8&&D!==(D=$(G(n[9].end_at,"yyyy-MM-dd",new Date),"dd MMM yyyy")+"")&&De(l,D),T&8&&r!==(r=Ne(n[9]?.settings?.max_spend_limit)+"")&&De(k,r)},d(B){B&&M(e),j=!1,F()}}}function ct(n){let e,s,t,a,f,o="Budgets",D,l,i,h,r,k,m;e=new We({props:{title:n[2],id:le,$$slots:{default:[dt]},$$scope:{ctx:n}}});let g=n[3].length&&Ve(n);return{c(){re(e.$$.fragment),s=P(),t=b("div"),a=b("div"),f=b("h2"),f.textContent=o,D=P(),l=b("button"),i=b("i"),h=P(),g&&g.c(),this.h()},l(c){oe(e.$$.fragment,c),s=A(c),t=v(c,"DIV",{class:!0});var y=C(t);a=v(y,"DIV",{class:!0});var S=C(a);f=v(S,"H2",{"data-svelte-h":!0}),X(f)!=="svelte-b0epp8"&&(f.textContent=o),D=A(S),l=v(S,"BUTTON",{class:!0,type:!0,"data-bs-toggle":!0,"data-bs-target":!0,"aria-controls":!0});var j=C(l);i=v(j,"I",{class:!0}),C(i).forEach(M),j.forEach(M),S.forEach(M),h=A(y),g&&g.l(y),y.forEach(M),this.h()},h(){_(i,"class","bi bi-plus"),_(l,"class","btn btn-sm btn-secondary"),_(l,"type","button"),_(l,"data-bs-toggle","offcanvas"),_(l,"data-bs-target","#"+le),_(l,"aria-controls",le),_(a,"class","d-flex justify-content-between align-items-center"),_(t,"class","d-flex flex-column gap-3")},m(c,y){ie(e,c,y),Y(c,s,y),Y(c,t,y),d(t,a),d(a,f),d(a,D),d(a,l),d(l,i),d(t,h),g&&g.m(t,null),r=!0,k||(m=U(l,"click",n[6]),k=!0)},p(c,[y]){const S={};y&4&&(S.title=c[2]),y&4099&&(S.$$scope={dirty:y,ctx:c}),e.$set(S),c[3].length?g?g.p(c,y):(g=Ve(c),g.c(),g.m(t,null)):g&&(g.d(1),g=null)},i(c){r||(R(e.$$.fragment,c),r=!0)},o(c){J(e.$$.fragment,c),r=!1},d(c){c&&(M(s),M(t)),ue(e,c),g&&g.d(),k=!1,m()}}}const le="budgets-form";function mt(n,e,s){let t,a;const{stores:{data:f},actions:{reload:o}}=ze();Ye(n,f,k=>s(3,a=k));let D=!1,l=ke;const i=k=>{s(1,D=!0),setTimeout(()=>{s(0,l=k),s(1,D=!1)},800)};Ge(()=>o(!0));const h=()=>i({...ke}),r=k=>i({...k});return n.$$.update=()=>{n.$$.dirty&1&&s(2,t=l?.id?"Edit Budget":"Create Budget")},[l,D,t,a,f,i,h,r]}class _t extends Te{constructor(e){super(),Se(this,e,mt,ct,Ie,{})}}function pt(n){let e,s;return e=new _t({}),{c(){re(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,a){ie(e,t,a),s=!0},i(t){s||(R(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){ue(e,t)}}}function gt(n){let e,s;return e=new Ke({props:{pageTitle:"Budgets",$$slots:{default:[pt]},$$scope:{ctx:n}}}),{c(){re(e.$$.fragment)},l(t){oe(e.$$.fragment,t)},m(t,a){ie(e,t,a),s=!0},p(t,[a]){const f={};a&1&&(f.$$scope={dirty:a,ctx:t}),e.$set(f)},i(t){s||(R(e.$$.fragment,t),s=!0)},o(t){J(e.$$.fragment,t),s=!1},d(t){ue(e,t)}}}class St extends Te{constructor(e){super(),Se(this,e,null,gt,Ie,{})}}export{St as component,Tt as universal};
